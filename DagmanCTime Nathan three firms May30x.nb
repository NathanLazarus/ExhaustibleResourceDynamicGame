(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    197511,       5424]
NotebookOptionsPosition[    180945,       5143]
NotebookOutlinePosition[    181287,       5158]
CellTagsIndexPosition[    181244,       5155]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["DAGMAN Dynamic Nash", "Title",
 CellChangeTimes->{{3.388063044670274*^9, 3.388063052070915*^9}, {
   3.3881679974725647`*^9, 3.3881680030005136`*^9}, {3.3883327791713696`*^9, 
   3.3883327946636467`*^9}, {3.3883398332815294`*^9, 3.388339833702134*^9}, {
   3.388774587625*^9, 3.388774588203125*^9}, 3.389194383015625*^9, {
   3.829583697411647*^9, 
   3.829583708034905*^9}},ExpressionUUID->"248cfd5b-c83c-4c3c-93eb-\
33aa743e83ea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "=", "0"}], ";", " ", 
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], ";", " ", 
  RowBox[{
   RowBox[{"DateList", "[", 
    RowBox[{"Date", "[", "]"}], "]"}], "//", "Most"}]}]], "Input",
 CellLabel->
  "In[160]:=",ExpressionUUID->"1a233bd4-a822-45ff-b9f9-fad9430d8caa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2021", ",", "6", ",", "18", ",", "13", ",", "16"}], 
  "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAuK/Sp7+SzvfOF6ZaRUBolPWuaSB6A1ah/JA9NGGaKMV
QNpoKvP51UA6p0rMYRuQnueuVACiPc6FF+4E0hxekTUg2mz2CZFdQHr7UV2t
80C66KNnFIi2K1VceAlIv6xXfQ6ib8ft/gmiHz1hV7kMpLc8zzK/DzJHqpbh
AZAWWXR59UMgrfF7v8/5rjeOPROvMZ/ufuN4ZMW9hPNA2ltxeuMlID3nYtAE
EP15T7veZSD9telyGIhm7VqYdRVIT6tmKQHRZn7up0G03IxDYteAtMv2eb4g
esrUonkg+ubZT9dvA2m1sJWfQfQHx5eP7wDpM22aP0F0Uqf1tyO9bxzXLOg0
OAqkv0yeHQGi0/YKpYHoTU78G9/3vXEEAMZSvfk=
  "],
 CellLabel->
  "Out[160]=",ExpressionUUID->"802d10e3-7abd-455c-80c2-38e849c77c0f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numfirms", "=", "2"}], ";"}]], "Input",
 CellChangeTimes->{{3.830348051054196*^9, 3.830348057188826*^9}, {
  3.8303810293299093`*^9, 3.830381035519782*^9}, {3.830381376700425*^9, 
  3.830381396108087*^9}, {3.8324241712815657`*^9, 3.8324241713496294`*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"907b9b4d-a2f6-463b-a687-2fc606431ccb"],

Cell[CellGroupData[{

Cell["The oligopoly model", "Section",
 CellChangeTimes->{{3.829583758736846*^9, 3.829583762216453*^9}, {
  3.831403889534033*^9, 
  3.8314038915491257`*^9}},ExpressionUUID->"864090de-8af3-40e5-8657-\
4cf1811662e3"],

Cell[CellGroupData[{

Cell["Cost and Inverse Demand functions", "Subsection",ExpressionUUID->"5fbe112a-95a8-4839-bc72-dd5a70c12b50"],

Cell["\<\
Total cost of producing q units is C[q, \[Theta]], where \[Theta] is \
productivity level.
In this paper, we go with a productivity specification; that is, a reduction \
in \[Theta] reduces costs proportionately at all output levels.\
\>", "Text",ExpressionUUID->"f031a4e1-a4e3-4165-9b57-0ed9c5974a27"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cq", "[", 
    RowBox[{"q_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{"\[Theta]", " ", 
    RowBox[{"Cq", "[", "q", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.829684118754727*^9, 3.82968413569598*^9}, 
   3.829684235157915*^9},
 CellLabel->
  "In[162]:=",ExpressionUUID->"ec436de9-ce2e-4f3d-a988-2d215346391b"],

Cell["\<\
If firm i produces qi, then total output is q1+q2, and price is P[q1+q2].
Profi is the net revenue (sales revenue minus production costs) for firm i \
producing qi when it is at productivity level \[Theta]i, and is defined by \
the following\
\>", "Text",ExpressionUUID->"2141b4e2-e49c-463d-97f1-455104b89fc4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Qsum", "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"q", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "numfirms"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.829684159848329*^9, 3.829684184990281*^9}, {
   3.8296842290142727`*^9, 3.8296842465246677`*^9}, 3.83012733291792*^9, {
   3.830262321885888*^9, 3.830262322578094*^9}, {3.830262621000511*^9, 
   3.8302626230226393`*^9}, {3.830348028369493*^9, 3.830348029014439*^9}, {
   3.830348060886685*^9, 3.830348062555874*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"20633d23-4c26-4593-a8eb-2a7263f34d2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"q", "[", "1", "]"}], "+", 
  RowBox[{"q", "[", "2", "]"}]}]], "Output",
 CellChangeTimes->{
  3.830262394395402*^9, 3.830262466174268*^9, 3.830262578277463*^9, 
   3.8302626461646347`*^9, 3.830268322516543*^9, 3.8302757042939243`*^9, 
   3.8302970888710403`*^9, 3.830297473214035*^9, 3.830303633349348*^9, 
   3.830303715030621*^9, 3.830304934443755*^9, 3.830348046560556*^9, 
   3.830348113546061*^9, 3.830348498444207*^9, 3.830355209249707*^9, 
   3.8303557692995443`*^9, 3.8303559179817533`*^9, 3.830356256375646*^9, 
   3.8303809875255013`*^9, {3.8303813838372593`*^9, 3.830381400916333*^9}, 
   3.83038259602785*^9, 3.830386014815693*^9, 3.830872678146864*^9, 
   3.831388191065008*^9, 3.8313971273287*^9, 3.831403532864398*^9, 
   3.831403655260158*^9, 3.831403738505699*^9, 3.831404916422009*^9, 
   3.831405238789572*^9, 3.831409493186221*^9, 3.831409568404841*^9, 
   3.831410266353631*^9, 3.831410870265147*^9, 3.8314113090912943`*^9, 
   3.8314119556804543`*^9, 3.83142265571642*^9, 3.831422877554337*^9, 
   3.831424799487582*^9, 3.8314249694809837`*^9, 3.832424370363718*^9, 
   3.8324248366348476`*^9, 3.8324251571935124`*^9, 3.832425264969425*^9, 
   3.8330361697771835`*^9},
 CellLabel->
  "Out[163]=",ExpressionUUID->"c043bd0b-badf-41f7-a5e6-cc11feb645a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Prof", "[", "i_", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"q", "[", "i", "]"}], "  ", 
    RowBox[{"P", "[", "Qsum", "]"}]}], " ", "-", " ", 
   RowBox[{"Cq", "[", 
    RowBox[{
     RowBox[{"q", "[", "i", "]"}], ",", 
     RowBox[{"\[Theta]", "[", "i", "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.389127088796875*^9, 3.389127097203125*^9}, {
  3.8296841543206177`*^9, 3.8296841553764963`*^9}, {3.829684196295463*^9, 
  3.8296842226372347`*^9}, {3.8296842537895403`*^9, 3.8296842687883377`*^9}, {
  3.8302624604388514`*^9, 3.830262460612977*^9}, {3.8302626269842663`*^9, 
  3.8302626282229443`*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"338094e6-214d-44ab-b9f8-872f9b36121e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{
     RowBox[{"q", "[", "1", "]"}], "+", 
     RowBox[{"q", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"q", "[", "i", "]"}]}], "-", 
  RowBox[{
   RowBox[{"Cq", "[", 
    RowBox[{"q", "[", "i", "]"}], "]"}], " ", 
   RowBox[{"\[Theta]", "[", "i", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.8302623944040318`*^9, 3.8302624661806297`*^9, 3.830262578287507*^9, 
   3.830262646215879*^9, 3.83026832252386*^9, 3.830275704300474*^9, 
   3.8302970889238663`*^9, 3.830297473267811*^9, 3.8303036333570642`*^9, 
   3.830303715038107*^9, 3.830304934451083*^9, 3.830348046566307*^9, 
   3.830348113588798*^9, 3.830348498498859*^9, 3.8303552092566137`*^9, 
   3.8303557693052187`*^9, 3.830355917987352*^9, 3.830356256422327*^9, 
   3.830380987593319*^9, {3.830381383841362*^9, 3.8303814009208193`*^9}, 
   3.830382596070018*^9, 3.830386014822565*^9, 3.8308726782140617`*^9, 
   3.83138819115123*^9, 3.8313971273398037`*^9, 3.831403532870018*^9, 
   3.831403656143092*^9, 3.831403738511546*^9, 3.8314049164275618`*^9, 
   3.831405238795133*^9, 3.831409493236899*^9, 3.8314095684962683`*^9, 
   3.8314102663589153`*^9, 3.83141087032904*^9, 3.8314113090977907`*^9, 
   3.831411955686028*^9, 3.831422655751642*^9, 3.831422877628785*^9, 
   3.831424799492241*^9, 3.83142496948667*^9, 3.83242437050648*^9, 
   3.832424836728962*^9, 3.8324251573152065`*^9, 3.8324252650407677`*^9, 
   3.8330361702027273`*^9},
 CellLabel->
  "Out[164]=",ExpressionUUID->"60feecc0-daa6-4bdf-a192-fb738fa6bf9c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quadratic utility function, linear demand", "Subsection",
 CellChangeTimes->{{3.830355388446383*^9, 
  3.8303553931300907`*^9}},ExpressionUUID->"96c0a328-5f2e-4c40-912d-\
71aa6db9ef82"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"P", "[", "z_", "]"}], "=", 
  RowBox[{"A", "-", 
   RowBox[{"z", "/", "Pop"}]}]}]], "Input",
 CellChangeTimes->{{3.829693031167596*^9, 3.829693077370636*^9}, {
  3.8303557509421186`*^9, 3.830355752067505*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"fa184de2-7f48-4394-941a-5ec5d0970982"],

Cell[BoxData[
 RowBox[{"A", "-", 
  FractionBox["z", "Pop"]}]], "Output",
 CellChangeTimes->{
  3.8302623955359287`*^9, 3.83026246857475*^9, 3.830355294975411*^9, 
   3.830355395340651*^9, 3.8303557703266363`*^9, 3.830355929303342*^9, 
   3.8303565454157963`*^9, 3.830380988934835*^9, {3.830381385267852*^9, 
   3.830381402395863*^9}, 3.830382601303473*^9, 3.83038654108576*^9, 
   3.830872679254829*^9, 3.831388298372099*^9, 3.8313984255381927`*^9, 
   3.831403533720646*^9, 3.8314037385173187`*^9, 3.831404916489484*^9, 
   3.831405238879657*^9, 3.8314094932418118`*^9, 3.831409568501712*^9, 
   3.831410266417821*^9, 3.831410870334774*^9, 3.83141130915829*^9, 
   3.831411955713093*^9, 3.831422655756776*^9, 3.8314228776341457`*^9, 
   3.831424799500942*^9, 3.831424969530472*^9, 3.832424370633006*^9, 
   3.832424836810068*^9, 3.8324251574547863`*^9, 3.8324252651026163`*^9, 
   3.8330361704320097`*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"c8c8549a-c70e-4573-8333-81f5e68d4bce"]
}, Open  ]],

Cell["Pop is a population parameter. Keep it simple.", "Text",
 CellChangeTimes->{{3.38912732975*^9, 3.389127332578125*^9}, {
  3.829504720668602*^9, 3.82950472409275*^9}, {3.830355754930484*^9, 
  3.830355755898591*^9}},ExpressionUUID->"0d810553-23a5-4cb5-a3e6-\
ea7a542803cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pop", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.829504726624682*^9, 3.82950472878806*^9}, {
  3.830355758340262*^9, 3.83035575936325*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"2f095d09-e55a-4f72-a37b-191449363c1c"],

Cell["A is the choke price. Keep it simple.", "Text",
 CellChangeTimes->{{3.38912732975*^9, 3.389127332578125*^9}, {
  3.829504720668602*^9, 3.82950472409275*^9}, {3.8295060840132017`*^9, 
  3.82950608668356*^9}},ExpressionUUID->"358fe608-2b11-4448-9dd1-\
b40e64535b84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.829504726624682*^9, 3.82950472878806*^9}, {
  3.829506088916646*^9, 3.829506089475374*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"ae8849a2-750e-4fdb-90f6-8fd251222229"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quadratic production cost function", "Subsection",
 CellChangeTimes->{{3.829526939057314*^9, 
  3.829526941001169*^9}},ExpressionUUID->"63910343-f8b0-46c4-9085-\
ecb1ed0b05b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cq", "[", "x_", "]"}], "=", " ", 
   RowBox[{
    SuperscriptBox["x", "2"], "/", "2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.388018495338378*^9, 3.388018499233979*^9}, {
  3.8295047052228823`*^9, 3.829504709092967*^9}, {3.82952692642793*^9, 
  3.829526929770698*^9}, {3.830355425070822*^9, 3.8303554303490047`*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"599a4bb0-bd51-4631-9c39-ba621fefc2f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Output choices", "Subsection",
 CellChangeTimes->{{3.829503711184219*^9, 
  3.829503714511743*^9}},ExpressionUUID->"28eca8c2-df3f-4e9c-8baf-\
dca634dc895f"],

Cell["\<\
The first order conditions for each firm's choice of output are\
\>", "Text",
 CellChangeTimes->{
  3.3881614901138926`*^9, 3.829503705386819*^9, {3.830386101052642*^9, 
   3.830386102292041*^9}},ExpressionUUID->"f441a74a-3b07-4fa9-8409-\
ce4ed947805d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"focq", "[", "i_", "]"}], "=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Prof", "[", "i", "]"}], ",", 
    RowBox[{"q", "[", "i", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3884525091347184`*^9, 3.388452509745597*^9}, {
  3.3897228919547777`*^9, 3.3897228927459154`*^9}, {3.389722940965251*^9, 
  3.3897229478852015`*^9}, {3.8296889364006567`*^9, 3.829688957369193*^9}, {
  3.83140367145541*^9, 3.831403673189971*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"a8fd3842-4412-4e94-9df6-53bb1cba3cb2"],

Cell[BoxData[
 RowBox[{"1", "-", 
  RowBox[{"q", "[", "1", "]"}], "-", 
  RowBox[{"q", "[", "2", "]"}], "-", 
  RowBox[{
   RowBox[{"q", "[", "i", "]"}], " ", 
   RowBox[{"\[Theta]", "[", "i", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.8302623949780416`*^9, 3.830262467534132*^9, 3.830262578890099*^9, 
   3.830262646774331*^9, 3.830268333169175*^9, 3.8302757266404943`*^9, 
   3.8302973795776443`*^9, 3.830297532543272*^9, 3.830303651134183*^9, 
   3.830303721309554*^9, 3.830304976161234*^9, 3.830348121653013*^9, 
   3.83034851428202*^9, 3.830355210528981*^9, 3.830355769887143*^9, 
   3.830355918558824*^9, 3.830356257064631*^9, 3.830380988444985*^9, {
   3.830381384644925*^9, 3.8303814017879467`*^9}, 3.830382600929068*^9, 
   3.830386105084477*^9, 3.830872678751746*^9, 3.8313882024144278`*^9, 
   3.8313979303202*^9, 3.831403533309638*^9, {3.831403642994197*^9, 
   3.831403675216711*^9}, 3.8314037386495123`*^9, 3.8314049166086893`*^9, 
   3.831405238974628*^9, 3.831409493303014*^9, 3.831409568604697*^9, 
   3.8314102664879704`*^9, 3.831410870456319*^9, 3.831411309228376*^9, 
   3.831411955766568*^9, 3.831422655802458*^9, 3.8314228777173986`*^9, 
   3.831424799556589*^9, 3.831424969584394*^9, 3.8324243710955167`*^9, 
   3.8324248372454615`*^9, 3.832425157616623*^9, 3.8324252652349553`*^9, 
   3.8330361709259443`*^9},
 CellLabel->
  "Out[169]=",ExpressionUUID->"3c3bda30-5c71-4b46-ac2d-e3e51e61fdb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eqVfocq", "[", "i_", "]"}], "=", 
  RowBox[{"0", "\[Equal]", 
   RowBox[{"focq", "[", "i", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.388164376826331*^9, 3.388164413448992*^9}, {
   3.388452517867275*^9, 3.3884525185482545`*^9}, {3.3897230055180736`*^9, 
   3.389723017264965*^9}, 3.829578470070282*^9, {3.829663006801602*^9, 
   3.829663036879025*^9}, {3.829688964325815*^9, 3.829688970519424*^9}, 
   3.829693263047916*^9},
 CellLabel->
  "In[170]:=",ExpressionUUID->"d3d2a842-eb3f-4a03-a20d-a553902923d1"],

Cell[BoxData[
 RowBox[{"0", "\[Equal]", 
  RowBox[{"1", "-", 
   RowBox[{"q", "[", "1", "]"}], "-", 
   RowBox[{"q", "[", "2", "]"}], "-", 
   RowBox[{
    RowBox[{"q", "[", "i", "]"}], " ", 
    RowBox[{"\[Theta]", "[", "i", "]"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.830262394987537*^9, 3.8302624676185293`*^9, 3.830262578936088*^9, 
   3.830262646821578*^9, 3.830268333176804*^9, 3.830275726797543*^9, 
   3.830297381529232*^9, 3.830297533847713*^9, 3.830303651279207*^9, 
   3.83030372143636*^9, 3.8303049762682*^9, 3.83034812285181*^9, 
   3.830348514594862*^9, 3.830355210628086*^9, 3.830355769895268*^9, 
   3.830355918565658*^9, 3.830356257110902*^9, 3.830380988515786*^9, {
   3.830381384717381*^9, 3.8303814018674517`*^9}, 3.830382600934366*^9, 
   3.830386106950007*^9, 3.830872678761157*^9, 3.83138820252061*^9, 
   3.831397930408668*^9, 3.8314035333160686`*^9, 3.831403693316909*^9, 
   3.831403738655429*^9, 3.831404916673513*^9, 3.831405238980379*^9, 
   3.831409493352831*^9, 3.831409568694756*^9, 3.831410266494166*^9, 
   3.831410870520495*^9, 3.831411309233603*^9, 3.8314119557727537`*^9, 
   3.831422655806868*^9, 3.831422877787014*^9, 3.831424799561219*^9, 
   3.831424969629217*^9, 3.832424371441924*^9, 3.83242483737075*^9, 
   3.832425157717113*^9, 3.8324252652937145`*^9, 3.8330361717914104`*^9},
 CellLabel->
  "Out[170]=",ExpressionUUID->"4e963b73-00a7-4ddf-8fa4-3ea92d082067"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"eqVfocq", "[", "i", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.831397993161327*^9, 3.831398019535492*^9}, 
   3.831403755915525*^9},
 CellLabel->
  "In[171]:=",ExpressionUUID->"ce34e586-bfa4-4711-b80c-950fe29883a0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "\[Equal]", 
    RowBox[{"1", "-", 
     RowBox[{"q", "[", "1", "]"}], "-", 
     RowBox[{"q", "[", "2", "]"}], "-", 
     RowBox[{
      RowBox[{"q", "[", "1", "]"}], " ", 
      RowBox[{"\[Theta]", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{"1", "-", 
     RowBox[{"q", "[", "1", "]"}], "-", 
     RowBox[{"q", "[", "2", "]"}], "-", 
     RowBox[{
      RowBox[{"q", "[", "2", "]"}], " ", 
      RowBox[{"\[Theta]", "[", "2", "]"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{"1", "-", 
     RowBox[{"q", "[", "1", "]"}], "-", 
     RowBox[{"q", "[", "2", "]"}], "-", 
     RowBox[{
      RowBox[{"q", "[", "3", "]"}], " ", 
      RowBox[{"\[Theta]", "[", "3", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8313980202593107`*^9, 3.83140353332233*^9, 3.831403694656233*^9, {
   3.831403738711038*^9, 3.831403757741426*^9}, 3.831404916679737*^9, 
   3.831404957154347*^9, 3.8314052390625134`*^9, 3.831409493358042*^9, 
   3.831409568700308*^9, 3.831410266554038*^9, 3.831410870526576*^9, 
   3.831411309293569*^9, 3.8314119557986097`*^9, 3.831422655811614*^9, 
   3.831422877792431*^9, 3.8314247995659533`*^9, 3.831424970975419*^9, 
   3.832424371859312*^9, 3.83242483770936*^9, 3.832425157819605*^9, 
   3.8324252653479*^9, 3.8330361721573935`*^9},
 CellLabel->
  "Out[171]=",ExpressionUUID->"68cf3022-4d47-462f-af20-aca1fcf182c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solq", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{"%", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], ",", 
       RowBox[{"q", "[", "2", "]"}], ",", 
       RowBox[{"q", "[", "3", "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.831403748766426*^9, 3.831403787489114*^9}, {
  3.8314049529558783`*^9, 3.831404954450684*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"3d0aa800-2e5d-4b47-a8e1-edb09d20e2e5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"q", "[", "1", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"\[Theta]", "[", "2", "]"}], 
     RowBox[{
      RowBox[{"\[Theta]", "[", "1", "]"}], "+", 
      RowBox[{"\[Theta]", "[", "2", "]"}], "+", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "1", "]"}], " ", 
       RowBox[{"\[Theta]", "[", "2", "]"}]}]}]]}], ",", 
   RowBox[{
    RowBox[{"q", "[", "2", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"\[Theta]", "[", "1", "]"}], 
     RowBox[{
      RowBox[{"\[Theta]", "[", "1", "]"}], "+", 
      RowBox[{"\[Theta]", "[", "2", "]"}], "+", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "1", "]"}], " ", 
       RowBox[{"\[Theta]", "[", "2", "]"}]}]}]]}], ",", 
   RowBox[{
    RowBox[{"q", "[", "3", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Theta]", "[", "1", "]"}], " ", 
      RowBox[{"\[Theta]", "[", "2", "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "1", "]"}], "+", 
        RowBox[{"\[Theta]", "[", "2", "]"}], "+", 
        RowBox[{
         RowBox[{"\[Theta]", "[", "1", "]"}], " ", 
         RowBox[{"\[Theta]", "[", "2", "]"}]}]}], ")"}], " ", 
      RowBox[{"\[Theta]", "[", "3", "]"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.8314037881307383`*^9, 3.831404926428708*^9, 
  3.831404958199551*^9, 3.8314052390695963`*^9, 3.831409493408897*^9, 
  3.831409568791761*^9, 3.831410266561203*^9, 3.8314108705926437`*^9, 
  3.831411309300528*^9, 3.8314119558056993`*^9, 3.83142265584473*^9, 
  3.8314228778623867`*^9, 3.831424799609639*^9, 3.831424972588262*^9, 
  3.8324243723335595`*^9, 3.832424838379401*^9, 3.8324251579256735`*^9, 
  3.832425265409834*^9, 3.8330361727209992`*^9},
 CellLabel->
  "Out[172]=",ExpressionUUID->"81160058-534a-494b-89ae-eb587e85c1de"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ProfitFcn", "[", 
   RowBox[{"1", ",", 
    RowBox[{"\[Theta]", "[", "1", "]"}], ",", 
    RowBox[{"\[Theta]", "[", "2", "]"}], ",", 
    RowBox[{"\[Theta]", "[", "3", "]"}]}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Prof", "[", "1", "]"}], "/.", "solq"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.8314049390764723`*^9, 3.831404942171427*^9}, {
  3.8314049937693357`*^9, 3.8314050861335382`*^9}, {3.831405153908222*^9, 
  3.8314051567706823`*^9}, {3.831410240420301*^9, 3.8314102473632793`*^9}, {
  3.8314254983854437`*^9, 3.8314255099696493`*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"d4d0c9e7-3b66-487c-a0d5-4a14e52b6999"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"\[Theta]", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"\[Theta]", "[", "2", "]"}], "2"]}], 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "2", "]"}], "+", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "1", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"\[Theta]", "[", "2", "]"}]}], ")"}]}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{{3.831405063707747*^9, 3.8314050899096823`*^9}, {
   3.8314051584988623`*^9, 3.831405161957232*^9}, 3.831405239222473*^9, 
   3.831409493465679*^9, 3.8314095688921347`*^9, 3.831410266629871*^9, 
   3.8314108706678753`*^9, 3.831411309367461*^9, 3.831411955852334*^9, 
   3.831422655886668*^9, 3.831422877939322*^9, 3.8314247996664467`*^9, 
   3.831425517362815*^9, 3.8324243732428193`*^9, 3.8324248388048267`*^9, 
   3.832425158419901*^9, 3.8324252654727516`*^9, 3.8330361730627885`*^9},
 CellLabel->
  "Out[173]=",ExpressionUUID->"c316d269-c2b0-48a1-8540-2143583c1851"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ProfitFcn", "[", 
   RowBox[{"2", ",", 
    RowBox[{"\[Theta]", "[", "1", "]"}], ",", 
    RowBox[{"\[Theta]", "[", "2", "]"}], ",", 
    RowBox[{"\[Theta]", "[", "3", "]"}]}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Prof", "[", "2", "]"}], "/.", "solq"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.8314049390764723`*^9, 3.831404942171427*^9}, {
  3.8314049937693357`*^9, 3.8314050861335382`*^9}, {3.831405153908222*^9, 
  3.8314051567706823`*^9}, {3.831410240420301*^9, 3.8314102473632793`*^9}, {
  3.8314254983854437`*^9, 3.831425532918491*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"eee3623b-2ced-4bba-a8ca-45ace683673e"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"\[Theta]", "[", "1", "]"}], "2"], " ", 
   RowBox[{"\[Theta]", "[", "2", "]"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "2", "]"}], "+", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "1", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"\[Theta]", "[", "2", "]"}]}], ")"}]}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{{3.831405063707747*^9, 3.8314050899096823`*^9}, {
   3.8314051584988623`*^9, 3.831405161957232*^9}, 3.831405239222473*^9, 
   3.831409493465679*^9, 3.8314095688921347`*^9, 3.831410266629871*^9, 
   3.8314108706678753`*^9, 3.831411309367461*^9, 3.831411955852334*^9, 
   3.831422655886668*^9, 3.831422877939322*^9, 3.8314247996664467`*^9, {
   3.831425517362815*^9, 3.831425533454453*^9}, 3.832424373363411*^9, 
   3.8324248391275487`*^9, 3.8324251586484985`*^9, 3.832425265531561*^9, 
   3.83303617363826*^9},
 CellLabel->
  "Out[174]=",ExpressionUUID->"6e6d9946-7f3f-4342-ad1c-1ebc9be44665"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ProfitFcn", "[", 
   RowBox[{"3", ",", 
    RowBox[{"\[Theta]", "[", "1", "]"}], ",", 
    RowBox[{"\[Theta]", "[", "2", "]"}], ",", 
    RowBox[{"\[Theta]", "[", "3", "]"}]}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Prof", "[", "3", "]"}], "/.", "solq"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.8314049390764723`*^9, 3.831404942171427*^9}, {
  3.8314049937693357`*^9, 3.8314050861335382`*^9}, {3.831405153908222*^9, 
  3.8314051567706823`*^9}, {3.831410240420301*^9, 3.8314102473632793`*^9}, {
  3.8314254983854437`*^9, 3.831425541469771*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"d72b47c4-ee9e-4747-a065-4e2212752659"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"\[Theta]", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"\[Theta]", "[", "2", "]"}], "2"]}], 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "2", "]"}], "+", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "1", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"\[Theta]", "[", "2", "]"}]}], ")"}]}]}], ")"}], "2"], " ", 
   RowBox[{"\[Theta]", "[", "3", "]"}]}]]], "Output",
 CellChangeTimes->{{3.831405063707747*^9, 3.8314050899096823`*^9}, {
   3.8314051584988623`*^9, 3.831405161957232*^9}, 3.831405239222473*^9, 
   3.831409493465679*^9, 3.8314095688921347`*^9, 3.831410266629871*^9, 
   3.8314108706678753`*^9, 3.831411309367461*^9, 3.831411955852334*^9, 
   3.831422655886668*^9, 3.831422877939322*^9, 3.8314247996664467`*^9, {
   3.831425517362815*^9, 3.8314255421080437`*^9}, 3.8324243736019335`*^9, 
   3.832424839309907*^9, 3.8324251587521043`*^9, 3.832425265594042*^9, 
   3.8330361744764066`*^9},
 CellLabel->
  "Out[175]=",ExpressionUUID->"a3fdb60c-3faa-4f2a-95c7-9dc865fd0a2f"]
}, Open  ]],

Cell["\<\
Below, we will let Profit[i,state] be the profit of firm i when the state \
vector is state.\
\>", "Text",
 CellChangeTimes->{{3.831403928508161*^9, 
  3.831403969866588*^9}},ExpressionUUID->"07894cc7-3580-48ec-90bb-\
b0219ec585d7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transition Dynamics", "Section",ExpressionUUID->"fbe33327-0950-42b0-9e34-f84ac03a727e"],

Cell["\<\
States: for i=1,2,...,Nst, \[Theta][i] is productivity in state i. Higher \
values of i imply higher productivity, lower costs. Hence, \[Theta][i] is a \
decreasing function of i.

\[CapitalPi]chi[mi + chi,  ui , qi] is the hazard rate that firm i\
\[CloseCurlyQuote]s state changes from mi to mi + chi.
It depends on
firm i\[CloseCurlyQuote]s investment decision, ui, 
and his output, qi.

ProbiUp is probability that firm i moves up a step. This is continuous time \
and \[CapitalPi]chi is the hazard rate, implying that the probability is \
written in infinitesimal notation
ProbiUp = \[CapitalPi]chi[mi + 1,  ui , qi] dt
ProbiDn is probability that firm i drops down a state
ProbiDn = \[CapitalPi]chi[mi - 1,  ui , qi] dt
ProbiSt is the probability that firm i does not move
ProbiSt = 1  - ProbiUp + ProbiDn\
\>", "Text",
 CellChangeTimes->{{3.829575082517016*^9, 3.829575238009018*^9}, {
  3.82957529183127*^9, 
  3.829575572167509*^9}},ExpressionUUID->"8339056e-f6bd-488b-b2bb-\
e7e21a4e8836"],

Cell["\<\
NOTIONAL NOTE: I will use notations like ProbDep to represent the hazard \
rates of transitions. Do not be confused by my use of the prefix Prob in this \
context.\
\>", "Text",
 CellChangeTimes->{{3.829575640325611*^9, 
  3.8295757118358927`*^9}},ExpressionUUID->"9816cc8e-cd91-4174-9e1d-\
19a5155c13e5"],

Cell["\<\
Transitions: There are three forces changing the state: depreciation, \
investment and learning\
\>", "Text",
 CellChangeTimes->{{3.829504106682466*^9, 
  3.829504120185123*^9}},ExpressionUUID->"9935471d-3f3a-4f13-bad2-\
6270dde9638d"],

Cell[CellGroupData[{

Cell["Transition probabilities", "Subsubsection",ExpressionUUID->"24f626f8-a5dd-4560-89f1-a73c24b50e25"],

Cell["The state for firm i goes down if there is depreciation.", "Text",
 CellChangeTimes->{{3.830296945230543*^9, 
  3.830296950013527*^9}},ExpressionUUID->"74e19e32-61f1-45ef-abd5-\
2192bee6fec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPi]ch", "[", "i_", "]"}], "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "xuvec_", ",", "xmvec_"}], "]"}], "=", 
   "\[Delta]"}], ";"}]], "Input",
 CellChangeTimes->{{3.389034548359375*^9, 3.38903483503125*^9}, {
   3.38903487509375*^9, 3.38903488065625*^9}, 3.389193459265625*^9, {
   3.389698430891797*^9, 3.3896984954346046`*^9}, {3.3897115636869583`*^9, 
   3.389711657321598*^9}, {3.389712016958731*^9, 3.3897120352149825`*^9}, {
   3.3897231445680175`*^9, 3.389723167230605*^9}, {3.389723475604024*^9, 
   3.389723525836254*^9}, {3.389725390657035*^9, 3.389725418046419*^9}, {
   3.3897254554201603`*^9, 3.389725462009635*^9}, {3.829526486867487*^9, 
   3.829526489338531*^9}, {3.829684397865552*^9, 3.829684485213928*^9}, {
   3.829694982066018*^9, 3.8296949870490913`*^9}, {3.829695051159927*^9, 
   3.829695069662516*^9}, 3.829695185710103*^9, {3.830296752055315*^9, 
   3.83029678861965*^9}, {3.830296954998769*^9, 3.8302969556383877`*^9}, {
   3.830297039820365*^9, 3.830297064002597*^9}, {3.8302974208331547`*^9, 
   3.830297422199079*^9}, {3.831398510288405*^9, 3.831398512406554*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"ab0ff058-f6da-4ab1-ad4f-ba367af6aff8"],

Cell["\<\
The state for firm i goes up if there is success from investment.\
\>", "Text",
 CellChangeTimes->{{3.83029696351853*^9, 
  3.8302969872692547`*^9}},ExpressionUUID->"d6fb05cc-db93-47de-81d0-\
21d715a4c02e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPi]ch", "[", "i_", "]"}], "[", 
    RowBox[{"1", ",", "xuvec_", ",", "xmvec_"}], "]"}], ":=", " ", 
   RowBox[{
    SubscriptBox["\[Phi]", "i"], "[", 
    RowBox[{"xuvec", ",", "xmvec"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.389034548359375*^9, 3.38903483503125*^9}, {
   3.38903487509375*^9, 3.38903488065625*^9}, 3.389193459265625*^9, {
   3.389698430891797*^9, 3.3896984954346046`*^9}, {3.3897115636869583`*^9, 
   3.389711657321598*^9}, {3.389712016958731*^9, 3.3897120352149825`*^9}, {
   3.3897231445680175`*^9, 3.389723167230605*^9}, {3.389723475604024*^9, 
   3.389723525836254*^9}, {3.389725390657035*^9, 3.389725418046419*^9}, {
   3.3897254554201603`*^9, 3.389725462009635*^9}, {3.829526486867487*^9, 
   3.829526489338531*^9}, {3.829684397865552*^9, 3.829684485213928*^9}, {
   3.829694982066018*^9, 3.8296949870490913`*^9}, {3.829695051159927*^9, 
   3.829695069662516*^9}, 3.829695185710103*^9, {3.830296752055315*^9, 
   3.83029678861965*^9}, 3.830296999332926*^9, {3.830297049379287*^9, 
   3.830297071523032*^9}, {3.830297425321645*^9, 3.830297426039254*^9}, {
   3.830297464864297*^9, 3.830297465310452*^9}, 3.83038258919374*^9},
 CellLabel->
  "In[177]:=",ExpressionUUID->"b7800e85-08f0-4fe3-b498-3c58a2b0485e"],

Cell["", "PageBreak",
 PageBreakBelow->True,ExpressionUUID->"ac2431b6-5578-4254-8aed-b417df10b28b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bellman equations and first-order conditions", "Section",
 CellChangeTimes->{{3.8295837715447807`*^9, 
  3.8295837795374117`*^9}},ExpressionUUID->"25edb417-18d9-478f-8f11-\
c980892e290e"],

Cell[CellGroupData[{

Cell["Bellman equations", "Subsection",
 CellChangeTimes->{
  3.829503521775547*^9},ExpressionUUID->"046d36f8-1dd7-42d7-9754-\
cec87b923393"],

Cell["\<\
V1plus is the expected change in the future value of firm 1 CONDITIONAL on \
there being a change\
\>", "Text",
 CellChangeTimes->{{3.829583961708009*^9, 
  3.829583983971097*^9}},ExpressionUUID->"e0b39e9a-4911-4be7-b5fd-\
f0b5653e5f36"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"state", "=", 
  RowBox[{"mvec", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["m", "i"], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "numfirms"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.829684627122643*^9, 3.829684634020727*^9}, {
  3.829684725352767*^9, 3.8296847406387033`*^9}, {3.8302971383784924`*^9, 
  3.830297160857293*^9}, {3.830348068645907*^9, 3.830348071035653*^9}, {
  3.831410975276689*^9, 3.8314109778274593`*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"06e7ed5d-0bfc-4638-92d2-8f2461335254"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["m", "1"], ",", 
   SubscriptBox["m", "2"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.830262394721195*^9, 3.8302624670913677`*^9, 3.830262578649036*^9, 
   3.830262646534862*^9, 3.83026832319144*^9, 3.830275704945004*^9, {
   3.8302971406558113`*^9, 3.8302971614493437`*^9}, 3.830297482925989*^9, 
   3.830303633855014*^9, 3.830303715486679*^9, 3.830304941089426*^9, 
   3.830348113857769*^9, 3.830348498809134*^9, 3.830355209895708*^9, 
   3.830355769613714*^9, 3.8303559182906847`*^9, 3.83035625673528*^9, 
   3.8303809879893017`*^9, {3.830381384251938*^9, 3.830381401368009*^9}, 
   3.8303826005804167`*^9, 3.830386032781382*^9, 3.830872678294785*^9, 
   3.831388191246038*^9, 3.8313974526962748`*^9, 3.83140353294324*^9, 
   3.831404107305133*^9, 3.8314052393129396`*^9, 3.831409509680916*^9, 
   3.831409569068573*^9, 3.8314102774921627`*^9, 3.831410833665481*^9, 
   3.8314108707381897`*^9, 3.8314109803624763`*^9, 3.8314113094778852`*^9, {
   3.8314119558899107`*^9, 3.8314119798453617`*^9}, 3.831422878072694*^9, 
   3.831424799720334*^9, 3.8324243737885284`*^9, 3.832424840069539*^9, 
   3.8324251589808874`*^9, 3.832425265812025*^9, 3.8330361758801165`*^9},
 CellLabel->
  "Out[178]=",ExpressionUUID->"a8b2b38f-007e-453c-8781-a8ecdd1c8491"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"uvec", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"u", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "numfirms"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8302972213912*^9, 3.830297239188743*^9}, {
  3.8303480768212748`*^9, 3.830348078351411*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"4f691689-fe9b-474c-8e80-5461ea352934"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"u", "[", "1", "]"}], ",", 
   RowBox[{"u", "[", "2", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8302972398142767`*^9, 3.8302974831247063`*^9, 3.8303036339294453`*^9, 
   3.8303037155783653`*^9, 3.830304941258057*^9, 3.830348113907765*^9, 
   3.830348498873405*^9, 3.8303552099081717`*^9, 3.830355769665525*^9, 
   3.830355918303084*^9, 3.830356256793643*^9, 3.8303809879988623`*^9, {
   3.830381384326914*^9, 3.8303814014524717`*^9}, 3.830382600687462*^9, 
   3.830386037639531*^9, 3.830872678378487*^9, 3.831388191338574*^9, 
   3.831397505487775*^9, 3.831403533015627*^9, 3.83140410736539*^9, 
   3.831405239399685*^9, 3.831409509824059*^9, 3.8314095691664457`*^9, 
   3.831410277604436*^9, 3.831410835026704*^9, 3.831410870743959*^9, 
   3.831410982618832*^9, 3.831411309484074*^9, {3.831411955895912*^9, 
   3.831411979904051*^9}, 3.8314228780794477`*^9, 3.831424799725173*^9, 
   3.832424373906418*^9, 3.832424840417899*^9, 3.8324251590813*^9, 
   3.832425265940359*^9, 3.8330361762975893`*^9},
 CellLabel->
  "Out[179]=",ExpressionUUID->"35218b47-220b-43a4-a892-7ea66b5941a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ch", "=", 
  RowBox[{
   RowBox[{"IdentityMatrix", "[", "numfirms", "]"}], " ", 
   "\[CapitalDelta]"}]}]], "Input",
 CellChangeTimes->{{3.8296851953235598`*^9, 3.829685201241541*^9}, {
  3.8296853330310793`*^9, 3.829685338053844*^9}, {3.830348480546736*^9, 
  3.8303484819696093`*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"dbddaf4f-27a0-4b4a-8c9e-4fbe329fc501"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[CapitalDelta]", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[CapitalDelta]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.83026239477256*^9, 3.83026246722056*^9, 3.830262578702083*^9, 
   3.83026264659223*^9, 3.830268323278702*^9, 3.830275705032607*^9, 
   3.830297150750235*^9, 3.8302974361600523`*^9, 3.830297483133037*^9, 
   3.830303633935606*^9, 3.830303715584564*^9, 3.830304941341647*^9, 
   3.830348113949885*^9, {3.8303484831954308`*^9, 3.83034849893231*^9}, 
   3.830355209914262*^9, 3.83035576967206*^9, 3.830355918308649*^9, 
   3.830356256838986*^9, 3.830380988064332*^9, {3.830381384398337*^9, 
   3.830381401533485*^9}, 3.8303826007401657`*^9, 3.830386040030549*^9, 
   3.830872678447032*^9, 3.83138819134484*^9, 3.8313975088452997`*^9, 
   3.831403533021237*^9, 3.831404107419636*^9, 3.831405239405863*^9, 
   3.831409509829715*^9, 3.831409569355942*^9, 3.831410277711124*^9, 
   3.8314108357246733`*^9, 3.831410870805511*^9, 3.831410983538721*^9, 
   3.831411309542901*^9, {3.8314119559205427`*^9, 3.831411979908733*^9}, 
   3.8314228781495533`*^9, 3.831424799731744*^9, 3.832424374046037*^9, 
   3.832424840563841*^9, 3.832425159179815*^9, 3.8324252661406636`*^9, 
   3.833036176841564*^9},
 CellLabel->
  "Out[180]=",ExpressionUUID->"27c60083-5da9-4100-b666-3c5314fb3bd3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"nnewstate", "[", "i", "]"}], "=", 
    RowBox[{"state", "+", 
     RowBox[{"ch", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "numfirms"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8296851744441977`*^9, 3.8296851752643843`*^9}, {
  3.829685220427178*^9, 3.829685306041183*^9}, {3.830348083661268*^9, 
  3.830348084941223*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"e57f6f36-9519-438b-bc87-98c89d910e50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"nnewstate", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "numfirms"}], "}"}]}], "]"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.8296850386345453`*^9, 3.829685046133553*^9}, 
   3.8296853156569977`*^9, {3.830348088476654*^9, 3.8303480906934767`*^9}, {
   3.8313975247604837`*^9, 3.831397541096037*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"fe6d9b11-2fef-4bed-a0f5-088623c052c3"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"\[CapitalDelta]", "+", 
      SubscriptBox["m", "1"]}], 
     SubscriptBox["m", "2"]},
    {
     SubscriptBox["m", "1"], 
     RowBox[{"\[CapitalDelta]", "+", 
      SubscriptBox["m", "2"]}]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.831397542635491*^9, 3.8314035330897303`*^9, 3.831404107429373*^9, 
   3.831405239493465*^9, 3.831409509897661*^9, 3.831409569460044*^9, 
   3.831410277822184*^9, 3.831410837412591*^9, 3.8314108708728037`*^9, 
   3.831410985548348*^9, 3.831411313768655*^9, {3.831411955951107*^9, 
   3.831411979961011*^9}, 3.831422878223412*^9, 3.831424799780499*^9, 
   3.8324243741949606`*^9, 3.832424840791567*^9, 3.8324251592966785`*^9, 
   3.8324252663534446`*^9, 3.833036177155695*^9},
 CellLabel->
  "Out[182]//TableForm=",ExpressionUUID->"3cc69cbd-ecb2-4369-a8e8-\
225f145d5eed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Vplus", "[", "i_", "]"}], "=", "\[IndentingNewLine]", 
  RowBox[{"Sum", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"V", "[", "i", "]"}], "@@", "state"}], "-", 
         RowBox[{
          RowBox[{"V", "[", "i", "]"}], "@@", 
          RowBox[{"nnewstate", "[", "j", "]"}]}]}], ")"}], " ", 
       RowBox[{
        RowBox[{"\[CapitalPi]ch", "[", "j", "]"}], "[", 
        RowBox[{"\[CapitalDelta]", ",", "uvecc", ",", "M"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\[CapitalDelta]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"j", ",", "numfirms"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.389033763046875*^9, 3.38903390040625*^9}, {
   3.389033932796875*^9, 3.38903393790625*^9}, {3.3890339978125*^9, 
   3.38903405815625*^9}, {3.389034093046875*^9, 3.389034095046875*^9}, 
   3.38903412521875*^9, {3.389707617602768*^9, 3.389707693071286*^9}, {
   3.38971118111685*^9, 3.389711219902621*^9}, {3.389711251257707*^9, 
   3.389711269253584*^9}, {3.3897236045294094`*^9, 3.3897236115895615`*^9}, {
   3.82955831213048*^9, 3.8295583140741873`*^9}, {3.829684544421918*^9, 
   3.8296845571239223`*^9}, {3.82968548953758*^9, 3.829685532049073*^9}, {
   3.8296855697372217`*^9, 3.829685670084203*^9}, {3.829688681119473*^9, 
   3.829688768236586*^9}, 3.829688801855906*^9, {3.830297259974626*^9, 
   3.8302972648607883`*^9}, {3.83029733118902*^9, 3.830297333475457*^9}, {
   3.8303480959718237`*^9, 3.830348098364596*^9}, {3.830386077998703*^9, 
   3.830386080959414*^9}, {3.831397644441114*^9, 3.831397651809618*^9}, {
   3.831422855825172*^9, 3.831422858080517*^9}, {3.831422888168213*^9, 
   3.831422897519693*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"27610672-7363-4767-8154-fc538d46e0b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Delta]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["m", "1"]}], ",", 
        SubscriptBox["m", "2"]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
  RowBox[{"\[Delta]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["m", "2"]}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Phi]", "2"], "[", 
    RowBox[{"uvecc", ",", "M"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       RowBox[{"1", "+", 
        SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Phi]", "1"], "[", 
    RowBox[{"uvecc", ",", "M"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       RowBox[{"1", "+", 
        SubscriptBox["m", "1"]}], ",", 
       SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.831422930198338*^9, 3.8314247998260098`*^9, 
  3.832424374331939*^9, 3.8324248409322596`*^9, 3.8324251593989096`*^9, 
  3.8324252665378256`*^9, 3.8330361773891215`*^9},
 CellLabel->
  "Out[183]=",ExpressionUUID->"ba20322f-ec1c-45b2-919c-d6c985e0419b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Vplus", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.8330362236844864`*^9, 3.8330362255567417`*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"0993a692-b8ab-4c2a-be35-2f898157c8ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"delta", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"V", "[", "1", "]"}], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["m", "1"]}], ",", 
        SubscriptBox["m", "2"]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"V", "[", "1", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
  RowBox[{"delta", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"V", "[", "1", "]"}], "[", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["m", "2"]}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"V", "[", "1", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
  RowBox[{"alpha", " ", 
   RowBox[{"u", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "1", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "1", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       RowBox[{"1", "+", 
        SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}], "+", 
  RowBox[{"alpha", " ", 
   RowBox[{"u", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "1", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "1", "]"}], "[", 
      RowBox[{
       RowBox[{"1", "+", 
        SubscriptBox["m", "1"]}], ",", 
       SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.833036226266412*^9},
 CellLabel->
  "Out[223]=",ExpressionUUID->"7de48ba0-d784-4fe2-bc65-560be1a16828"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["mvec"], "Input",
 CellChangeTimes->{{3.8314242182061787`*^9, 3.8314242188451347`*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"1c9c0d75-b0ac-4ec6-8402-282a4b67394e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["m", "1"], ",", 
   SubscriptBox["m", "2"]}], "}"}]], "Output",
 CellChangeTimes->{3.831424219694153*^9, 3.831424799832776*^9, 
  3.8324243744407167`*^9, 3.8324248411354265`*^9, 3.832425159533727*^9, 
  3.8324252665976152`*^9, 3.8330361777711363`*^9},
 CellLabel->
  "Out[184]=",ExpressionUUID->"86615dec-d51f-4f28-a458-0a63745bc122"]
}, Open  ]],

Cell["\<\
PV1 is the present value of profits, and equals current net revenue from \
sales minus investment expenditures plus the expectation of the change in the \
future value.\
\>", "Text",
 CellChangeTimes->{{3.829584063969352*^9, 
  3.8295840742570143`*^9}},ExpressionUUID->"fea39745-13ca-478e-97e3-\
056e2727d93d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PV", "[", "i_", "]"}], "=", 
  RowBox[{
   RowBox[{"profits", "[", 
    RowBox[{"i", ",", 
     RowBox[{"Sequence", "@@", "mvec"}]}], "]"}], "-", " ", 
   RowBox[{"CI", "[", 
    RowBox[{"u", "[", "i", "]"}], "]"}], " ", "+", "  ", 
   RowBox[{"Vplus", "[", "i", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.3897113014398656`*^9, {3.82968885385635*^9, 3.829688881321301*^9}, 
   3.829695260467936*^9, {3.831422982125455*^9, 3.8314229925719757`*^9}, {
   3.8314242105664043`*^9, 3.8314242126132393`*^9}, {3.8324242206387167`*^9, 
   3.832424221380585*^9}, {3.832424288423629*^9, 3.8324242911590796`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"6d6d7991-0839-4c94-8a2d-cf624c5558e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"CI", "[", 
    RowBox[{"u", "[", "i", "]"}], "]"}]}], "+", 
  RowBox[{"profits", "[", 
   RowBox[{"i", ",", 
    SubscriptBox["m", "1"], ",", 
    SubscriptBox["m", "2"]}], "]"}], "+", 
  RowBox[{"\[Delta]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["m", "1"]}], ",", 
        SubscriptBox["m", "2"]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
  RowBox[{"\[Delta]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["m", "2"]}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Phi]", "2"], "[", 
    RowBox[{"uvecc", ",", "M"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       RowBox[{"1", "+", 
        SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Phi]", "1"], "[", 
    RowBox[{"uvecc", ",", "M"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       RowBox[{"1", "+", 
        SubscriptBox["m", "1"]}], ",", 
       SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.830262394919653*^9, 3.8302624674414873`*^9, 3.830262578824998*^9, 
   3.830262646713067*^9, 3.830268323538928*^9, 3.830275705382306*^9, 
   3.8302971888556013`*^9, 3.830297367893862*^9, 3.8302974835287724`*^9, 
   3.830303634158805*^9, 3.830303715951111*^9, 3.830304975946155*^9, 
   3.830348114132893*^9, 3.8303485092261057`*^9, 3.830355210418944*^9, 
   3.830355769829908*^9, 3.8303559184599943`*^9, 3.830356257001478*^9, 
   3.8303809882924232`*^9, {3.830381384562594*^9, 3.830381401699225*^9}, 
   3.830382600818387*^9, {3.830386060958479*^9, 3.830386084320586*^9}, 
   3.8308726786065397`*^9, 3.8313881916171913`*^9, 3.831397705738514*^9, 
   3.831422993922*^9, 3.83142426126941*^9, 3.8314247998771677`*^9, 
   3.8324243745533495`*^9, 3.832424841277454*^9, 3.8324251596330185`*^9, 
   3.8324252666654825`*^9, 3.8330361780740595`*^9},
 CellLabel->
  "Out[185]=",ExpressionUUID->"2d66a5ac-73de-4d6b-bdcf-05881bb458dd"]
}, Open  ]],

Cell["Here is the continuous time Bellman equation", "Text",
 CellChangeTimes->{{3.8295841361830053`*^9, 
  3.829584147818166*^9}},ExpressionUUID->"cca5a03d-001f-4f1f-9a19-\
fde118cc1173"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uvecc", "=", "uvec"}], ";"}]], "Input",
 CellChangeTimes->{{3.831423030005581*^9, 3.831423032587059*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"71d3eacf-cccc-4713-847a-0c01272a8148"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eqV", "[", "i_", "]"}], "=", 
  RowBox[{
   RowBox[{"\[Rho]", " ", 
    RowBox[{
     RowBox[{"V", "[", "i", "]"}], "@@", "state"}]}], "\[Equal]", 
   RowBox[{"PV", "[", "i", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.388452472451971*^9, 3.388452481264643*^9}, {
   3.389711404337826*^9, 3.389711405159006*^9}, {3.829578458406066*^9, 
   3.829578459142014*^9}, {3.829688894721961*^9, 3.8296889182082033`*^9}, 
   3.829697447414032*^9},
 CellLabel->
  "In[187]:=",ExpressionUUID->"5d37493d-58a6-492c-9e54-49dcfa4da777"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]", " ", 
   RowBox[{
    RowBox[{"V", "[", "i", "]"}], "[", 
    RowBox[{
     SubscriptBox["m", "1"], ",", 
     SubscriptBox["m", "2"]}], "]"}]}], "\[Equal]", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"CI", "[", 
     RowBox[{"u", "[", "i", "]"}], "]"}]}], "+", 
   RowBox[{"profits", "[", 
    RowBox[{"i", ",", 
     SubscriptBox["m", "1"], ",", 
     SubscriptBox["m", "2"]}], "]"}], "+", 
   RowBox[{"\[Delta]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        RowBox[{"V", "[", "i", "]"}], "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["m", "1"]}], ",", 
         SubscriptBox["m", "2"]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
   RowBox[{"\[Delta]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        RowBox[{"V", "[", "i", "]"}], "[", 
        RowBox[{
         SubscriptBox["m", "1"], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["m", "2"]}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Phi]", "2"], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "[", "1", "]"}], ",", 
        RowBox[{"u", "[", "2", "]"}]}], "}"}], ",", "M"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        SubscriptBox["m", "2"]}], "]"}], "-", 
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        RowBox[{"1", "+", 
         SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Phi]", "1"], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "[", "1", "]"}], ",", 
        RowBox[{"u", "[", "2", "]"}]}], "}"}], ",", "M"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        SubscriptBox["m", "2"]}], "]"}], "-", 
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        RowBox[{"1", "+", 
         SubscriptBox["m", "1"]}], ",", 
        SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.830262394928371*^9, 3.830262467525586*^9, 3.830262578878171*^9, 
   3.830262646764634*^9, 3.830268333010795*^9, 3.830275705391612*^9, 
   3.830297372072938*^9, 3.8302975215907173`*^9, 3.830303651127658*^9, 
   3.830303716047665*^9, 3.8303049761543427`*^9, 3.830348118422737*^9, 
   3.8303485096054087`*^9, 3.8303552105213547`*^9, 3.830355769880198*^9, 
   3.8303559185123777`*^9, 3.830356257056509*^9, 3.8303809883660793`*^9, {
   3.830381384639888*^9, 3.830381401782968*^9}, 3.830382600877211*^9, 
   3.83038609147368*^9, 3.8308726786822033`*^9, 3.831388191629224*^9, 
   3.831397728412684*^9, {3.83142302334044*^9, 3.831423035123592*^9}, 
   3.8314247999256077`*^9, 3.832424374774766*^9, 3.832424841522073*^9, 
   3.8324251597592564`*^9, 3.83242526677782*^9, 3.833036178447541*^9},
 CellLabel->
  "Out[187]=",ExpressionUUID->"0abf2ed3-f0a2-4ab0-ab32-af7c83a38b16"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Investment choices", "Subsection",
 CellChangeTimes->{{3.829503711184219*^9, 
  3.82950373355932*^9}},ExpressionUUID->"87d6d4ec-bcd1-4943-901b-\
23d544c63985"],

Cell["\<\
The first order conditions for each firm's choice of investment effort are\
\>", "Text",ExpressionUUID->"4ef173a0-4fc2-420e-8afb-aefd68c903fc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqVfocu", "[", "i", "]"}], "=", 
    RowBox[{"0", "\[Equal]", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"PV", "[", "i", "]"}], ",", 
       RowBox[{"u", "[", "i", "]"}]}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "numfirms"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3884525331492496`*^9, 3.3884525341406755`*^9}, 
   3.389404627765625*^9, {3.389722952071221*^9, 3.389722960293043*^9}, {
   3.829688983383976*^9, 3.829688996582848*^9}, {3.829689152278075*^9, 
   3.829689163819689*^9}, {3.829689269124659*^9, 3.829689271470148*^9}, 
   3.82968936019499*^9, {3.83034812753939*^9, 3.83034812903475*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"3bca497c-1982-48a5-9305-810acade7155"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       SuperscriptBox["CI", "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"u", "[", "1", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"V", "[", "1", "]"}], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         RowBox[{"V", "[", "1", "]"}], "[", 
         RowBox[{
          RowBox[{"1", "+", 
           SubscriptBox["m", "1"]}], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Phi]", "1"], 
        TagBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", "1", "]"}], ",", 
          RowBox[{"u", "[", "2", "]"}]}], "}"}], ",", "M"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"V", "[", "1", "]"}], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         RowBox[{"V", "[", "1", "]"}], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          RowBox[{"1", "+", 
           SubscriptBox["m", "2"]}]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Phi]", "2"], 
        TagBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", "1", "]"}], ",", 
          RowBox[{"u", "[", "2", "]"}]}], "}"}], ",", "M"}], "]"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       SuperscriptBox["CI", "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"u", "[", "2", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"V", "[", "2", "]"}], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         RowBox[{"V", "[", "2", "]"}], "[", 
         RowBox[{
          RowBox[{"1", "+", 
           SubscriptBox["m", "1"]}], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Phi]", "1"], 
        TagBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", "1", "]"}], ",", 
          RowBox[{"u", "[", "2", "]"}]}], "}"}], ",", "M"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"V", "[", "2", "]"}], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         RowBox[{"V", "[", "2", "]"}], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          RowBox[{"1", "+", 
           SubscriptBox["m", "2"]}]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Phi]", "2"], 
        TagBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", "1", "]"}], ",", 
          RowBox[{"u", "[", "2", "]"}]}], "}"}], ",", "M"}], "]"}]}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8314117902201777`*^9, 3.8314119800733967`*^9, 
  3.831423042039999*^9, 3.8314247999342213`*^9, 3.8324243749284143`*^9, 
  3.8324248416311517`*^9, 3.8324251603831034`*^9, 3.8324252668412895`*^9, 
  3.8330361789577174`*^9},
 CellLabel->
  "Out[188]=",ExpressionUUID->"599b3ee4-d383-45b6-b43c-beba0caf2c95"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["System", "Subsection",
 CellChangeTimes->{{3.829504274387302*^9, 
  3.8295042753717413`*^9}},ExpressionUUID->"4c21e9d0-384c-45c4-a50c-\
3dc938dad942"],

Cell["Here is the system for general investment cost functions.", "Text",
 CellChangeTimes->{{3.829584198143961*^9, 3.829584211425301*^9}, {
  3.8314230627621317`*^9, 
  3.8314230694655123`*^9}},ExpressionUUID->"2c4fb6b4-257b-48c3-a9d6-\
3a156202c810"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sys", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eqV", "[", "i", "]"}], ",", 
        RowBox[{"eqVfocu", "[", "i", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "numfirms"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.829504279835319*^9, 3.82950434261852*^9}, {
  3.829692789886599*^9, 3.829692849907494*^9}, {3.829693250448049*^9, 
  3.829693254110168*^9}, {3.8303481364738293`*^9, 3.830348137922256*^9}, {
  3.83140420463804*^9, 3.83140420671413*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"d69e65dc-9795-439b-9782-060c04a9ab26"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"\[Rho]", " ", 
        RowBox[{
         RowBox[{"V", "[", "1", "]"}], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"CI", "[", 
          RowBox[{"u", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{"profits", "[", 
         RowBox[{"1", ",", 
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "+", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"V", "[", "1", "]"}], "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["m", "1"]}], ",", 
              SubscriptBox["m", "2"]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"V", "[", "1", "]"}], "[", 
             RowBox[{
              SubscriptBox["m", "1"], ",", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["m", "2"]}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Phi]", "2"], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"u", "[", "1", "]"}], ",", 
             RowBox[{"u", "[", "2", "]"}]}], "}"}], ",", "M"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             RowBox[{"1", "+", 
              SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Phi]", "1"], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"u", "[", "1", "]"}], ",", 
             RowBox[{"u", "[", "2", "]"}]}], "}"}], ",", "M"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             RowBox[{"1", "+", 
              SubscriptBox["m", "1"]}], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["CI", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{"u", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             RowBox[{"1", "+", 
              SubscriptBox["m", "1"]}], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Phi]", "1"], 
           TagBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"u", "[", "1", "]"}], ",", 
             RowBox[{"u", "[", "2", "]"}]}], "}"}], ",", "M"}], "]"}]}], "+", 
        
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             RowBox[{"1", "+", 
              SubscriptBox["m", "2"]}]}], "]"}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Phi]", "2"], 
           TagBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"u", "[", "1", "]"}], ",", 
             RowBox[{"u", "[", "2", "]"}]}], "}"}], ",", "M"}], "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Rho]", " ", 
        RowBox[{
         RowBox[{"V", "[", "2", "]"}], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"CI", "[", 
          RowBox[{"u", "[", "2", "]"}], "]"}]}], "+", 
        RowBox[{"profits", "[", 
         RowBox[{"2", ",", 
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "+", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"V", "[", "2", "]"}], "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["m", "1"]}], ",", 
              SubscriptBox["m", "2"]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"V", "[", "2", "]"}], "[", 
             RowBox[{
              SubscriptBox["m", "1"], ",", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["m", "2"]}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Phi]", "2"], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"u", "[", "1", "]"}], ",", 
             RowBox[{"u", "[", "2", "]"}]}], "}"}], ",", "M"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             RowBox[{"1", "+", 
              SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Phi]", "1"], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"u", "[", "1", "]"}], ",", 
             RowBox[{"u", "[", "2", "]"}]}], "}"}], ",", "M"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             RowBox[{"1", "+", 
              SubscriptBox["m", "1"]}], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["CI", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{"u", "[", "2", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             RowBox[{"1", "+", 
              SubscriptBox["m", "1"]}], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Phi]", "1"], 
           TagBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"u", "[", "1", "]"}], ",", 
             RowBox[{"u", "[", "2", "]"}]}], "}"}], ",", "M"}], "]"}]}], "+", 
        
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             RowBox[{"1", "+", 
              SubscriptBox["m", "2"]}]}], "]"}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Phi]", "2"], 
           TagBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"u", "[", "1", "]"}], ",", 
             RowBox[{"u", "[", "2", "]"}]}], "}"}], ",", "M"}], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.83026239508361*^9, 3.830262467718052*^9, 3.830262579001111*^9, 
   3.8302626468831053`*^9, 3.830268333361623*^9, 3.830275726896397*^9, 
   3.8302975642057543`*^9, 3.830303651440001*^9, 3.830303721699459*^9, 
   3.830303812498863*^9, 3.830304985935611*^9, 3.8303481392636747`*^9, 
   3.830348454158538*^9, 3.830348520979485*^9, 3.83035521074354*^9, 
   3.830355769995781*^9, 3.830355918666443*^9, 3.830356257181662*^9, 
   3.8303809886012*^9, {3.830381384805356*^9, 3.830381402046876*^9}, 
   3.830382601051969*^9, 3.830386124091379*^9, 3.830872678983129*^9, 
   3.831388252270164*^9, 3.831398084234962*^9, 3.831403533472907*^9, 
   3.83140414754146*^9, 3.83140420833892*^9, 3.831405239924019*^9, 
   3.831405449498505*^9, 3.831409528057899*^9, 3.831409590633754*^9, 
   3.8314103050610743`*^9, 3.831411029556226*^9, 3.831411397091311*^9, 
   3.831423072316986*^9, 3.8314247999842377`*^9, 3.832424375147189*^9, 
   3.832424842018117*^9, 3.8324251605610538`*^9, 3.832425266911726*^9, 
   3.8330361793387585`*^9},
 CellLabel->
  "Out[190]//TableForm=",ExpressionUUID->"46e269df-1340-4779-a5aa-\
bee24132e8f9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sys2", "=", 
   RowBox[{
    RowBox[{"sys", "/.", " ", 
     RowBox[{
      RowBox[{"V", "[", "i_", "]"}], "\[Rule]", 
      SubscriptBox["V", "i"]}]}], "/.", 
    RowBox[{
     RowBox[{"u", "[", "i_", "]"}], "\[Rule]", 
     RowBox[{
      SubscriptBox["U", "i"], "@@", "state"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.830126650180543*^9, 3.83012693779767*^9}, 
   3.8301269790866013`*^9, {3.83012702347124*^9, 3.83012710305746*^9}, {
   3.830199033864626*^9, 3.8301990396859417`*^9}, {3.8302626972949963`*^9, 
   3.83026269819611*^9}, 3.83026838446068*^9, {3.8303562059657307`*^9, 
   3.830356241994234*^9}, {3.8303563142925243`*^9, 3.830356329922529*^9}, {
   3.830386168739872*^9, 3.830386187960187*^9}, {3.831411416154859*^9, 
   3.831411439809499*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"9afba6df-dec7-414e-aeb4-fcbee59a4bf6"],

Cell[CellGroupData[{

Cell[BoxData["sys2"], "Input",
 CellChangeTimes->{{3.830303821648058*^9, 3.830303822280546*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"e4df3f8f-58c0-4337-8529-68ed427810f6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]", " ", 
     RowBox[{
      SubscriptBox["V", "1"], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"CI", "[", 
       RowBox[{
        SubscriptBox["U", "1"], "[", 
        RowBox[{
         SubscriptBox["m", "1"], ",", 
         SubscriptBox["m", "2"]}], "]"}], "]"}]}], "+", 
     RowBox[{"profits", "[", 
      RowBox[{"1", ",", 
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}], "+", 
     RowBox[{"\[Delta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["V", "1"], "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["m", "1"]}], ",", 
           SubscriptBox["m", "2"]}], "]"}]}], "+", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["V", "1"], "[", 
          RowBox[{
           SubscriptBox["m", "1"], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["m", "2"]}]}], "]"}]}], "+", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          RowBox[{"1", "+", 
           SubscriptBox["m", "1"]}], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SubscriptBox["\[Phi]", "1"], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["U", "1"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}], ",", 
          RowBox[{
           SubscriptBox["U", "2"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], "]"}]}], 
     "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          RowBox[{"1", "+", 
           SubscriptBox["m", "2"]}]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SubscriptBox["\[Phi]", "2"], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["U", "1"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}], ",", 
          RowBox[{
           SubscriptBox["U", "2"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], "]"}]}]}]}],
    ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       SuperscriptBox["CI", "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{
        SubscriptBox["U", "1"], "[", 
        RowBox[{
         SubscriptBox["m", "1"], ",", 
         SubscriptBox["m", "2"]}], "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          RowBox[{"1", "+", 
           SubscriptBox["m", "1"]}], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Phi]", "1"], 
        TagBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["U", "1"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}], ",", 
          RowBox[{
           SubscriptBox["U", "2"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], "]"}]}], 
     "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          RowBox[{"1", "+", 
           SubscriptBox["m", "2"]}]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Phi]", "2"], 
        TagBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["U", "1"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}], ",", 
          RowBox[{
           SubscriptBox["U", "2"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], "]"}]}]}]}],
    ",", 
   RowBox[{
    RowBox[{"\[Rho]", " ", 
     RowBox[{
      SubscriptBox["V", "2"], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"CI", "[", 
       RowBox[{
        SubscriptBox["U", "2"], "[", 
        RowBox[{
         SubscriptBox["m", "1"], ",", 
         SubscriptBox["m", "2"]}], "]"}], "]"}]}], "+", 
     RowBox[{"profits", "[", 
      RowBox[{"2", ",", 
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}], "+", 
     RowBox[{"\[Delta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["V", "2"], "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["m", "1"]}], ",", 
           SubscriptBox["m", "2"]}], "]"}]}], "+", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["V", "2"], "[", 
          RowBox[{
           SubscriptBox["m", "1"], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["m", "2"]}]}], "]"}]}], "+", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          RowBox[{"1", "+", 
           SubscriptBox["m", "1"]}], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SubscriptBox["\[Phi]", "1"], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["U", "1"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}], ",", 
          RowBox[{
           SubscriptBox["U", "2"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], "]"}]}], 
     "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          RowBox[{"1", "+", 
           SubscriptBox["m", "2"]}]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SubscriptBox["\[Phi]", "2"], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["U", "1"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}], ",", 
          RowBox[{
           SubscriptBox["U", "2"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], "]"}]}]}]}],
    ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       SuperscriptBox["CI", "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{
        SubscriptBox["U", "2"], "[", 
        RowBox[{
         SubscriptBox["m", "1"], ",", 
         SubscriptBox["m", "2"]}], "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          RowBox[{"1", "+", 
           SubscriptBox["m", "1"]}], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Phi]", "1"], 
        TagBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["U", "1"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}], ",", 
          RowBox[{
           SubscriptBox["U", "2"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], "]"}]}], 
     "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          RowBox[{"1", "+", 
           SubscriptBox["m", "2"]}]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Phi]", "2"], 
        TagBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["U", "1"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}], ",", 
          RowBox[{
           SubscriptBox["U", "2"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], 
       "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.8314114434996557`*^9, 3.831423098091111*^9, 
  3.8314248000389013`*^9, 3.832424375451282*^9, 3.832424842293425*^9, 
  3.832425160839287*^9, 3.832425267010561*^9, 3.8330361795351715`*^9},
 CellLabel->
  "Out[192]=",ExpressionUUID->"5c28cdc5-c7ab-4c38-8201-f48ef9e9752a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sys2", "/.", " ", 
   RowBox[{"Thread", "[", 
    RowBox[{"state", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"20", ",", "10", ",", "30"}], "}"}]}], "]"}]}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.83020032453976*^9, 3.830200381905404*^9}, {
  3.830200621331442*^9, 3.8302006362421103`*^9}, {3.830200692089731*^9, 
  3.83020070376833*^9}, {3.830305227237856*^9, 3.830305229348723*^9}, {
  3.8303488380902433`*^9, 3.8303488469681053`*^9}, {3.830348881286824*^9, 
  3.830348889253727*^9}, {3.830356525751899*^9, 3.830356526080105*^9}, {
  3.830386233032833*^9, 3.83038624011423*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"22757d9a-68b6-494d-b2a3-ec08a2f5ab46"],

Cell[BoxData[
 TemplateBox[{
  "Thread","tdlen",
   "\"Objects of unequal length in \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[\\\"m\\\", \\\"1\\\"], \\\",\\\", \
SubscriptBox[\\\"m\\\", \\\"2\\\"]}], \\\"}\\\"}], \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"20\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \
\\\"30\\\"}], \\\"}\\\"}]}]\\) cannot be combined.\"",2,193,16,
   17486389755989098845,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.832424375608243*^9, 3.832424842382349*^9, 
  3.8324251609539375`*^9, 3.8324252671058035`*^9, 3.833036179742761*^9},
 CellLabel->
  "During evaluation of \
In[193]:=",ExpressionUUID->"1bd83782-f8bc-42a4-8546-ce2dda54aa23"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"\[Rho]", " ", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"CI", "[", 
          RowBox[{
           SubscriptBox["U", "1"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}], "]"}]}], "+", 
        RowBox[{"profits", "[", 
         RowBox[{"1", ",", 
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "+", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             SubscriptBox["V", "1"], "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["m", "1"]}], ",", 
              SubscriptBox["m", "2"]}], "]"}]}], "+", 
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             SubscriptBox["V", "1"], "[", 
             RowBox[{
              SubscriptBox["m", "1"], ",", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["m", "2"]}]}], "]"}]}], "+", 
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             RowBox[{"1", "+", 
              SubscriptBox["m", "1"]}], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[Phi]", "1"], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "1"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}], ",", 
             RowBox[{
              SubscriptBox["U", "2"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], "]"}]}], 
        "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             RowBox[{"1", "+", 
              SubscriptBox["m", "2"]}]}], "]"}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[Phi]", "2"], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "1"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}], ",", 
             RowBox[{
              SubscriptBox["U", "2"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], 
          "]"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["CI", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           SubscriptBox["U", "1"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             RowBox[{"1", "+", 
              SubscriptBox["m", "1"]}], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Phi]", "1"], 
           TagBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "1"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}], ",", 
             RowBox[{
              SubscriptBox["U", "2"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], "]"}]}], 
        "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             RowBox[{"1", "+", 
              SubscriptBox["m", "2"]}]}], "]"}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Phi]", "2"], 
           TagBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "1"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}], ",", 
             RowBox[{
              SubscriptBox["U", "2"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], 
          "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Rho]", " ", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"CI", "[", 
          RowBox[{
           SubscriptBox["U", "2"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}], "]"}]}], "+", 
        RowBox[{"profits", "[", 
         RowBox[{"2", ",", 
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "+", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             SubscriptBox["V", "2"], "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["m", "1"]}], ",", 
              SubscriptBox["m", "2"]}], "]"}]}], "+", 
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             SubscriptBox["V", "2"], "[", 
             RowBox[{
              SubscriptBox["m", "1"], ",", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["m", "2"]}]}], "]"}]}], "+", 
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             RowBox[{"1", "+", 
              SubscriptBox["m", "1"]}], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[Phi]", "1"], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "1"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}], ",", 
             RowBox[{
              SubscriptBox["U", "2"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], "]"}]}], 
        "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             RowBox[{"1", "+", 
              SubscriptBox["m", "2"]}]}], "]"}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[Phi]", "2"], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "1"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}], ",", 
             RowBox[{
              SubscriptBox["U", "2"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], 
          "]"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["CI", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           SubscriptBox["U", "2"], "[", 
           RowBox[{
            SubscriptBox["m", "1"], ",", 
            SubscriptBox["m", "2"]}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             RowBox[{"1", "+", 
              SubscriptBox["m", "1"]}], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Phi]", "1"], 
           TagBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "1"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}], ",", 
             RowBox[{
              SubscriptBox["U", "2"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], "]"}]}], 
        "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             RowBox[{"1", "+", 
              SubscriptBox["m", "2"]}]}], "]"}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Phi]", "2"], 
           TagBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "1"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}], ",", 
             RowBox[{
              SubscriptBox["U", "2"], "[", 
              RowBox[{
               SubscriptBox["m", "1"], ",", 
               SubscriptBox["m", "2"]}], "]"}]}], "}"}], ",", "M"}], 
          "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.831423133505221*^9, 3.83142480008962*^9, 
  3.8324243757402*^9, 3.8324248424171596`*^9, 3.8324251609875493`*^9, 
  3.832425267137944*^9, 3.833036179804171*^9},
 CellLabel->
  "Out[193]//TableForm=",ExpressionUUID->"6f663c6c-05be-4e4a-823f-\
9234a7f0ee0d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functional Forms for Investment cost and transitions", "Section",
 CellChangeTimes->{{3.831423148635499*^9, 
  3.831423154422999*^9}},ExpressionUUID->"b54ba43a-bf57-4769-ab35-\
c197e411a0e3"],

Cell[CellGroupData[{

Cell["Quadratic investment cost function", "Subsection",
 CellChangeTimes->{{3.829526944265134*^9, 
  3.8295269473937197`*^9}},ExpressionUUID->"e74d9454-5d66-4369-a418-\
9781f58a3abf"],

Cell["\<\
If investment \"effort\" level at firm i is ui, then firm i spends CIi[ui] \
dollars.\
\>", "Text",ExpressionUUID->"f6d0b360-52db-4fa1-a26f-fc19b504e60f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CI", "[", "u_", "]"}], "=", 
   RowBox[{"d", " ", 
    RowBox[{"(", " ", 
     RowBox[{
      SuperscriptBox["u", "2"], "/", "2"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.3880185283258114`*^9, 3.388018532321557*^9}, {
  3.389029014390625*^9, 3.389029039765625*^9}, {3.829526953289445*^9, 
  3.829526953480543*^9}, {3.829527131868443*^9, 3.829527135234538*^9}, {
  3.829695304479143*^9, 3.8296953062529297`*^9}, {3.829695364436029*^9, 
  3.829695369411332*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"5708e066-5d76-4876-8de7-66458165c74f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear transition hazard rate", "Subsection",
 CellChangeTimes->{{3.829526944265134*^9, 3.8295269473937197`*^9}, {
  3.829531471150168*^9, 
  3.829531481413604*^9}},ExpressionUUID->"d370d45b-5bfb-47b7-b06c-\
933a8b170689"],

Cell["We try the following functional form for \[Phi]", "Text",ExpressionUUID->"79908cab-78b4-4e03-a967-9dcc8a0c3135"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Phi]", "i_"], "[", 
   RowBox[{"xuvec_", ",", "ymvec_"}], "]"}], ":=", " ", 
  RowBox[{"\[Alpha]", " ", 
   RowBox[{"xuvec", "[", 
    RowBox[{"[", "i", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.388168597996075*^9, 3.388168599568336*^9}, {
  3.389711465856285*^9, 3.389711466587336*^9}, {3.8303556479203577`*^9, 
  3.830355706486165*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"91d67e31-e41b-46c5-99dc-595a81bf9cc2"],

Cell["", "PageBreak",
 PageBreakBelow->True,ExpressionUUID->"24792cf8-1e79-4526-8634-6a9ef7e1c83c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["System", "Section",
 CellChangeTimes->{{3.389723048009173*^9, 3.3897230546787634`*^9}, {
  3.829578931935226*^9, 
  3.8295789328236723`*^9}},ExpressionUUID->"b239cd50-70db-4fba-87aa-\
4fc3d325e207"],

Cell[CellGroupData[{

Cell[BoxData["sys2"], "Input",
 CellChangeTimes->{{3.831423208791951*^9, 3.8314232095489693`*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"b4bfc1eb-11e8-4adc-a69c-c8662eb61a1d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]", " ", 
     RowBox[{
      SubscriptBox["V", "1"], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"profits", "[", 
      RowBox[{"1", ",", 
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", "d", " ", 
      SuperscriptBox[
       RowBox[{
        SubscriptBox["U", "1"], "[", 
        RowBox[{
         SubscriptBox["m", "1"], ",", 
         SubscriptBox["m", "2"]}], "]"}], "2"]}], "+", 
     RowBox[{"\[Delta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["V", "1"], "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["m", "1"]}], ",", 
           SubscriptBox["m", "2"]}], "]"}]}], "+", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["V", "1"], "[", 
          RowBox[{
           SubscriptBox["m", "1"], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["m", "2"]}]}], "]"}]}], "+", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Alpha]", " ", 
      RowBox[{
       SubscriptBox["U", "2"], "[", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        SubscriptBox["m", "2"]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          RowBox[{"1", "+", 
           SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Alpha]", " ", 
      RowBox[{
       SubscriptBox["U", "1"], "[", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        SubscriptBox["m", "2"]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          RowBox[{"1", "+", 
           SubscriptBox["m", "1"]}], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "d"}], " ", 
      RowBox[{
       SubscriptBox["U", "1"], "[", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        SubscriptBox["m", "2"]}], "]"}]}], "+", 
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          RowBox[{"1", "+", 
           SubscriptBox["m", "1"]}], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"\[Rho]", " ", 
     RowBox[{
      SubscriptBox["V", "2"], "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"profits", "[", 
      RowBox[{"2", ",", 
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "]"}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", "d", " ", 
      SuperscriptBox[
       RowBox[{
        SubscriptBox["U", "2"], "[", 
        RowBox[{
         SubscriptBox["m", "1"], ",", 
         SubscriptBox["m", "2"]}], "]"}], "2"]}], "+", 
     RowBox[{"\[Delta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["V", "2"], "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["m", "1"]}], ",", 
           SubscriptBox["m", "2"]}], "]"}]}], "+", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["V", "2"], "[", 
          RowBox[{
           SubscriptBox["m", "1"], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["m", "2"]}]}], "]"}]}], "+", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Alpha]", " ", 
      RowBox[{
       SubscriptBox["U", "2"], "[", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        SubscriptBox["m", "2"]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          RowBox[{"1", "+", 
           SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Alpha]", " ", 
      RowBox[{
       SubscriptBox["U", "1"], "[", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        SubscriptBox["m", "2"]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          RowBox[{"1", "+", 
           SubscriptBox["m", "1"]}], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "d"}], " ", 
      RowBox[{
       SubscriptBox["U", "2"], "[", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        SubscriptBox["m", "2"]}], "]"}]}], "+", 
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          RowBox[{"1", "+", 
           SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8314232099968147`*^9, 3.8314248001503*^9, 
  3.8324243761329875`*^9, 3.8324248428024454`*^9, 3.832425161251941*^9, 
  3.832425267317388*^9, 3.8330361799982095`*^9},
 CellLabel->
  "Out[196]=",ExpressionUUID->"0f1bdd42-ce1e-4a85-a306-72bc5b9e0b4b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numstates", "=", "5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eqstab", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"sys2", ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["m", "1"], ",", "1", ",", "numstates"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["m", "2"], ",", "1", ",", "numstates"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["m", "3"], ",", "1", ",", "numstates"}], "}"}]}], "]"}], 
    "//", "Flatten"}]}], ";"}], "\n", 
 RowBox[{"eqstab", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.830381199036227*^9, 3.830381203842596*^9}, {
   3.830381280865884*^9, 3.8303812815997467`*^9}, {3.830381854648628*^9, 
   3.830381855246059*^9}, 3.830386345869972*^9, {3.831398771829131*^9, 
   3.831398775326716*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"3c5c2dea-278f-4a95-b743-7732ce2fc71e"],

Cell[BoxData["500"], "Output",
 CellChangeTimes->{
  3.830357124731421*^9, 3.830381007163815*^9, 3.830381053712268*^9, 
   3.8303812338572273`*^9, 3.8303812852407293`*^9, {3.830381386092677*^9, 
   3.830381413964931*^9}, 3.830381860741802*^9, 3.830382601564559*^9, 
   3.830386347630934*^9, 3.830386549076952*^9, 3.830872679433084*^9, 
   3.831388298512699*^9, 3.8313987781914062`*^9, 3.831403533984498*^9, 
   3.8314041898429813`*^9, 3.8314042247279873`*^9, 3.83140524036193*^9, 
   3.831405345409998*^9, 3.831405483026531*^9, 3.831409688021565*^9, 
   3.831410338823677*^9, 3.8314115632832003`*^9, 3.8314231849409113`*^9, 
   3.831424800208069*^9, 3.832424376260095*^9, 3.832424842970909*^9, 
   3.8324251613495913`*^9, 3.8324252674285913`*^9, 3.8330361802880774`*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"e425616b-9f1c-4375-838a-afeb9aaf6225"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eqstab", "//", "Union"}], "//", "Length"}]], "Input",
 CellChangeTimes->{{3.830357178351062*^9, 3.83035718578837*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"287a2f87-1274-49af-856b-85cbc0582b14"],

Cell[BoxData["100"], "Output",
 CellChangeTimes->{
  3.8303571867792892`*^9, 3.830381008050777*^9, 3.830381054867578*^9, 
   3.8303812352129803`*^9, 3.830381286766863*^9, {3.830381386168333*^9, 
   3.8303814141057167`*^9}, 3.830381860747954*^9, 3.8303863499382133`*^9, 
   3.830386549810891*^9, 3.830872679440919*^9, 3.831388298518169*^9, 
   3.831398798141861*^9, 3.831403533990407*^9, 3.831404226831587*^9, 
   3.831405240367771*^9, 3.831405347129395*^9, 3.831405483032859*^9, 
   3.8314096880271378`*^9, 3.831410338829383*^9, 3.831411563289349*^9, 
   3.831423186360372*^9, 3.831424800215431*^9, 3.832424376364884*^9, 
   3.8324248430839252`*^9, 3.8324251614532695`*^9, 3.832425267518402*^9, 
   3.8330361803867855`*^9},
 CellLabel->
  "Out[200]=",ExpressionUUID->"273a22a0-20bd-4a4a-ae6a-5b3f6274f65c"]
}, Open  ]],

Cell["\<\
We zero out the value function if any state equals zero  (which is not \
possible).\
\>", "Text",
 CellChangeTimes->{{3.831423239004045*^9, 3.8314232565559196`*^9}, {
  3.831423312810143*^9, 
  3.8314233133312473`*^9}},ExpressionUUID->"9ed5a693-38b9-4662-ac4a-\
7c4c1ed22707"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqstab2", "=", 
   RowBox[{"eqstab", "/.", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["V", "i_"], "[", 
      RowBox[{"zz___", ",", "0", ",", "yy___"}], "]"}], "\[Rule]", "0"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.830356664386085*^9, 3.830356666234748*^9}, {
   3.830356706472492*^9, 3.830356774004923*^9}, {3.8303569596800137`*^9, 
   3.830357077872651*^9}, 3.830381132414317*^9, {3.830381832682044*^9, 
   3.830381837416144*^9}, {3.8303863821876307`*^9, 3.830386411776801*^9}, {
   3.830386449401689*^9, 3.830386455519699*^9}, {3.831403524628647*^9, 
   3.831403524826838*^9}, 3.831423270737228*^9, 3.831423332097864*^9},
 CellLabel->
  "In[201]:=",ExpressionUUID->"8fd5748f-ea94-453f-b597-0139f750ce4d"],

Cell["\<\
We zero out the value function if any state equals numstates+1 (which is not \
possible).\
\>", "Text",
 CellChangeTimes->{{3.831423239004045*^9, 3.8314232565559196`*^9}, {
  3.83142328887636*^9, 
  3.831423305425736*^9}},ExpressionUUID->"9abf67c7-f724-4ac5-8b33-\
5b647854ae39"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqstab2", "=", 
   RowBox[{"eqstab2", "/.", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["V", "i_"], "[", 
      RowBox[{"zz___", ",", 
       RowBox[{"numstates", "+", "1"}], ",", "yy___"}], "]"}], "\[Rule]", 
     "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.830381876471328*^9, 3.830381903508459*^9}, {
   3.8303820160269213`*^9, 3.8303820194093523`*^9}, 3.830382060105986*^9, {
   3.831411647306933*^9, 3.8314116486909227`*^9}, {3.831423319922358*^9, 
   3.831423339257312*^9}, {3.831423709477466*^9, 3.831423709982006*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"f3e8badc-e6ed-4ef1-a8f9-2235628f7677"],

Cell["Next let\[CloseCurlyQuote]s give some values to the parameters", "Text",
 CellChangeTimes->{{3.831423347304429*^9, 3.831423351592183*^9}, {
  3.831423568946213*^9, 
  3.831423572425148*^9}},ExpressionUUID->"25551b8e-a622-4eb7-9a04-\
c8cd5af64ca9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"eqstab2", "/.", 
       RowBox[{"d", "\[Rule]", "1"}]}], "/.", 
      RowBox[{
       RowBox[{"\[CapitalTheta]", "[", "i_", "]"}], "\[Rule]", 
       RowBox[{"5", "-", " ", "i"}]}]}], "/.", 
     RowBox[{"\[Alpha]", "\[Rule]", "1"}]}], "/.", 
    RowBox[{"\[Rho]", "\[Rule]", 
     RowBox[{"1", "/", "20"}]}]}], "/.", 
   RowBox[{"\[Delta]", "\[Rule]", "0"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.831423576329818*^9, 3.8314235907772913`*^9}},
 CellLabel->
  "In[203]:=",ExpressionUUID->"d33c6a34-a737-4f7d-b532-eabb3814aa7a"],

Cell["Convert the equations to differences", "Text",
 CellChangeTimes->{{3.8314236044165897`*^9, 
  3.831423609832313*^9}},ExpressionUUID->"351e2b6b-cd44-4a7e-b08c-\
ac5785b14ae1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"diff", "=", 
  RowBox[{"%", "/.", 
   RowBox[{
    RowBox[{"zz__", "\[Equal]", "yy__"}], " ", "\[Rule]", " ", 
    RowBox[{"zz", "-", "yy"}]}]}]}]], "Input",
 CellChangeTimes->{{3.830356855940383*^9, 3.830356867968957*^9}, {
  3.830386483072104*^9, 3.830386484551075*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"e4fbdde7-dce0-461a-b049-bec9e03813f0"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"profits", "[", 
              RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SuperscriptBox[
              RowBox[{
               SubscriptBox["U", "1"], "[", 
               RowBox[{"1", ",", "1"}], "]"}], "2"]}], "+", 
            RowBox[{
             FractionBox["1", "20"], " ", 
             RowBox[{
              SubscriptBox["V", "1"], "[", 
              RowBox[{"1", ",", "1"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "2"], "[", 
              RowBox[{"1", ",", "1"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["V", "1"], "[", 
                RowBox[{"1", ",", "1"}], "]"}], "-", 
               RowBox[{
                SubscriptBox["V", "1"], "[", 
                RowBox[{"1", ",", "2"}], "]"}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "1"], "[", 
              RowBox[{"1", ",", "1"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["V", "1"], "[", 
                RowBox[{"1", ",", "1"}], "]"}], "-", 
               RowBox[{
                SubscriptBox["V", "1"], "[", 
                RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{
             SubscriptBox["U", "1"], "[", 
             RowBox[{"1", ",", "1"}], "]"}], "-", 
            RowBox[{
             SubscriptBox["V", "1"], "[", 
             RowBox[{"1", ",", "1"}], "]"}], "+", 
            RowBox[{
             SubscriptBox["V", "1"], "[", 
             RowBox[{"2", ",", "1"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"profits", "[", 
              RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SuperscriptBox[
              RowBox[{
               SubscriptBox["U", "2"], "[", 
               RowBox[{"1", ",", "1"}], "]"}], "2"]}], "+", 
            RowBox[{
             FractionBox["1", "20"], " ", 
             RowBox[{
              SubscriptBox["V", "2"], "[", 
              RowBox[{"1", ",", "1"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "2"], "[", 
              RowBox[{"1", ",", "1"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["V", "2"], "[", 
                RowBox[{"1", ",", "1"}], "]"}], "-", 
               RowBox[{
                SubscriptBox["V", "2"], "[", 
                RowBox[{"1", ",", "2"}], "]"}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "1"], "[", 
              RowBox[{"1", ",", "1"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["V", "2"], "[", 
                RowBox[{"1", ",", "1"}], "]"}], "-", 
               RowBox[{
                SubscriptBox["V", "2"], "[", 
                RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{
             SubscriptBox["U", "2"], "[", 
             RowBox[{"1", ",", "1"}], "]"}], "-", 
            RowBox[{
             SubscriptBox["V", "2"], "[", 
             RowBox[{"1", ",", "1"}], "]"}], "+", 
            RowBox[{
             SubscriptBox["V", "2"], "[", 
             RowBox[{"1", ",", "2"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"profits", "[", 
              RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SuperscriptBox[
              RowBox[{
               SubscriptBox["U", "1"], "[", 
               RowBox[{"1", ",", "1"}], "]"}], "2"]}], "+", 
            RowBox[{
             FractionBox["1", "20"], " ", 
             RowBox[{
              SubscriptBox["V", "1"], "[", 
              RowBox[{"1", ",", "1"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "2"], "[", 
              RowBox[{"1", ",", "1"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["V", "1"], "[", 
                RowBox[{"1", ",", "1"}], "]"}], "-", 
               RowBox[{
                SubscriptBox["V", "1"], "[", 
                RowBox[{"1", ",", "2"}], "]"}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "1"], "[", 
              RowBox[{"1", ",", "1"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["V", "1"], "[", 
                RowBox[{"1", ",", "1"}], "]"}], "-", 
               RowBox[{
                SubscriptBox["V", "1"], "[", 
                RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{
             SubscriptBox["U", "1"], "[", 
             RowBox[{"1", ",", "1"}], "]"}], "-", 
            RowBox[{
             SubscriptBox["V", "1"], "[", 
             RowBox[{"1", ",", "1"}], "]"}], "+", 
            RowBox[{
             SubscriptBox["V", "1"], "[", 
             RowBox[{"2", ",", "1"}], "]"}]}], ",", 
           TemplateBox[{"488"},
            "OutputSizeLimit`Skeleton"], ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"profits", "[", 
              RowBox[{"2", ",", "5", ",", "5"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SuperscriptBox[
              RowBox[{
               SubscriptBox["U", "2"], "[", 
               RowBox[{"5", ",", "5"}], "]"}], "2"]}], "+", 
            RowBox[{
             FractionBox["1", "20"], " ", 
             RowBox[{
              SubscriptBox["V", "2"], "[", 
              RowBox[{"5", ",", "5"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "1"], "[", 
              RowBox[{"5", ",", "5"}], "]"}], " ", 
             RowBox[{
              SubscriptBox["V", "2"], "[", 
              RowBox[{"5", ",", "5"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "2"], "[", 
              RowBox[{"5", ",", "5"}], "]"}], " ", 
             RowBox[{
              SubscriptBox["V", "2"], "[", 
              RowBox[{"5", ",", "5"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             SubscriptBox["U", "2"], "[", 
             RowBox[{"5", ",", "5"}], "]"}], "-", 
            RowBox[{
             SubscriptBox["V", "2"], "[", 
             RowBox[{"5", ",", "5"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"profits", "[", 
              RowBox[{"1", ",", "5", ",", "5"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SuperscriptBox[
              RowBox[{
               SubscriptBox["U", "1"], "[", 
               RowBox[{"5", ",", "5"}], "]"}], "2"]}], "+", 
            RowBox[{
             FractionBox["1", "20"], " ", 
             RowBox[{
              SubscriptBox["V", "1"], "[", 
              RowBox[{"5", ",", "5"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "1"], "[", 
              RowBox[{"5", ",", "5"}], "]"}], " ", 
             RowBox[{
              SubscriptBox["V", "1"], "[", 
              RowBox[{"5", ",", "5"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "2"], "[", 
              RowBox[{"5", ",", "5"}], "]"}], " ", 
             RowBox[{
              SubscriptBox["V", "1"], "[", 
              RowBox[{"5", ",", "5"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             SubscriptBox["U", "1"], "[", 
             RowBox[{"5", ",", "5"}], "]"}], "-", 
            RowBox[{
             SubscriptBox["V", "1"], "[", 
             RowBox[{"5", ",", "5"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"profits", "[", 
              RowBox[{"2", ",", "5", ",", "5"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SuperscriptBox[
              RowBox[{
               SubscriptBox["U", "2"], "[", 
               RowBox[{"5", ",", "5"}], "]"}], "2"]}], "+", 
            RowBox[{
             FractionBox["1", "20"], " ", 
             RowBox[{
              SubscriptBox["V", "2"], "[", 
              RowBox[{"5", ",", "5"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "1"], "[", 
              RowBox[{"5", ",", "5"}], "]"}], " ", 
             RowBox[{
              SubscriptBox["V", "2"], "[", 
              RowBox[{"5", ",", "5"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              SubscriptBox["U", "2"], "[", 
              RowBox[{"5", ",", "5"}], "]"}], " ", 
             RowBox[{
              SubscriptBox["V", "2"], "[", 
              RowBox[{"5", ",", "5"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             SubscriptBox["U", "2"], "[", 
             RowBox[{"5", ",", "5"}], "]"}], "-", 
            RowBox[{
             SubscriptBox["V", "2"], "[", 
             RowBox[{"5", ",", "5"}], "]"}]}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{65., {3., 9.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{52., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 204, 17486389755989098845, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{62., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 204, 17486389755989098845, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{44., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 204, 17486389755989098845, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{78., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[17486389755989098845 === $SessionID, 
   Out[204], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{3.831423628467615*^9, 3.831423716910625*^9, 
  3.831424800556519*^9, 3.832424376768641*^9, 3.832424843329068*^9, 
  3.8324251617565794`*^9, 3.832425268174059*^9, 3.833036180926594*^9},
 CellLabel->
  "Out[204]=",ExpressionUUID->"3d7511c2-da96-4e06-92a1-f48f3e09b3c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"diffff", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"diff", "/.", 
      RowBox[{
       RowBox[{"profits", "[", "zz___", "]"}], "->", "0"}]}], "//", 
     "Flatten"}], "//", "Union"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Variables", "/@", "diffff"}], "//", "Flatten"}], "//", 
    "Union"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.830356874777419*^9, 3.830356889040202*^9}, {
   3.830357349967925*^9, 3.830357351341775*^9}, 3.830357517824931*^9, {
   3.830357602501431*^9, 3.830357604155733*^9}, {3.830386492903654*^9, 
   3.8303865060041103`*^9}, {3.831404261312758*^9, 3.831404279887681*^9}, {
   3.831404325158449*^9, 3.831404331797429*^9}, {3.831404596170355*^9, 
   3.8314046252397327`*^9}, {3.831411576901629*^9, 3.831411579068265*^9}, {
   3.832424233460764*^9, 3.832424234388583*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"65347063-cf31-4e76-bc2d-1b5e465561b4"],

Cell[BoxData["100"], "Output",
 CellChangeTimes->{3.8314046284508266`*^9, 3.831405240855492*^9, 
  3.8314053522543077`*^9, 3.831405483452594*^9, 3.831409696070821*^9, 
  3.831411581161808*^9, 3.831411655560554*^9, 3.83142366742775*^9, 
  3.8314237184275007`*^9, 3.831424805832356*^9, 3.8324243770232368`*^9, 
  3.8324248434435415`*^9, 3.832425161883342*^9, 3.8324252682881064`*^9, 
  3.8330361810307927`*^9},
 CellLabel->
  "Out[207]=",ExpressionUUID->"7927f519-6dbe-4bf6-9a35-5c61027e17c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"diff", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "6"}], "]"}], "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.8303865881331253`*^9, 3.830386596987211*^9}, {
  3.8314048411862087`*^9, 3.831404841831756*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"51ecf948-54fe-4701-975f-779f98a38720"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"profits", "[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["U", "1"], "[", 
          RowBox[{"1", ",", "1"}], "]"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "20"], " ", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["U", "2"], "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["V", "1"], "[", 
           RowBox[{"1", ",", "1"}], "]"}], "-", 
          RowBox[{
           SubscriptBox["V", "1"], "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["U", "1"], "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["V", "1"], "[", 
           RowBox[{"1", ",", "1"}], "]"}], "-", 
          RowBox[{
           SubscriptBox["V", "1"], "[", 
           RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{
        SubscriptBox["U", "1"], "[", 
        RowBox[{"1", ",", "1"}], "]"}], "-", 
       RowBox[{
        SubscriptBox["V", "1"], "[", 
        RowBox[{"1", ",", "1"}], "]"}], "+", 
       RowBox[{
        SubscriptBox["V", "1"], "[", 
        RowBox[{"2", ",", "1"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"profits", "[", 
         RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["U", "2"], "[", 
          RowBox[{"1", ",", "1"}], "]"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "20"], " ", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["U", "2"], "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["V", "2"], "[", 
           RowBox[{"1", ",", "1"}], "]"}], "-", 
          RowBox[{
           SubscriptBox["V", "2"], "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["U", "1"], "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["V", "2"], "[", 
           RowBox[{"1", ",", "1"}], "]"}], "-", 
          RowBox[{
           SubscriptBox["V", "2"], "[", 
           RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{
        SubscriptBox["U", "2"], "[", 
        RowBox[{"1", ",", "1"}], "]"}], "-", 
       RowBox[{
        SubscriptBox["V", "2"], "[", 
        RowBox[{"1", ",", "1"}], "]"}], "+", 
       RowBox[{
        SubscriptBox["V", "2"], "[", 
        RowBox[{"1", ",", "2"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"profits", "[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["U", "1"], "[", 
          RowBox[{"1", ",", "1"}], "]"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "20"], " ", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["U", "2"], "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["V", "1"], "[", 
           RowBox[{"1", ",", "1"}], "]"}], "-", 
          RowBox[{
           SubscriptBox["V", "1"], "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["U", "1"], "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["V", "1"], "[", 
           RowBox[{"1", ",", "1"}], "]"}], "-", 
          RowBox[{
           SubscriptBox["V", "1"], "[", 
           RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{
        SubscriptBox["U", "1"], "[", 
        RowBox[{"1", ",", "1"}], "]"}], "-", 
       RowBox[{
        SubscriptBox["V", "1"], "[", 
        RowBox[{"1", ",", "1"}], "]"}], "+", 
       RowBox[{
        SubscriptBox["V", "1"], "[", 
        RowBox[{"2", ",", "1"}], "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8303868258246937`*^9, 3.830386951810938*^9, {3.830386991371512*^9, 
   3.830387014956369*^9}, 3.8303870717818737`*^9, 3.830387120412842*^9, 
   3.830387164431182*^9, 3.830387555965261*^9, 3.830429977625885*^9, 
   3.830430011384802*^9, {3.830430075258409*^9, 3.830430092692607*^9}, 
   3.830430744607415*^9, 3.8308726799298983`*^9, 3.831388298926058*^9, 
   3.8313988933877163`*^9, 3.831403534435135*^9, 3.831404842289557*^9, {
   3.831405223305687*^9, 3.8314052408631372`*^9}, 3.831405497138633*^9, 
   3.8314096988833847`*^9, 3.8314237330598907`*^9, 3.831424808638445*^9, 
   3.8324243771632466`*^9, 3.8324248435911264`*^9, 3.8324251620379457`*^9, 
   3.832425268456813*^9, 3.833036181145483*^9},
 CellLabel->
  "Out[208]//TableForm=",ExpressionUUID->"1ed115c3-8557-4081-9b54-\
c28d4d4ec8a8"]
}, Open  ]],

Cell["\<\
At this point, we add the profit function and theta values. We could \
subtsitute out the Profit[1,M] terms but instead we will add equations that \
define those terms\
\>", "Text",
 CellChangeTimes->{{3.8314238499841967`*^9, 3.831423863735758*^9}, {
  3.831423899399166*^9, 
  3.831423950245472*^9}},ExpressionUUID->"2d9bbca8-b0cd-40b2-bfdc-\
89a27dd2c803"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ProfDefns", "[", 
   RowBox[{"i_", ",", "mvec"}], "]"}], "=", 
  RowBox[{
   RowBox[{"profits", "[", 
    RowBox[{"i", ",", 
     RowBox[{"Sequence", "@@", "mvec"}]}], "]"}], "-", 
   RowBox[{"ProfitFcn", "[", 
    RowBox[{"i", ",", 
     RowBox[{"\[Theta]", "[", "1", "]"}], ",", 
     RowBox[{"\[Theta]", "[", "2", "]"}], ",", 
     RowBox[{"\[Theta]", "[", "3", "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.831423978950119*^9, 3.8314240908826942`*^9}, {
  3.831424835625455*^9, 3.831424836849433*^9}, {3.831424871360505*^9, 
  3.831424890225292*^9}, {3.832424240918584*^9, 3.832424241573783*^9}, {
  3.8324243013724017`*^9, 3.832424304218334*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"f05d4e05-b6a9-4423-9743-0cc48842060a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"ProfitFcn", "[", 
    RowBox[{"i", ",", 
     RowBox[{"\[Theta]", "[", "1", "]"}], ",", 
     RowBox[{"\[Theta]", "[", "2", "]"}], ",", 
     RowBox[{"\[Theta]", "[", "3", "]"}]}], "]"}]}], "+", 
  RowBox[{"profits", "[", 
   RowBox[{"i", ",", 
    SubscriptBox["m", "1"], ",", 
    SubscriptBox["m", "2"]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.8314248789083233`*^9, 3.8314248907903852`*^9}, 
   3.832424377274476*^9, 3.8324248439284267`*^9, 3.8324251621436853`*^9, 
   3.832425268529531*^9, 3.833036181247012*^9},
 CellLabel->
  "Out[209]=",ExpressionUUID->"cf17a5c8-6bc7-4254-956f-b4522155c7f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"syseqs", "=", 
  RowBox[{"%", "/.", " ", 
   RowBox[{
    RowBox[{
     SubscriptBox["z_", "i_"], "[", 
     RowBox[{"j_", ",", "k_", ",", "m_"}], "]"}], " ", "\[RuleDelayed]", " ", 
    
    RowBox[{"ToExpression", "[", 
     RowBox[{
      RowBox[{"ToString", "[", "z", "]"}], "~~", 
      RowBox[{"ToString", "[", "i", "]"}], "~~", 
      RowBox[{"ToString", "[", "j", "]"}], "~~", 
      RowBox[{"ToString", "[", "k", "]"}], "~~", 
      RowBox[{"ToString", "[", "m", "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.830386700903775*^9, 3.8303868124104*^9}, {
  3.830386853061699*^9, 3.830386882816814*^9}, {3.830386913360424*^9, 
  3.8303869445674667`*^9}, {3.8303869801512117`*^9, 3.830387011414214*^9}, {
  3.8303871671036997`*^9, 3.8303871689028883`*^9}, {3.830387543421445*^9, 
  3.8303875514029703`*^9}, {3.830429955048258*^9, 3.830429970382373*^9}, {
  3.830430000939834*^9, 3.830430089766789*^9}, {3.8304307290457897`*^9, 
  3.830430738205352*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"6f4fa9b3-ff69-4f9e-b7c5-c8b8c496b996"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"ProfitFcn", "[", 
    RowBox[{"i", ",", 
     RowBox[{"\[Theta]", "[", "1", "]"}], ",", 
     RowBox[{"\[Theta]", "[", "2", "]"}], ",", 
     RowBox[{"\[Theta]", "[", "3", "]"}]}], "]"}]}], "+", 
  RowBox[{"profits", "[", 
   RowBox[{"i", ",", 
    SubscriptBox["m", "1"], ",", 
    SubscriptBox["m", "2"]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.830386785311256*^9, 3.830386827482856*^9}, {
   3.8303869471514997`*^9, 3.830386957026587*^9}, {3.830386987641768*^9, 
   3.830387015984865*^9}, 3.830387072652843*^9, 3.8303871211776543`*^9, 
   3.830387169858101*^9, 3.830387556981216*^9, {3.830429972122488*^9, 
   3.830429978356064*^9}, 3.83043001250231*^9, {3.830430046728459*^9, 
   3.830430093351276*^9}, 3.830430749793841*^9, 3.830872679999796*^9, 
   3.831388298994882*^9, 3.831398911455988*^9, 3.831403534505999*^9, 
   3.831404851790855*^9, 3.83140524094656*^9, 3.831405497313836*^9, 
   3.8314097003009367`*^9, 3.8324243774426126`*^9, 3.832424844301138*^9, 
   3.832425162253151*^9, 3.8324252686565895`*^9, 3.833036181346904*^9},
 CellLabel->
  "Out[210]=",ExpressionUUID->"6522e2dc-876a-4725-84a5-8cc454da1878"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Productivity States", "Subsection",ExpressionUUID->"ef9a1ad2-05c5-4009-912f-fcb0f8d55e37"],

Cell[TextData[{
 "States: for i=1,2,...,Nst, we let the productivity parameter  in state i be\
\n\n",
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[Theta]", "[", "i", "]"}], "=", 
   SuperscriptBox["\[CapitalTheta]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"i", "-", "1"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"Nst", "-", "1"}], ")"}]}]]}]], "Text",ExpressionUUID->
  "2d152124-e110-4490-aa12-f67e50aa285e"],
 "\n\nEach firm's productivity depends on its state. Each firm has the same \
\[Theta][i] function.\n\n",
 Cell[BoxData[
 "\[CapitalTheta]"], "Output",ExpressionUUID->
  "58b0a774-692f-4e51-8fd7-458184023e1a"],
 " is the ratio of cost in lowest cost state relative to highest cost state. \
So, \[CapitalTheta]=1/5 means that the cost in state 1 is 5 times the cost in \
state Nst.\nNotice that this ratio of the extreme states is invariant to the \
number of states, Nst."
}], "Text",
 CellChangeTimes->{{3.8295824035390987`*^9, 
  3.829582404147316*^9}},ExpressionUUID->"74d2624e-3202-4c4f-9e9d-\
ea66ba81c420"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]1", "[", "m_", "]"}], "=", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "m_", "]"}], "=", 
   SuperscriptBox["\[CapitalTheta]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"m", "-", "1"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"Nst", "-", "1"}], ")"}]}]]}]}]], "Text",
 CellChangeTimes->{{3.829582431060072*^9, 3.829582482561336*^9}, 
   3.829582531673633*^9},
 CellLabel->
  "In[4786]:=",ExpressionUUID->"0cc84d3d-184f-4817-832a-ecd98b74ea6f"],

Cell["\<\
I do NOT substitute this into our equations because there is no need to \
repeatedly compute the powers of Theta. This information should be read in as \
a parameter vector.\
\>", "Text",
 CellChangeTimes->{{3.829582540247005*^9, 
  3.829582599499543*^9}},ExpressionUUID->"55c96336-711b-4d8c-b91d-\
134c6a256fae"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Add state dependency of \[Theta]\[CloseCurlyQuote]s and definitions of \
results", "Section",
 CellChangeTimes->{{3.829582113305868*^9, 3.829582123276965*^9}, {
  3.829582974988592*^9, 
  3.829582982268221*^9}},ExpressionUUID->"1a0b0052-504a-487d-8d97-\
88e1cb042aaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sys\[Delta]0", "=", 
   RowBox[{"sys", "/.", " ", 
    RowBox[{"\[Delta]", "->", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8295821543177137`*^9, 3.8295821604744873`*^9}, {
  3.829583471233733*^9, 3.8295835026712837`*^9}, {3.8314097837308617`*^9, 
  3.831409803051631*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"9035728e-205d-41fe-82c2-c12cbc9584f8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sys\[Delta]0", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.829583336221394*^9, 3.829583338053039*^9}, {
  3.829583507136303*^9, 3.8295835077354*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"317937a6-304f-4077-9759-df025b542aea"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"\[Rho]", " ", 
        RowBox[{
         RowBox[{"V", "[", "1", "]"}], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{"profits", "[", 
         RowBox[{"1", ",", 
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", "d", " ", 
         SuperscriptBox[
          RowBox[{"u", "[", "1", "]"}], "2"]}], "+", 
        RowBox[{"\[Alpha]", " ", 
         RowBox[{"u", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             RowBox[{"1", "+", 
              SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"\[Alpha]", " ", 
         RowBox[{"u", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             RowBox[{"1", "+", 
              SubscriptBox["m", "1"]}], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", 
         RowBox[{"u", "[", "1", "]"}]}], "+", 
        RowBox[{"\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             RowBox[{"1", "+", 
              SubscriptBox["m", "1"]}], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Rho]", " ", 
        RowBox[{
         RowBox[{"V", "[", "2", "]"}], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{"profits", "[", 
         RowBox[{"2", ",", 
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", "d", " ", 
         SuperscriptBox[
          RowBox[{"u", "[", "2", "]"}], "2"]}], "+", 
        RowBox[{"\[Alpha]", " ", 
         RowBox[{"u", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             RowBox[{"1", "+", 
              SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"\[Alpha]", " ", 
         RowBox[{"u", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             RowBox[{"1", "+", 
              SubscriptBox["m", "1"]}], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", 
         RowBox[{"u", "[", "2", "]"}]}], "+", 
        RowBox[{"\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             RowBox[{"1", "+", 
              SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8302624696699877`*^9, 3.830872704192329*^9, 
  3.831388310468851*^9, 3.8314035347253103`*^9, 3.831405509288622*^9, 
  3.831409804879821*^9, 3.8324243775995874`*^9, 3.8324248452874975`*^9, 
  3.832425162549426*^9, 3.8324252687589083`*^9, 3.8330361814961295`*^9},
 CellLabel->
  "Out[212]//TableForm=",ExpressionUUID->"d823a6cc-9a40-4cb3-b3b7-\
24c55f84c5a4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"totsys", "=", "sys"}], ";"}]], "Input",
 CellChangeTimes->{{3.831409871585228*^9, 3.831409874486968*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"aeb1cbed-194b-4f30-a1b5-97cc96837bfe"],

Cell["\<\
NOTE: One could just substitute the strategy functions for the strategy \
choices. I did not do that so that I could save space when writing the \
equations.\
\>", "Text",
 CellChangeTimes->{{3.829584289345126*^9, 
  3.82958434650918*^9}},ExpressionUUID->"2c262419-9877-42ef-bb04-\
bed3a5f4094f"],

Cell["", "PageBreak",
 PageBreakBelow->True,ExpressionUUID->"c10a3158-ee24-4abc-a784-f32b18fde8ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Formulas without Greek letters", "Section",ExpressionUUID->"f57f9a21-228b-466a-b346-ac699ebb99b3"],

Cell["\<\
I used Greek letters above to keep down the size of expressions. Greek \
letters are not in most programming languages. Therefore, I replace Greek \
letters with their English names.\
\>", "Text",
 CellChangeTimes->{{3.388220868194482*^9, 3.388220883145981*^9}, {
  3.829582677091962*^9, 
  3.829582685844308*^9}},ExpressionUUID->"6f0794da-8f17-4fa6-a0e7-\
fa26a64f4de5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]", "=", "rho"}], ";", " ", 
  RowBox[{"\[Alpha]", "=", "alpha"}], ";", 
  RowBox[{"\[Beta]", "=", "beta"}], ";", " ", 
  RowBox[{"\[Delta]", "=", "delta"}], ";", " ", 
  RowBox[{"\[Theta]1", "=", "theta1"}], ";", 
  RowBox[{"\[Theta]2", "=", "theta2"}], ";", " ", 
  RowBox[{"\[CapitalTheta]", "=", "THETA"}], ";", " ", 
  RowBox[{"\[Eta]", "=", "eta"}], ";", " ", 
  RowBox[{"\[Kappa]", "=", "kappa"}], ";"}]], "Input",
 CellChangeTimes->{{3.389048468015625*^9, 3.389048480203125*^9}, {
  3.3897120843456287`*^9, 3.3897120887719936`*^9}, {3.829582649814415*^9, 
  3.8295827031076612`*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"930e0e60-2b05-45ed-ab81-32efd9881d43"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"totsys", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.829579055485711*^9, 3.829579058829007*^9}, {
  3.829583558816206*^9, 3.829583559003487*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"690d4c72-f4c2-484b-ba5c-043243fa56d6"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"rho", " ", 
        RowBox[{
         RowBox[{"V", "[", "1", "]"}], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{"profits", "[", 
         RowBox[{"1", ",", 
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", "d", " ", 
         SuperscriptBox[
          RowBox[{"u", "[", "1", "]"}], "2"]}], "+", 
        RowBox[{"delta", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"V", "[", "1", "]"}], "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["m", "1"]}], ",", 
              SubscriptBox["m", "2"]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"delta", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"V", "[", "1", "]"}], "[", 
             RowBox[{
              SubscriptBox["m", "1"], ",", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["m", "2"]}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"alpha", " ", 
         RowBox[{"u", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             RowBox[{"1", "+", 
              SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"alpha", " ", 
         RowBox[{"u", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             RowBox[{"1", "+", 
              SubscriptBox["m", "1"]}], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", 
         RowBox[{"u", "[", "1", "]"}]}], "+", 
        RowBox[{"alpha", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             RowBox[{"1", "+", 
              SubscriptBox["m", "1"]}], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"rho", " ", 
        RowBox[{
         RowBox[{"V", "[", "2", "]"}], "[", 
         RowBox[{
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{"profits", "[", 
         RowBox[{"2", ",", 
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", "d", " ", 
         SuperscriptBox[
          RowBox[{"u", "[", "2", "]"}], "2"]}], "+", 
        RowBox[{"delta", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"V", "[", "2", "]"}], "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["m", "1"]}], ",", 
              SubscriptBox["m", "2"]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"delta", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"V", "[", "2", "]"}], "[", 
             RowBox[{
              SubscriptBox["m", "1"], ",", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["m", "2"]}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"alpha", " ", 
         RowBox[{"u", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             RowBox[{"1", "+", 
              SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"alpha", " ", 
         RowBox[{"u", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             RowBox[{"1", "+", 
              SubscriptBox["m", "1"]}], ",", 
             SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", 
         RowBox[{"u", "[", "2", "]"}]}], "+", 
        RowBox[{"alpha", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             SubscriptBox["m", "2"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["m", "1"], ",", 
             RowBox[{"1", "+", 
              SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8302624702278843`*^9, 3.830872704513937*^9, 
  3.831388310705716*^9, 3.831403535315299*^9, 3.8314098804573927`*^9, 
  3.8324243777871833`*^9, 3.83242484582439*^9, 3.8324251628838716`*^9, 
  3.8324252690194864`*^9, 3.8330361817566967`*^9},
 CellLabel->
  "Out[215]//TableForm=",ExpressionUUID->"fdf8182e-d94d-449d-b6e8-\
6357e501938e"]
}, Open  ]],

Cell["", "PageBreak",
 PageBreakBelow->True,ExpressionUUID->"687da371-0037-42ac-a3e8-2c5380ae468c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fortran code", "Section",
 CellChangeTimes->{{3.829579178343437*^9, 
  3.829579180175507*^9}},ExpressionUUID->"538f6b79-aad8-4799-a935-\
a27f329755bb"],

Cell["\<\
We eliminate the \[OpenCurlyDoubleQuote]==\[CloseCurlyDoubleQuote] signs to \
get expressions that fit the format of optimization solvers input\
\>", "Text",
 CellChangeTimes->{{3.829579258292555*^9, 
  3.8295792874050283`*^9}},ExpressionUUID->"46c3cd9e-e45a-4722-a98c-\
5077873ee910"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sysdiffs", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"totsys", "/.", " ", 
           RowBox[{
            RowBox[{"zz__", "\[Equal]", "yy__"}], " ", "\[Rule]", " ", 
            RowBox[{"zz", "-", "yy"}]}]}], "/.", 
          RowBox[{"d", "\[Rule]", " ", "1"}]}], "/.", 
         RowBox[{
          RowBox[{
           RowBox[{"V", "[", "i_", "]"}], "[", "j__", "]"}], "\[Rule]", " ", 
          RowBox[{"V", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{"profits", "[", "i_", "]"}], "[", "j__", "]"}], "\[Rule]", 
         " ", 
         RowBox[{"profits", "[", 
          RowBox[{"i", ",", "j"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"V", "[", 
         RowBox[{"n_", ",", 
          SubscriptBox["m", "1"], ",", 
          SubscriptBox["m", "2"]}], "]"}], "\[Rule]", " ", 
        RowBox[{"V", "[", "n", "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"V", "[", 
        RowBox[{"1", ",", "x_", ",", "y_"}], "]"}], "\[Rule]", " ", 
       RowBox[{"V", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"V", "[", 
       RowBox[{"2", ",", "x_", ",", "y_"}], "]"}], "\[Rule]", " ", 
      RowBox[{"V", "[", 
       RowBox[{"y", ",", "x"}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"profits", "[", 
      RowBox[{"1", ",", "x_", ",", "y_"}], "]"}], "\[Rule]", " ", 
     RowBox[{"profits", "[", 
      RowBox[{"x", ",", "y", ",", "nplayers", ",", "B", ",", "w"}], "]"}]}]}],
    "/.", 
   RowBox[{
    RowBox[{"profits", "[", 
     RowBox[{"2", ",", "x_", ",", "y_"}], "]"}], "\[Rule]", " ", 
    RowBox[{"profits", "[", 
     RowBox[{"y", ",", "x", ",", "nplayers", ",", "B", ",", "w"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8295289268503838`*^9, 3.829528948215248*^9}, {
  3.829529048742524*^9, 3.829529059156582*^9}, {3.829581980714033*^9, 
  3.829581984077462*^9}, {3.8295835705268593`*^9, 3.8295835706859417`*^9}, {
  3.8324243314407597`*^9, 3.8324243615577035`*^9}, {3.8324248979885945`*^9, 
  3.8324250543239756`*^9}, {3.8324251306760445`*^9, 3.83242513280369*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"ed117d57-8fb2-480e-bfc4-18a587b08a8f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"profits", "[", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"], ",", "nplayers", ",", "B", ",", "w"}], "]"}]}],
     "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"u", "[", "1", "]"}], "2"], "2"], "+", 
    RowBox[{"rho", " ", 
     RowBox[{"V", "[", "1", "]"}]}], "-", 
    RowBox[{"delta", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"V", "[", "1", "]"}], "-", 
       RowBox[{"V", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["m", "1"]}], ",", 
         SubscriptBox["m", "2"]}], "]"}]}], ")"}]}], "-", 
    RowBox[{"delta", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"V", "[", "1", "]"}], "-", 
       RowBox[{"V", "[", 
        RowBox[{
         SubscriptBox["m", "1"], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}], "-", 
    RowBox[{"alpha", " ", 
     RowBox[{"u", "[", "2", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"V", "[", "1", "]"}], "-", 
       RowBox[{"V", "[", 
        RowBox[{
         SubscriptBox["m", "1"], ",", 
         RowBox[{"1", "+", 
          SubscriptBox["m", "2"]}]}], "]"}]}], ")"}]}], "-", 
    RowBox[{"alpha", " ", 
     RowBox[{"u", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"V", "[", "1", "]"}], "-", 
       RowBox[{"V", "[", 
        RowBox[{
         RowBox[{"1", "+", 
          SubscriptBox["m", "1"]}], ",", 
         SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"u", "[", "1", "]"}], "-", 
    RowBox[{"alpha", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"V", "[", "1", "]"}], "-", 
       RowBox[{"V", "[", 
        RowBox[{
         RowBox[{"1", "+", 
          SubscriptBox["m", "1"]}], ",", 
         SubscriptBox["m", "2"]}], "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"profits", "[", 
      RowBox[{
       SubscriptBox["m", "2"], ",", 
       SubscriptBox["m", "1"], ",", "nplayers", ",", "B", ",", "w"}], "]"}]}],
     "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"u", "[", "2", "]"}], "2"], "2"], "+", 
    RowBox[{"rho", " ", 
     RowBox[{"V", "[", "2", "]"}]}], "-", 
    RowBox[{"delta", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"V", "[", "2", "]"}], "-", 
       RowBox[{"V", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["m", "2"]}], ",", 
         SubscriptBox["m", "1"]}], "]"}]}], ")"}]}], "-", 
    RowBox[{"delta", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"V", "[", "2", "]"}], "-", 
       RowBox[{"V", "[", 
        RowBox[{
         SubscriptBox["m", "2"], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["m", "1"]}]}], "]"}]}], ")"}]}], "-", 
    RowBox[{"alpha", " ", 
     RowBox[{"u", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"V", "[", "2", "]"}], "-", 
       RowBox[{"V", "[", 
        RowBox[{
         SubscriptBox["m", "2"], ",", 
         RowBox[{"1", "+", 
          SubscriptBox["m", "1"]}]}], "]"}]}], ")"}]}], "-", 
    RowBox[{"alpha", " ", 
     RowBox[{"u", "[", "2", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"V", "[", "2", "]"}], "-", 
       RowBox[{"V", "[", 
        RowBox[{
         RowBox[{"1", "+", 
          SubscriptBox["m", "2"]}], ",", 
         SubscriptBox["m", "1"]}], "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"u", "[", "2", "]"}], "-", 
    RowBox[{"alpha", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"V", "[", "2", "]"}], "-", 
       RowBox[{"V", "[", 
        RowBox[{
         RowBox[{"1", "+", 
          SubscriptBox["m", "2"]}], ",", 
         SubscriptBox["m", "1"]}], "]"}]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.831409898470655*^9, 3.8324243780255537`*^9, 3.832424846204919*^9, {
   3.832425163023689*^9, 3.8324252136045475`*^9}, 3.8324252690975313`*^9, 
   3.833036181856074*^9},
 CellLabel->
  "Out[216]=",ExpressionUUID->"930ba6f2-f44a-459a-b550-55c19f84cfc3"]
}, Open  ]],

Cell["We now create Fortran formulas", "Text",
 CellChangeTimes->{{3.829579295131515*^9, 
  3.829579306948594*^9}},ExpressionUUID->"68d86884-364f-41f8-8d43-\
7b8a436eefb1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{"#", ",", "FortranForm"}], "]"}], "&"}], "/@", "%"}]], "Input",
 CellChangeTimes->{{3.829528970503544*^9, 3.829528977070846*^9}, 
   3.8295792158553743`*^9, {3.8324244495473385`*^9, 3.832424467889331*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"241518b2-e3bf-4904-b3de-a1cdd3f84301"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"-profits(Subscript(m,1),Subscript(m,2),nplayers,B,w) + \
u(1)**2/2. + rho*V(1) - delta*(V(1) - V(-1 + Subscript(m,1),Subscript(m,2))) \
- delta*(V(1) - V(Subscript(m,1),-1 + Subscript(m,2))) - alpha*u(2)*(V(1) - \
V(Subscript(m,1),1 + Subscript(m,2))) - alpha*u(1)*(V(1) - V(1 + \
Subscript(m,1),Subscript(m,2)))\"\>", 
   ",", "\<\"u(1) - alpha*(V(1) - V(1 + Subscript(m,1),Subscript(m,2)))\"\>", 
   ",", "\<\"-profits(Subscript(m,2),Subscript(m,1),nplayers,B,w) + \
u(2)**2/2. + rho*V(2) - delta*(V(2) - V(-1 + Subscript(m,2),Subscript(m,1))) \
- delta*(V(2) - V(Subscript(m,2),-1 + Subscript(m,1))) - alpha*u(1)*(V(2) - \
V(Subscript(m,2),1 + Subscript(m,1))) - alpha*u(2)*(V(2) - V(1 + \
Subscript(m,2),Subscript(m,1)))\"\>", 
   ",", "\<\"u(2) - alpha*(V(2) - V(1 + \
Subscript(m,2),Subscript(m,1)))\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8302624705364923`*^9, 3.830872704670096*^9, 3.831388310815938*^9, 
   3.831403535432852*^9, 3.831409913630148*^9, 3.832424378158533*^9, 
   3.8324248465415883`*^9, {3.8324251632842064`*^9, 3.8324252137034817`*^9}, 
   3.8324252692099133`*^9, 3.833036181968003*^9},
 CellLabel->
  "Out[217]=",ExpressionUUID->"61850b5b-0a86-4836-bf48-4aeab63b0580"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.8295289826233892`*^9, 3.829528984679821*^9}, {
  3.8324251179495583`*^9, 3.8324251188040915`*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"af33c271-9997-41a9-9797-58c73250135f"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"\<\"-profits(Subscript(m,1),Subscript(m,2),nplayers,B,w) + u(1)**2/2. \
+ rho*V(1) - delta*(V(1) - V(-1 + Subscript(m,1),Subscript(m,2))) - \
delta*(V(1) - V(Subscript(m,1),-1 + Subscript(m,2))) - alpha*u(2)*(V(1) - \
V(Subscript(m,1),1 + Subscript(m,2))) - alpha*u(1)*(V(1) - V(1 + \
Subscript(m,1),Subscript(m,2)))\"\>"},
     {"\<\"u(1) - alpha*(V(1) - V(1 + Subscript(m,1),Subscript(m,2)))\"\>"},
     {"\<\"-profits(Subscript(m,2),Subscript(m,1),nplayers,B,w) + u(2)**2/2. \
+ rho*V(2) - delta*(V(2) - V(-1 + Subscript(m,2),Subscript(m,1))) - \
delta*(V(2) - V(Subscript(m,2),-1 + Subscript(m,1))) - alpha*u(1)*(V(2) - \
V(Subscript(m,2),1 + Subscript(m,1))) - alpha*u(2)*(V(2) - V(1 + \
Subscript(m,2),Subscript(m,1)))\"\>"},
     {"\<\"u(2) - alpha*(V(2) - V(1 + Subscript(m,2),Subscript(m,1)))\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.830262470549676*^9, 3.830872704681198*^9, 3.831388310825925*^9, 
   3.831403535529025*^9, 3.831409915898617*^9, 3.832424378298915*^9, 
   3.8324248469557095`*^9, {3.8324251634812927`*^9, 3.832425213771578*^9}, 
   3.8324252694464808`*^9, 3.8330361820769467`*^9},
 CellLabel->
  "Out[218]//TableForm=",ExpressionUUID->"a4ad48d8-f7c1-4d80-a21d-\
a714874d6839"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StringReplace", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<Subscript(m,\>\"", "~~", "n_", "~~", "\"\<)\>\""}], 
         "\[Rule]", " ", 
         RowBox[{"\"\<DS(\>\"", "~~", "n", "~~", "\"\<)\>\""}]}], ",", " ", 
        RowBox[{
         RowBox[{"\"\<Part(M\>\"", "~~", "n_", "~~", "\"\<)\>\""}], "\[Rule]",
          " ", 
         RowBox[{"\"\<DS(\>\"", "~~", "n", "~~", "\"\<)\>\""}]}], ",", " ", 
        RowBox[{"\"\<Total(M)\>\"", "\[Rule]", " ", "\"\<DS(1) + DS(2)\>\""}],
         ",", " ", 
        RowBox[{"\"\<.5\>\"", "\[Rule]", " ", "\"\<.5d0\>\""}]}], "}"}]}], 
     "]"}], "&"}], "/@", " ", "%"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StringReplace", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<-1 + DS(\>\"", "~~", "n_", "~~", "\"\<)\>\""}], " ", 
        "\[Rule]", " ", 
        RowBox[{"\"\<DS(\>\"", "~~", "n", "~~", "\"\<) - 1\>\""}]}], "}"}]}], 
     "]"}], "&"}], "/@", " ", "%"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StringReplace", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<1 + DS(\>\"", "~~", "n_", "~~", "\"\<)\>\""}], " ", 
        "\[Rule]", " ", 
        RowBox[{"\"\<DS(\>\"", "~~", "n", "~~", "\"\<) + 1\>\""}]}], "}"}]}], 
     "]"}], "&"}], "/@", " ", "%"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StringReplace", "[", 
    RowBox[{"#", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<,DS\>\"", " ", "\[Rule]", " ", "\"\<, DS\>\""}], "}"}]}], 
    "]"}], "&"}], "/@", " ", "%"}]}], "Input",
 CellChangeTimes->{{3.832424483462488*^9, 3.8324246790339594`*^9}, {
   3.8324247146244397`*^9, 3.832424831538026*^9}, 3.8324251437190475`*^9, 
   3.8324251954357653`*^9, {3.8324252310792837`*^9, 3.8324252630107293`*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"42bb085e-1832-4e2d-9c9c-4c89683bcc4a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"-profits(DS(1), DS(2),nplayers,B,w) + u(1)**2/2. + rho*V(1) - \
delta*(V(1) - V(DS(1) - 1, DS(2))) - delta*(V(1) - V(DS(1), DS(2) - 1)) - \
alpha*u(2)*(V(1) - V(DS(1), DS(2) + 1)) - alpha*u(1)*(V(1) - V(DS(1) + 1, \
DS(2)))\"\>", ",", "\<\"u(1) - alpha*(V(1) - V(DS(1) + 1, DS(2)))\"\>", 
   ",", "\<\"-profits(DS(2), DS(1),nplayers,B,w) + u(2)**2/2. + rho*V(2) - \
delta*(V(2) - V(DS(2) - 1, DS(1))) - delta*(V(2) - V(DS(2), DS(1) - 1)) - \
alpha*u(1)*(V(2) - V(DS(2), DS(1) + 1)) - alpha*u(2)*(V(2) - V(DS(2) + 1, \
DS(1)))\"\>", ",", "\<\"u(2) - alpha*(V(2) - V(DS(2) + 1, DS(1)))\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8324252695335665`*^9, 3.8330361821671934`*^9},
 CellLabel->
  "Out[222]=",ExpressionUUID->"e90d30d5-7d2a-4c0d-949e-940ec56e35df"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1435, 1021},
WindowMargins->{{6, Automatic}, {Automatic, 2}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 438, 7, 96, "Title",ExpressionUUID->"248cfd5b-c83c-4c3c-93eb-33aa743e83ea"],
Cell[CellGroupData[{
Cell[1043, 33, 314, 8, 28, "Input",ExpressionUUID->"1a233bd4-a822-45ff-b9f9-fad9430d8caa"],
Cell[1360, 43, 645, 14, 32, "Output",ExpressionUUID->"802d10e3-7abd-455c-80c2-38e849c77c0f"]
}, Open  ]],
Cell[2020, 60, 373, 7, 28, "Input",ExpressionUUID->"907b9b4d-a2f6-463b-a687-2fc606431ccb"],
Cell[CellGroupData[{
Cell[2418, 71, 215, 4, 67, "Section",ExpressionUUID->"864090de-8af3-40e5-8657-4cf1811662e3"],
Cell[CellGroupData[{
Cell[2658, 79, 110, 0, 53, "Subsection",ExpressionUUID->"5fbe112a-95a8-4839-bc72-dd5a70c12b50"],
Cell[2771, 81, 312, 5, 56, "Text",ExpressionUUID->"f031a4e1-a4e3-4165-9b57-0ed9c5974a27"],
Cell[3086, 88, 367, 10, 28, "Input",ExpressionUUID->"ec436de9-ce2e-4f3d-a988-2d215346391b"],
Cell[3456, 100, 320, 5, 56, "Text",ExpressionUUID->"2141b4e2-e49c-463d-97f1-455104b89fc4"],
Cell[CellGroupData[{
Cell[3801, 109, 616, 13, 28, "Input",ExpressionUUID->"20633d23-4c26-4593-a8eb-2a7263f34d2a"],
Cell[4420, 124, 1308, 22, 32, "Output",ExpressionUUID->"c043bd0b-badf-41f7-a5e6-cc11feb645a6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5765, 151, 743, 17, 28, "Input",ExpressionUUID->"338094e6-214d-44ab-b9f8-872f9b36121e"],
Cell[6511, 170, 1544, 30, 32, "Output",ExpressionUUID->"60feecc0-daa6-4bdf-a192-fb738fa6bf9c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8104, 206, 191, 3, 53, "Subsection",ExpressionUUID->"96c0a328-5f2e-4c40-912d-71aa6db9ef82"],
Cell[CellGroupData[{
Cell[8320, 213, 327, 8, 28, "Input",ExpressionUUID->"fa184de2-7f48-4394-941a-5ec5d0970982"],
Cell[8650, 223, 990, 17, 50, "Output",ExpressionUUID->"c8c8549a-c70e-4573-8333-81f5e68d4bce"]
}, Open  ]],
Cell[9655, 243, 278, 4, 34, "Text",ExpressionUUID->"0d810553-23a5-4cb5-a3e6-ea7a542803cf"],
Cell[9936, 249, 265, 6, 28, "Input",ExpressionUUID->"2f095d09-e55a-4f72-a37b-191449363c1c"],
Cell[10204, 257, 270, 4, 34, "Text",ExpressionUUID->"358fe608-2b11-4448-9dd1-b40e64535b84"],
Cell[10477, 263, 264, 6, 28, "Input",ExpressionUUID->"ae8849a2-750e-4fdb-90f6-8fd251222229"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10778, 274, 182, 3, 53, "Subsection",ExpressionUUID->"63910343-f8b0-46c4-9085-ecb1ed0b05b5"],
Cell[10963, 279, 449, 10, 31, "Input",ExpressionUUID->"599a4bb0-bd51-4631-9c39-ba621fefc2f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11449, 294, 162, 3, 53, "Subsection",ExpressionUUID->"28eca8c2-df3f-4e9c-8baf-dca634dc895f"],
Cell[11614, 299, 263, 6, 34, "Text",ExpressionUUID->"f441a74a-3b07-4fa9-8409-ce4ed947805d"],
Cell[CellGroupData[{
Cell[11902, 309, 547, 12, 28, "Input",ExpressionUUID->"a8fd3842-4412-4e94-9df6-53bb1cba3cb2"],
Cell[12452, 323, 1419, 25, 32, "Output",ExpressionUUID->"3c3bda30-5c71-4b46-ac2d-e3e51e61fdb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13908, 353, 543, 11, 28, "Input",ExpressionUUID->"d3d2a842-eb3f-4a03-a20d-a553902923d1"],
Cell[14454, 366, 1409, 25, 32, "Output",ExpressionUUID->"4e963b73-00a7-4ddf-8fa4-3ea92d082067"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15900, 396, 340, 9, 28, "Input",ExpressionUUID->"ce34e586-bfa4-4711-b80c-950fe29883a0"],
Cell[16243, 407, 1436, 34, 32, "Output",ExpressionUUID->"68cf3022-4d47-462f-af20-aca1fcf182c3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17716, 446, 524, 14, 28, "Input",ExpressionUUID->"3d0aa800-2e5d-4b47-a8e1-edb09d20e2e5"],
Cell[18243, 462, 1833, 46, 53, "Output",ExpressionUUID->"81160058-534a-494b-89ae-eb587e85c1de"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20113, 513, 692, 16, 28, "Input",ExpressionUUID->"d4d0c9e7-3b66-487c-a0d5-4a14e52b6999"],
Cell[20808, 531, 1067, 25, 56, "Output",ExpressionUUID->"c316d269-c2b0-48a1-8540-2143583c1851"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21912, 561, 690, 16, 28, "Input",ExpressionUUID->"eee3623b-2ced-4bba-a8ca-45ace683673e"],
Cell[22605, 579, 1090, 26, 56, "Output",ExpressionUUID->"6e6d9946-7f3f-4342-ad1c-1ebc9be44665"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23732, 610, 690, 16, 28, "Input",ExpressionUUID->"d72b47c4-ee9e-4747-a065-4e2212752659"],
Cell[24425, 628, 1162, 27, 56, "Output",ExpressionUUID->"a3fdb60c-3faa-4f2a-95c7-9dc865fd0a2f"]
}, Open  ]],
Cell[25602, 658, 242, 6, 34, "Text",ExpressionUUID->"07894cc7-3580-48ec-90bb-b0219ec585d7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25893, 670, 93, 0, 67, "Section",ExpressionUUID->"fbe33327-0950-42b0-9e34-f84ac03a727e"],
Cell[25989, 672, 1009, 23, 298, "Text",ExpressionUUID->"8339056e-f6bd-488b-b2bb-e7e21a4e8836"],
Cell[27001, 697, 315, 7, 34, "Text",ExpressionUUID->"9816cc8e-cd91-4174-9e1d-19a5155c13e5"],
Cell[27319, 706, 245, 6, 34, "Text",ExpressionUUID->"9935471d-3f3a-4f13-bad2-6270dde9638d"],
Cell[CellGroupData[{
Cell[27589, 716, 104, 0, 44, "Subsubsection",ExpressionUUID->"24f626f8-a5dd-4560-89f1-a73c24b50e25"],
Cell[27696, 718, 198, 3, 34, "Text",ExpressionUUID->"74e19e32-61f1-45ef-abd5-2192bee6fec5"],
Cell[27897, 723, 1252, 22, 28, "Input",ExpressionUUID->"ab0ff058-f6da-4ab1-ad4f-ba367af6aff8"],
Cell[29152, 747, 216, 5, 34, "Text",ExpressionUUID->"d6fb05cc-db93-47de-81d0-21d715a4c02e"],
Cell[29371, 754, 1310, 23, 28, "Input",ExpressionUUID->"b7800e85-08f0-4fe3-b498-3c58a2b0485e"],
Cell[30684, 779, 99, 1, 4, "PageBreak",ExpressionUUID->"ac2431b6-5578-4254-8aed-b417df10b28b",
 PageBreakBelow->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30832, 786, 193, 3, 67, "Section",ExpressionUUID->"25edb417-18d9-478f-8f11-c980892e290e"],
Cell[CellGroupData[{
Cell[31050, 793, 141, 3, 53, "Subsection",ExpressionUUID->"046d36f8-1dd7-42d7-9754-cec87b923393"],
Cell[31194, 798, 247, 6, 34, "Text",ExpressionUUID->"e0b39e9a-4911-4be7-b5fd-f0b5653e5f36"],
Cell[CellGroupData[{
Cell[31466, 808, 570, 13, 28, "Input",ExpressionUUID->"06e7ed5d-0bfc-4638-92d2-8f2461335254"],
Cell[32039, 823, 1308, 22, 32, "Output",ExpressionUUID->"a8b2b38f-007e-453c-8781-a8ecdd1c8491"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33384, 850, 394, 10, 28, "Input",ExpressionUUID->"4f691689-fe9b-474c-8e80-5461ea352934"],
Cell[33781, 862, 1142, 20, 32, "Output",ExpressionUUID->"35218b47-220b-43a4-a892-7ea66b5941a7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34960, 887, 393, 9, 28, "Input",ExpressionUUID->"dbddaf4f-27a0-4b4a-8c9e-4fbe329fc501"],
Cell[35356, 898, 1393, 25, 32, "Output",ExpressionUUID->"27c60083-5da9-4100-b666-3c5314fb3bd3"]
}, Open  ]],
Cell[36764, 926, 535, 14, 28, "Input",ExpressionUUID->"e57f6f36-9519-438b-bc87-98c89d910e50"],
Cell[CellGroupData[{
Cell[37324, 944, 492, 12, 28, "Input",ExpressionUUID->"fe6d9b11-2fef-4bed-a0f5-088623c052c3"],
Cell[37819, 958, 1210, 31, 62, "Output",ExpressionUUID->"3cc69cbd-ecb2-4369-a8e8-225f145d5eed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39066, 994, 2063, 43, 124, "Input",ExpressionUUID->"27610672-7363-4767-8154-fc538d46e0b7"],
Cell[41132, 1039, 2191, 72, 32, "Output",ExpressionUUID->"ba20322f-ec1c-45b2-919c-d6c985e0419b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43360, 1116, 211, 4, 28, "Input",ExpressionUUID->"0993a692-b8ab-4c2a-be35-2f898157c8ca"],
Cell[43574, 1122, 1949, 66, 32, "Output",ExpressionUUID->"7de48ba0-d784-4fe2-bc65-560be1a16828"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45560, 1193, 183, 3, 28, "Input",ExpressionUUID->"1c9c0d75-b0ac-4ec6-8402-282a4b67394e"],
Cell[45746, 1198, 390, 9, 32, "Output",ExpressionUUID->"86615dec-d51f-4f28-a458-0a63745bc122"]
}, Open  ]],
Cell[46151, 1210, 320, 7, 34, "Text",ExpressionUUID->"fea39745-13ca-478e-97e3-056e2727d93d"],
Cell[CellGroupData[{
Cell[46496, 1221, 721, 16, 28, "Input",ExpressionUUID->"6d6d7991-0839-4c94-8a2d-cf624c5558e6"],
Cell[47220, 1239, 3078, 89, 52, "Output",ExpressionUUID->"2d66a5ac-73de-4d6b-bdcf-05881bb458dd"]
}, Open  ]],
Cell[50313, 1331, 188, 3, 34, "Text",ExpressionUUID->"cca5a03d-001f-4f1f-9a19-fde118cc1173"],
Cell[50504, 1336, 223, 5, 28, "Input",ExpressionUUID->"71d3eacf-cccc-4713-847a-0c01272a8148"],
Cell[CellGroupData[{
Cell[50752, 1345, 553, 13, 28, "Input",ExpressionUUID->"5d37493d-58a6-492c-9e54-49dcfa4da777"],
Cell[51308, 1360, 3526, 103, 52, "Output",ExpressionUUID->"0abf2ed3-f0a2-4ab0-ab32-af7c83a38b16"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54883, 1469, 165, 3, 53, "Subsection",ExpressionUUID->"87d6d4ec-bcd1-4943-901b-23d544c63985"],
Cell[55051, 1474, 153, 2, 34, "Text",ExpressionUUID->"4ef173a0-4fc2-420e-8afb-aefd68c903fc"],
Cell[CellGroupData[{
Cell[55229, 1480, 794, 18, 28, "Input",ExpressionUUID->"3bca497c-1982-48a5-9305-810acade7155"],
Cell[56026, 1500, 4370, 139, 59, "Output",ExpressionUUID->"599b3ee4-d383-45b6-b43c-beba0caf2c95"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60445, 1645, 156, 3, 53, "Subsection",ExpressionUUID->"4c21e9d0-384c-45c4-a50c-3dc938dad942"],
Cell[60604, 1650, 252, 4, 34, "Text",ExpressionUUID->"2c4fb6b4-257b-48c3-a9d6-3a156202c810"],
Cell[CellGroupData[{
Cell[60881, 1658, 758, 19, 48, "Input",ExpressionUUID->"d69e65dc-9795-439b-9782-060c04a9ab26"],
Cell[61642, 1679, 12090, 347, 100, "Output",ExpressionUUID->"46e269df-1340-4779-a5aa-bee24132e8f9"]
}, Open  ]],
Cell[73747, 2029, 883, 20, 28, "Input",ExpressionUUID->"9afba6df-dec7-414e-aeb4-fcbee59a4bf6"],
Cell[CellGroupData[{
Cell[74655, 2053, 179, 3, 28, "Input",ExpressionUUID->"e4df3f8f-58c0-4337-8529-68ed427810f6"],
Cell[74837, 2058, 12302, 403, 136, "Output",ExpressionUUID->"5c28cdc5-c7ab-4c38-8201-f48ef9e9752a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87176, 2466, 717, 15, 28, "Input",ExpressionUUID->"22757d9a-68b6-494d-b2a3-ec08a2f5ab46"],
Cell[87896, 2483, 705, 14, 23, "Message",ExpressionUUID->"1bd83782-f8bc-42a4-8546-ce2dda54aa23"],
Cell[88604, 2499, 13874, 420, 100, "Output",ExpressionUUID->"6f663c6c-05be-4e4a-823f-9234a7f0ee0d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[102539, 2926, 197, 3, 67, "Section",ExpressionUUID->"b54ba43a-bf57-4769-ab35-c197e411a0e3"],
Cell[CellGroupData[{
Cell[102761, 2933, 184, 3, 53, "Subsection",ExpressionUUID->"e74d9454-5d66-4369-a418-9781f58a3abf"],
Cell[102948, 2938, 164, 3, 34, "Text",ExpressionUUID->"f6d0b360-52db-4fa1-a26f-fc19b504e60f"],
Cell[103115, 2943, 601, 14, 32, "Input",ExpressionUUID->"5708e066-5d76-4876-8de7-66458165c74f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103753, 2962, 228, 4, 53, "Subsection",ExpressionUUID->"d370d45b-5bfb-47b7-b06c-933a8b170689"],
Cell[103984, 2968, 118, 0, 34, "Text",ExpressionUUID->"79908cab-78b4-4e03-a967-9dcc8a0c3135"],
Cell[104105, 2970, 483, 12, 31, "Input",ExpressionUUID->"91d67e31-e41b-46c5-99dc-595a81bf9cc2"],
Cell[104591, 2984, 99, 1, 1, "PageBreak",ExpressionUUID->"24792cf8-1e79-4526-8634-6a9ef7e1c83c",
 PageBreakBelow->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104739, 2991, 204, 4, 67, "Section",ExpressionUUID->"b239cd50-70db-4fba-87aa-4fc3d325e207"],
Cell[CellGroupData[{
Cell[104968, 2999, 181, 3, 28, "Input",ExpressionUUID->"b4bfc1eb-11e8-4adc-a69c-c8662eb61a1d"],
Cell[105152, 3004, 7221, 234, 144, "Output",ExpressionUUID->"0f1bdd42-ce1e-4a85-a306-72bc5b9e0b4b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112410, 3243, 922, 24, 67, "Input",ExpressionUUID->"3c5c2dea-278f-4a95-b743-7732ce2fc71e"],
Cell[113335, 3269, 853, 13, 32, "Output",ExpressionUUID->"e425616b-9f1c-4375-838a-afeb9aaf6225"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114225, 3287, 236, 5, 28, "Input",ExpressionUUID->"287a2f87-1274-49af-856b-85cbc0582b14"],
Cell[114464, 3294, 806, 13, 32, "Output",ExpressionUUID->"273a22a0-20bd-4a4a-ae6a-5b3f6274f65c"]
}, Open  ]],
Cell[115285, 3310, 286, 7, 34, "Text",ExpressionUUID->"9ed5a693-38b9-4662-ac4a-7c4c1ed22707"],
Cell[115574, 3319, 760, 16, 31, "Input",ExpressionUUID->"8fd5748f-ea94-453f-b597-0139f750ce4d"],
Cell[116337, 3337, 289, 7, 34, "Text",ExpressionUUID->"9abf67c7-f724-4ac5-8b33-5b647854ae39"],
Cell[116629, 3346, 658, 15, 31, "Input",ExpressionUUID->"f3e8badc-e6ed-4ef1-a8f9-2235628f7677"],
Cell[117290, 3363, 253, 4, 34, "Text",ExpressionUUID->"25551b8e-a622-4eb7-9a04-c8cd5af64ca9"],
Cell[117546, 3369, 618, 17, 28, "Input",ExpressionUUID->"d33c6a34-a737-4f7d-b532-eabb3814aa7a"],
Cell[118167, 3388, 180, 3, 34, "Text",ExpressionUUID->"351e2b6b-cd44-4a7e-b08c-ac5785b14ae1"],
Cell[CellGroupData[{
Cell[118372, 3395, 379, 9, 28, "Input",ExpressionUUID->"e4fbdde7-dce0-461a-b049-bec9e03813f0"],
Cell[118754, 3406, 18341, 486, 204, "Output",ExpressionUUID->"3d7511c2-da96-4e06-92a1-f48f3e09b3c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137132, 3897, 1042, 24, 67, "Input",ExpressionUUID->"65347063-cf31-4e76-bc2d-1b5e465561b4"],
Cell[138177, 3923, 491, 8, 32, "Output",ExpressionUUID->"7927f519-6dbe-4bf6-9a35-5c61027e17c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138705, 3936, 341, 8, 28, "Input",ExpressionUUID->"51ecf948-54fe-4701-975f-779f98a38720"],
Cell[139049, 3946, 5981, 181, 157, "Output",ExpressionUUID->"1ed115c3-8557-4081-9b54-c28d4d4ec8a8"]
}, Open  ]],
Cell[145045, 4130, 368, 8, 34, "Text",ExpressionUUID->"2d9bbca8-b0cd-40b2-bfdc-89a27dd2c803"],
Cell[CellGroupData[{
Cell[145438, 4142, 775, 18, 28, "Input",ExpressionUUID->"f05d4e05-b6a9-4423-9743-0cc48842060a"],
Cell[146216, 4162, 655, 16, 32, "Output",ExpressionUUID->"cf17a5c8-6bc7-4254-956f-b4522155c7f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146908, 4183, 1072, 23, 32, "Input",ExpressionUUID->"6f4fa9b3-ff69-4f9e-b7c5-c8b8c496b996"],
Cell[147983, 4208, 1175, 23, 32, "Output",ExpressionUUID->"6522e2dc-876a-4725-84a5-8cc454da1878"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149195, 4236, 96, 0, 53, "Subsection",ExpressionUUID->"ef9a1ad2-05c5-4009-912f-fcb0f8d55e37"],
Cell[149294, 4238, 1032, 25, 184, "Text",ExpressionUUID->"74d2624e-3202-4c4f-9e9d-ea66ba81c420"],
Cell[150329, 4265, 494, 14, 35, "Text",ExpressionUUID->"0cc84d3d-184f-4817-832a-ecd98b74ea6f"],
Cell[150826, 4281, 323, 7, 34, "Text",ExpressionUUID->"55c96336-711b-4d8c-b91d-134c6a256fae"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[151198, 4294, 274, 5, 67, "Section",ExpressionUUID->"1a0b0052-504a-487d-8d97-88e1cb042aaa"],
Cell[151475, 4301, 398, 9, 28, "Input",ExpressionUUID->"9035728e-205d-41fe-82c2-c12cbc9584f8"],
Cell[CellGroupData[{
Cell[151898, 4314, 265, 5, 28, "Input",ExpressionUUID->"317937a6-304f-4077-9759-df025b542aea"],
Cell[152166, 4321, 5316, 155, 114, "Output",ExpressionUUID->"d823a6cc-9a40-4cb3-b3b7-24c55f84c5a4"]
}, Open  ]],
Cell[157497, 4479, 223, 5, 28, "Input",ExpressionUUID->"aeb1cbed-194b-4f30-a1b5-97cc96837bfe"],
Cell[157723, 4486, 306, 7, 34, "Text",ExpressionUUID->"2c262419-9877-42ef-bb04-bed3a5f4094f"],
Cell[158032, 4495, 99, 1, 1, "PageBreak",ExpressionUUID->"c10a3158-ee24-4abc-a784-f32b18fde8ce",
 PageBreakBelow->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[158168, 4501, 104, 0, 67, "Section",ExpressionUUID->"f57f9a21-228b-466a-b346-ac699ebb99b3"],
Cell[158275, 4503, 381, 8, 34, "Text",ExpressionUUID->"6f0794da-8f17-4fa6-a0e7-fa26a64f4de5"],
Cell[158659, 4513, 714, 15, 28, "Input",ExpressionUUID->"930e0e60-2b05-45ed-ab81-32efd9881d43"],
Cell[CellGroupData[{
Cell[159398, 4532, 261, 5, 28, "Input",ExpressionUUID->"690d4c72-f4c2-484b-ba5c-043243fa56d6"],
Cell[159662, 4539, 7473, 219, 114, "Output",ExpressionUUID->"fdf8182e-d94d-449d-b6e8-6357e501938e"]
}, Open  ]],
Cell[167150, 4761, 99, 1, 1, "PageBreak",ExpressionUUID->"687da371-0037-42ac-a3e8-2c5380ae468c",
 PageBreakBelow->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[167286, 4767, 157, 3, 67, "Section",ExpressionUUID->"538f6b79-aad8-4799-a935-a27f329755bb"],
Cell[167446, 4772, 295, 6, 34, "Text",ExpressionUUID->"46c3cd9e-e45a-4722-a98c-5077873ee910"],
Cell[CellGroupData[{
Cell[167766, 4782, 2310, 60, 48, "Input",ExpressionUUID->"ed117d57-8fb2-480e-bfc4-18a587b08a8f"],
Cell[170079, 4844, 4193, 134, 122, "Output",ExpressionUUID->"930ba6f2-f44a-459a-b550-55c19f84cfc3"]
}, Open  ]],
Cell[174287, 4981, 172, 3, 34, "Text",ExpressionUUID->"68d86884-364f-41f8-8d43-7b8a436eefb1"],
Cell[CellGroupData[{
Cell[174484, 4988, 364, 8, 28, "Input",ExpressionUUID->"241518b2-e3bf-4904-b3de-a1cdd3f84301"],
Cell[174851, 4998, 1247, 21, 109, "Output",ExpressionUUID->"61850b5b-0a86-4836-bf48-4aeab63b0580"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176135, 5024, 262, 5, 28, "Input",ExpressionUUID->"af33c271-9997-41a9-9797-58c73250135f"],
Cell[176400, 5031, 1630, 34, 96, "Output",ExpressionUUID->"a4ad48d8-f7c1-4d80-a21d-a714874d6839"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178067, 5070, 2028, 53, 86, "Input",ExpressionUUID->"42bb085e-1832-4e2d-9c9c-4c89683bcc4a"],
Cell[180098, 5125, 807, 13, 90, "Output",ExpressionUUID->"e90d30d5-7d2a-4c0d-949e-940ec56e35df"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

