(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    141686,       3751]
NotebookOptionsPosition[    129936,       3560]
NotebookOutlinePosition[    130279,       3575]
CellTagsIndexPosition[    130236,       3572]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["DAGMAN Dynamic Nash - Oil Game", "Title",
 CellChangeTimes->{{3.388063044670274*^9, 3.388063052070915*^9}, {
   3.3881679974725647`*^9, 3.3881680030005136`*^9}, {3.3883327791713696`*^9, 
   3.3883327946636467`*^9}, {3.3883398332815294`*^9, 3.388339833702134*^9}, {
   3.388774587625*^9, 3.388774588203125*^9}, 3.389194383015625*^9, {
   3.829583697411647*^9, 3.829583708034905*^9}, {3.839529274691584*^9, 
   3.839529279778965*^9}},ExpressionUUID->"248cfd5b-c83c-4c3c-93eb-\
33aa743e83ea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "=", "0"}], ";", " ", 
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], ";", " ", 
  RowBox[{
   RowBox[{"DateList", "[", 
    RowBox[{"Date", "[", "]"}], "]"}], "//", "Most"}]}]], "Input",
 CellLabel->
  "In[994]:=",ExpressionUUID->"1a233bd4-a822-45ff-b9f9-fad9430d8caa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2021", ",", "9", ",", "30", ",", "23", ",", "40"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.830262394285521*^9, 3.830262465831278*^9, 3.830262578146288*^9, 
   3.830262646067711*^9, 3.830268306859469*^9, 3.8302757041119623`*^9, 
   3.830297088702444*^9, 3.8302974730712423`*^9, 3.830303626743931*^9, 
   3.830303714790287*^9, 3.8303049342689466`*^9, 3.830348113430385*^9, 
   3.8303484983107233`*^9, 3.830355209045562*^9, 3.830355769171864*^9, 
   3.830355917855329*^9, 3.83035625624669*^9, 3.830380987340784*^9, 
   3.8303825959094276`*^9, 3.830386014613535*^9, 3.8308726779994087`*^9, 
   3.831388190705267*^9, 3.8313971269581013`*^9, 3.839466258048893*^9, 
   3.839521566514085*^9, 3.839530418188034*^9, 3.839531356502276*^9, 
   3.839532995901626*^9, 3.839533697724765*^9, 3.839537258945709*^9, 
   3.839538198899996*^9, 3.839571055625165*^9, 3.839571708062724*^9, 
   3.839595099701561*^9, 3.842050304574012*^9, 3.8420504151521473`*^9, 
   3.8420505122797565`*^9, {3.842050574629814*^9, 3.842050602585744*^9}, 
   3.8420506841878824`*^9, 3.8420507205074234`*^9, 3.8420507909680614`*^9, {
   3.842050849382925*^9, 3.8420508736679683`*^9}, 3.8420509537457156`*^9, 
   3.8420510301916704`*^9, 3.8420512822168913`*^9, 3.8420525655047417`*^9, 
   3.8420526835317097`*^9, 3.8420543811240997`*^9, 3.842055511416688*^9, 
   3.8420556754882307`*^9, 3.842055855830648*^9, 3.8420581494280868`*^9, 
   3.842058483704173*^9, 3.8420592315969057`*^9},
 CellLabel->
  "Out[994]=",ExpressionUUID->"1365759a-a6da-4ae0-b6f6-ebc15f6730c3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numfirms", "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{{3.830348051054196*^9, 3.830348057188826*^9}, {
  3.8303810293299093`*^9, 3.830381035519782*^9}, {3.830381376700425*^9, 
  3.830381396108087*^9}, {3.8395216758064137`*^9, 3.8395216763494883`*^9}, {
  3.839538194562603*^9, 3.839538195339114*^9}},
 CellLabel->
  "In[995]:=",ExpressionUUID->"907b9b4d-a2f6-463b-a687-2fc606431ccb"],

Cell[CellGroupData[{

Cell["Oil Reserves", "Section",
 CellChangeTimes->{{3.839533046022354*^9, 3.839533049990218*^9}, {
  3.839533111387569*^9, 
  3.839533112082909*^9}},ExpressionUUID->"ef9a1ad2-05c5-4009-912f-\
fcb0f8d55e37"],

Cell[TextData[{
 "States: Firm j has oil reserves ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "j"], TraditionalForm]],ExpressionUUID->
  "9b08a715-c1bc-4745-b674-65dab07d4f65"],
 ". We discretize the state, allowing ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["R", "j"], "\[Element]", " ", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "1", ",", " ", "2", ",", " ", "...", ",", " ", "Rmax"}], 
     "}"}]}], TraditionalForm]],ExpressionUUID->
  "6be9aac3-be34-494a-80d6-045d4719b234"],
 ".\n\nR=0 is the absorbing state.  No output. No profits. No costs."
}], "Text",
 CellChangeTimes->{{3.8295824035390987`*^9, 3.829582404147316*^9}, {
  3.839533270034986*^9, 3.8395333807825336`*^9}, {3.839533430108425*^9, 
  3.839533432891624*^9}, {3.839536831158594*^9, 3.839536831550334*^9}, {
  3.8395369811167583`*^9, 3.839537058770865*^9}, {3.839537111753806*^9, 
  3.839537149201182*^9}, {3.8395944008979387`*^9, 
  3.839594432591653*^9}},ExpressionUUID->"74d2624e-3202-4c4f-9e9d-\
ea66ba81c420"],

Cell[TextData[{
 "Value function for firm j is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["V", "j"], "[", 
    RowBox[{
     SubscriptBox["R", "1"], ",", 
     SubscriptBox["R", "2"], ",", 
     SubscriptBox["R", "3"]}], "]"}], TraditionalForm]],ExpressionUUID->
  "8476b0f2-530f-447d-a08b-b869c509d52d"],
 ". R=0 being the absorbing state implies the boundary conditions\n\n",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox["V", "1"], "[", 
    RowBox[{"0", ",", 
     SubscriptBox["R", "2"], ",", 
     SubscriptBox["R", "3"]}], "]"}], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["V", "2"], "[", 
     RowBox[{
      SubscriptBox["R", "1"], ",", "0", ",", 
      SubscriptBox["R", "3"]}], "]"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["V", "3"], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", "0"}], "]"}], "=", "0"}]}]}]], "Text",
  CellChangeTimes->{{3.839594578140579*^9, 3.839594680982697*^9}},
  ExpressionUUID->"727e79c9-5cb7-41f8-8a25-b19dd5ed9645"],
 "\n\nThis means that the active state space is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["R", "j"], "\[Element]", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "2", ",", " ", "...", ",", " ", "Rmax"}], "}"}]}],
    TraditionalForm]],ExpressionUUID->"132cff28-ebed-4809-8c0c-c277d8c23a59"]
}], "Text",
 CellChangeTimes->{{3.8395944479911947`*^9, 3.839594550675749*^9}, {
  3.839594693235787*^9, 
  3.839594734493531*^9}},ExpressionUUID->"4acb2eb2-936d-459b-823d-\
3a5144993c49"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The general model", "Section",
 CellChangeTimes->{{3.829583758736846*^9, 
  3.829583762216453*^9}},ExpressionUUID->"864090de-8af3-40e5-8657-\
4cf1811662e3"],

Cell[CellGroupData[{

Cell["Cost and Inverse Demand functions", "Subsection",ExpressionUUID->"5fbe112a-95a8-4839-bc72-dd5a70c12b50"],

Cell["\<\
In general, the total cost to firm j with reserves R of producing q units is \
C[j, q, R], expressing the possibility that production costs will depend on \
reserves as well as the individual producer
In this version, we suppress the dependence on R EXCEPT for some the special \
case of R=0, where we will choose a production function . \
\>", "Text",
 CellChangeTimes->{{3.839529369594285*^9, 3.839529370802115*^9}, {
   3.8395334616266117`*^9, 3.839533523791782*^9}, {3.839536770654632*^9, 
   3.839536790237624*^9}, {3.83953686919627*^9, 3.839536929140336*^9}, {
   3.839570844807333*^9, 3.839570876078129*^9}, {3.839592917733734*^9, 
   3.839592930548112*^9}, {3.839592965876133*^9, 3.839592999267799*^9}, {
   3.839593065086711*^9, 3.839593069655744*^9}, 
   3.839593285895114*^9},ExpressionUUID->"f031a4e1-a4e3-4165-9b57-\
0ed9c5974a27"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cost", "[", "j_", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Kappa]", "[", "j", "]"}], " ", 
    RowBox[{"Cq", "[", 
     RowBox[{"q", "[", "j", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.829684118754727*^9, 3.82968413569598*^9}, 
   3.829684235157915*^9, {3.839533530048126*^9, 3.839533561541871*^9}, {
   3.839536766103243*^9, 3.839536767014223*^9}, {3.8395706390494223`*^9, 
   3.839570671868791*^9}, {3.839570917020791*^9, 3.839570963627531*^9}},
 CellLabel->
  "In[996]:=",ExpressionUUID->"ec436de9-ce2e-4f3d-a988-2d215346391b"],

Cell["\<\
 In general, the cost function would have \[Kappa] depend on R[j] as well as \
j.\
\>", "Text",
 CellChangeTimes->{{3.839593293301633*^9, 
  3.839593320387177*^9}},ExpressionUUID->"76e6aa07-ec0f-4285-ac91-\
9b27af2073a5"],

Cell["When R=0, cost will be", "Text",
 CellChangeTimes->{{3.8395930756138563`*^9, 
  3.8395930805414667`*^9}},ExpressionUUID->"9cbb7c48-cf7b-42e0-86bd-\
17662c34ac90"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CostR0", "[", "j_", "]"}], "=", 
  RowBox[{
   RowBox[{"\[Kappa]0", "[", "j", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"q", "[", "j", "]"}], "2"], " "}]}]], "Input",
 CellChangeTimes->{{3.839593084727171*^9, 3.839593125675848*^9}},
 CellLabel->
  "In[997]:=",ExpressionUUID->"b8fb8ca6-f2b1-43ae-98ad-cc2115fe47f0"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"q", "[", "j", "]"}], "2"], " ", 
  RowBox[{"\[Kappa]0", "[", "j", "]"}]}]], "Output",
 CellChangeTimes->{
  3.839593129160808*^9, 3.839595099902225*^9, 3.8420503051690083`*^9, 
   3.8420504155301604`*^9, 3.842050512709908*^9, {3.84205057502162*^9, 
   3.842050602946987*^9}, 3.84205068455488*^9, 3.842050720888489*^9, 
   3.84205079151606*^9, {3.8420508498499236`*^9, 3.8420508741599646`*^9}, 
   3.8420509541527185`*^9, 3.842051030628675*^9, 3.8420512825855722`*^9, 
   3.842052565816732*^9, 3.842052683988712*^9, 3.842054381841098*^9, 
   3.842055511867689*^9, 3.842055675906382*^9, 3.8420558563259916`*^9, 
   3.8420581500280886`*^9, 3.842058484474147*^9, 3.8420592322149057`*^9},
 CellLabel->
  "Out[997]=",ExpressionUUID->"9444010f-dc37-4503-adf7-bd39883bd3c2"]
}, Open  ]],

Cell["\<\
Therefore, marginal cost at zero output is zero, implying that firm j will \
produce something as long as price is positive. Large values for \[Kappa]0[j] \
will imply small amounts of production.\
\>", "Text",
 CellChangeTimes->{{3.8395931449544153`*^9, 3.8395931824413567`*^9}, {
  3.839593245334835*^9, 
  3.839593263709771*^9}},ExpressionUUID->"a050fd8a-3cde-45b8-baf7-\
ceb54558f73f"],

Cell[TextData[{
 StyleBox["NOTE:",
  FontWeight->"Bold"],
 " Because of the \[Kappa][j] factor, this problem is NOT symmetric."
}], "Text",
 CellChangeTimes->{{3.839571096671131*^9, 
  3.839571141618938*^9}},ExpressionUUID->"746b2aa6-7422-4b25-875e-\
7f6bb9cbf123"],

Cell["\<\
If firm i produces qi, then total output is q1+q2, and price is P[q1+q2].
Profi is the net revenue (sales revenue minus production costs) for firm i \
producing qi when it is at productivity level \[Theta]i, and is defined by \
the following\
\>", "Text",ExpressionUUID->"2141b4e2-e49c-463d-97f1-455104b89fc4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Qsum", "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"q", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "numfirms"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.829684159848329*^9, 3.829684184990281*^9}, {
   3.8296842290142727`*^9, 3.8296842465246677`*^9}, 3.83012733291792*^9, {
   3.830262321885888*^9, 3.830262322578094*^9}, {3.830262621000511*^9, 
   3.8302626230226393`*^9}, {3.830348028369493*^9, 3.830348029014439*^9}, {
   3.830348060886685*^9, 3.830348062555874*^9}},
 CellLabel->
  "In[998]:=",ExpressionUUID->"20633d23-4c26-4593-a8eb-2a7263f34d2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"q", "[", "1", "]"}], "+", 
  RowBox[{"q", "[", "2", "]"}], "+", 
  RowBox[{"q", "[", "3", "]"}]}]], "Output",
 CellChangeTimes->{
  3.830262394395402*^9, 3.830262466174268*^9, 3.830262578277463*^9, 
   3.8302626461646347`*^9, 3.830268322516543*^9, 3.8302757042939243`*^9, 
   3.8302970888710403`*^9, 3.830297473214035*^9, 3.830303633349348*^9, 
   3.830303715030621*^9, 3.830304934443755*^9, 3.830348046560556*^9, 
   3.830348113546061*^9, 3.830348498444207*^9, 3.830355209249707*^9, 
   3.8303557692995443`*^9, 3.8303559179817533`*^9, 3.830356256375646*^9, 
   3.8303809875255013`*^9, {3.8303813838372593`*^9, 3.830381400916333*^9}, 
   3.83038259602785*^9, 3.830386014815693*^9, 3.830872678146864*^9, 
   3.831388191065008*^9, 3.8313971273287*^9, 3.839466258140909*^9, 
   3.839521566727371*^9, 3.839521680470406*^9, 3.8395304183335047`*^9, 
   3.839531356660406*^9, 3.839532996006217*^9, 3.839533576884548*^9, 
   3.839533697822184*^9, 3.8395372590471363`*^9, 3.839538198996222*^9, 
   3.8395710621112823`*^9, 3.839571708234543*^9, 3.839595099907166*^9, 
   3.842050305364005*^9, 3.8420504156781473`*^9, 3.8420505129169087`*^9, {
   3.84205057522062*^9, 3.842050603132989*^9}, 3.842050684741878*^9, 
   3.842050721094486*^9, 3.842050791799225*^9, {3.8420508500919256`*^9, 
   3.8420508744481645`*^9}, 3.842050954365717*^9, 3.84205103085968*^9, 
   3.842051282761573*^9, 3.842052565967251*^9, 3.842052684239709*^9, 
   3.8420543821590967`*^9, 3.8420555120536876`*^9, 3.84205567610738*^9, 
   3.8420558565319943`*^9, 3.8420581502594786`*^9, 3.842058484830146*^9, 
   3.842059232542012*^9},
 CellLabel->
  "Out[998]=",ExpressionUUID->"1eb5df47-2a9f-4182-9f68-1f8a5bfc285d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Prof", "[", "i_", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"q", "[", "i", "]"}], "  ", 
    RowBox[{"P", "[", "Qsum", "]"}]}], " ", "-", " ", 
   RowBox[{"Cost", "[", "i", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.389127088796875*^9, 3.389127097203125*^9}, {
  3.8296841543206177`*^9, 3.8296841553764963`*^9}, {3.829684196295463*^9, 
  3.8296842226372347`*^9}, {3.8296842537895403`*^9, 3.8296842687883377`*^9}, {
  3.8302624604388514`*^9, 3.830262460612977*^9}, {3.8302626269842663`*^9, 
  3.8302626282229443`*^9}, {3.839533828278442*^9, 3.839533828989028*^9}, {
  3.839570775026003*^9, 3.839570777049411*^9}, {3.839571065936452*^9, 
  3.839571072816306*^9}},
 CellLabel->
  "In[999]:=",ExpressionUUID->"338094e6-214d-44ab-b9f8-872f9b36121e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{
     RowBox[{"q", "[", "1", "]"}], "+", 
     RowBox[{"q", "[", "2", "]"}], "+", 
     RowBox[{"q", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"q", "[", "i", "]"}]}], "-", 
  RowBox[{
   RowBox[{"Cq", "[", 
    RowBox[{"q", "[", "i", "]"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", "i", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.8302623944040318`*^9, 3.8302624661806297`*^9, 3.830262578287507*^9, 
   3.830262646215879*^9, 3.83026832252386*^9, 3.830275704300474*^9, 
   3.8302970889238663`*^9, 3.830297473267811*^9, 3.8303036333570642`*^9, 
   3.830303715038107*^9, 3.830304934451083*^9, 3.830348046566307*^9, 
   3.830348113588798*^9, 3.830348498498859*^9, 3.8303552092566137`*^9, 
   3.8303557693052187`*^9, 3.830355917987352*^9, 3.830356256422327*^9, 
   3.830380987593319*^9, {3.830381383841362*^9, 3.8303814009208193`*^9}, 
   3.830382596070018*^9, 3.830386014822565*^9, 3.8308726782140617`*^9, 
   3.83138819115123*^9, 3.8313971273398037`*^9, 3.839466258177588*^9, 
   3.8395215667729063`*^9, 3.839521680475354*^9, 3.839530418378798*^9, 
   3.839531356665728*^9, 3.839532996012436*^9, 3.839533576889934*^9, 
   3.839533697828609*^9, {3.839533830527555*^9, 3.839533854361751*^9}, 
   3.839537259052744*^9, 3.839538199027759*^9, 3.8395710738248367`*^9, 
   3.839571708311945*^9, 3.839595099943445*^9, 3.8420503055621233`*^9, 
   3.8420504158601465`*^9, 3.8420505131609125`*^9, {3.8420505754586267`*^9, 
   3.8420506033619876`*^9}, 3.842050684964881*^9, 3.842050721327488*^9, 
   3.8420507921015406`*^9, {3.842050850337308*^9, 3.8420508747311645`*^9}, 
   3.8420509546107225`*^9, 3.842051031125229*^9, 3.842051282994574*^9, 
   3.8420525661447644`*^9, 3.842052684555708*^9, 3.8420543827017765`*^9, 
   3.84205551234169*^9, 3.842055676352378*^9, 3.842055856783962*^9, 
   3.8420581505144777`*^9, 3.8420584853011475`*^9, 3.8420592328040133`*^9},
 CellLabel->
  "Out[999]=",ExpressionUUID->"3d4420f4-e229-49d1-923c-8a0b549f7af8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transition Dynamics", "Subsection",ExpressionUUID->"fbe33327-0950-42b0-9e34-f84ac03a727e"],

Cell["\<\
Transitions: There is one force changing the state: depletion\
\>", "Text",
 CellChangeTimes->{{3.829504106682466*^9, 3.829504120185123*^9}, {
  3.839532851367587*^9, 
  3.839532873309738*^9}},ExpressionUUID->"9935471d-3f3a-4f13-bad2-\
6270dde9638d"],

Cell["\<\
\[CapitalPi]chi[mi + chi,  qi] is the hazard rate that firm i\
\[CloseCurlyQuote]s state changes from mi to mi + chi.
In this example, the only possible chi is -1.
It depends on firm i\[CloseCurlyQuote]s output, qi.

ProbiDn is probability that firm i drops down a state
ProbiDn = \[CapitalPi]chi[mi - 1,  ui , qi] dt\
\>", "Text",
 CellChangeTimes->{{3.829575082517016*^9, 3.829575238009018*^9}, {
  3.82957529183127*^9, 3.829575572167509*^9}, {3.839529462248674*^9, 
  3.8395294658165483`*^9}, {3.839529511832708*^9, 3.8395295917578983`*^9}, {
  3.8395329717295523`*^9, 3.8395329849852343`*^9}, {3.8395335852449303`*^9, 
  3.8395336588942957`*^9}},ExpressionUUID->"8339056e-f6bd-488b-b2bb-\
e7e21a4e8836"],

Cell["\<\
NOTIONAL NOTE: I will use notations like ProbDep to represent the hazard \
rates of transitions. Do not be confused by my use of the prefix Prob in this \
context.\
\>", "Text",
 CellChangeTimes->{{3.829575640325611*^9, 
  3.8295757118358927`*^9}},ExpressionUUID->"9816cc8e-cd91-4174-9e1d-\
19a5155c13e5"],

Cell[CellGroupData[{

Cell["Transition probabilities", "Subsubsection",ExpressionUUID->"24f626f8-a5dd-4560-89f1-a73c24b50e25"],

Cell["\<\
The state for firm i goes down if there is depreciation, and the rate of \
depreciation is proportional to output
EXCEPT when R=0, in which case \[Delta]=0.\
\>", "Text",
 CellChangeTimes->{{3.830296945230543*^9, 3.830296950013527*^9}, {
  3.839532886133389*^9, 3.8395328985965633`*^9}, {3.839536800096511*^9, 
  3.8395368250619507`*^9}, {3.8395369460368567`*^9, 
  3.839536958251814*^9}},ExpressionUUID->"74e19e32-61f1-45ef-abd5-\
2192bee6fec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPi]ch", "[", "i_", "]"}], "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "xuvec_", ",", "xmvec_"}], "]"}], "=", 
   RowBox[{"\[Delta]", " ", 
    RowBox[{"q", "[", "i", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.389034548359375*^9, 3.38903483503125*^9}, {
   3.38903487509375*^9, 3.38903488065625*^9}, 3.389193459265625*^9, {
   3.389698430891797*^9, 3.3896984954346046`*^9}, {3.3897115636869583`*^9, 
   3.389711657321598*^9}, {3.389712016958731*^9, 3.3897120352149825`*^9}, {
   3.3897231445680175`*^9, 3.389723167230605*^9}, {3.389723475604024*^9, 
   3.389723525836254*^9}, {3.389725390657035*^9, 3.389725418046419*^9}, {
   3.3897254554201603`*^9, 3.389725462009635*^9}, {3.829526486867487*^9, 
   3.829526489338531*^9}, {3.829684397865552*^9, 3.829684485213928*^9}, {
   3.829694982066018*^9, 3.8296949870490913`*^9}, {3.829695051159927*^9, 
   3.829695069662516*^9}, 3.829695185710103*^9, {3.830296752055315*^9, 
   3.83029678861965*^9}, {3.830296954998769*^9, 3.8302969556383877`*^9}, {
   3.830297039820365*^9, 3.830297064002597*^9}, {3.8302974208331547`*^9, 
   3.830297422199079*^9}, {3.831398510288405*^9, 3.831398512406554*^9}, {
   3.839521646416038*^9, 3.839521647935309*^9}},
 CellLabel->
  "In[1000]:=",ExpressionUUID->"ab0ff058-f6da-4ab1-ad4f-ba367af6aff8"],

Cell["", "PageBreak",
 PageBreakBelow->True,ExpressionUUID->"ac2431b6-5578-4254-8aed-b417df10b28b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bellman equations and first-order conditions", "Section",
 CellChangeTimes->{{3.8295837715447807`*^9, 
  3.8295837795374117`*^9}},ExpressionUUID->"25edb417-18d9-478f-8f11-\
c980892e290e"],

Cell[CellGroupData[{

Cell["Bellman equations", "Subsection",
 CellChangeTimes->{
  3.829503521775547*^9},ExpressionUUID->"046d36f8-1dd7-42d7-9754-\
cec87b923393"],

Cell["\<\
V1plus is the expected change in the future value of firm 1 CONDITIONAL on \
there being a change\
\>", "Text",
 CellChangeTimes->{{3.829583961708009*^9, 
  3.829583983971097*^9}},ExpressionUUID->"e0b39e9a-4911-4be7-b5fd-\
f0b5653e5f36"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"state", "=", 
  RowBox[{"mvec", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["R", "i"], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "numfirms"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.829684627122643*^9, 3.829684634020727*^9}, {
  3.829684725352767*^9, 3.8296847406387033`*^9}, {3.8302971383784924`*^9, 
  3.830297160857293*^9}, {3.830348068645907*^9, 3.830348071035653*^9}, {
  3.839529630822678*^9, 3.8395296337171*^9}, {3.839571583308304*^9, 
  3.839571584459613*^9}},
 CellLabel->
  "In[1001]:=",ExpressionUUID->"06e7ed5d-0bfc-4638-92d2-8f2461335254"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["R", "1"], ",", 
   SubscriptBox["R", "2"], ",", 
   SubscriptBox["R", "3"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.830262394721195*^9, 3.8302624670913677`*^9, 3.830262578649036*^9, 
   3.830262646534862*^9, 3.83026832319144*^9, 3.830275704945004*^9, {
   3.8302971406558113`*^9, 3.8302971614493437`*^9}, 3.830297482925989*^9, 
   3.830303633855014*^9, 3.830303715486679*^9, 3.830304941089426*^9, 
   3.830348113857769*^9, 3.830348498809134*^9, 3.830355209895708*^9, 
   3.830355769613714*^9, 3.8303559182906847`*^9, 3.83035625673528*^9, 
   3.8303809879893017`*^9, {3.830381384251938*^9, 3.830381401368009*^9}, 
   3.8303826005804167`*^9, 3.830386032781382*^9, 3.830872678294785*^9, 
   3.831388191246038*^9, 3.8313974526962748`*^9, 3.839466258229198*^9, 
   3.8395215751808558`*^9, 3.839521657689453*^9, 3.839521697000143*^9, 
   3.839529603580901*^9, 3.8395296350875587`*^9, 3.8395304254595957`*^9, 
   3.8395313631643343`*^9, 3.839533734442136*^9, 3.839533876760869*^9, 
   3.839537273433028*^9, 3.839538199118334*^9, 3.839571185350646*^9, 
   3.8395715866879873`*^9, 3.839571708396743*^9, 3.839595099986135*^9, 
   3.8420503058601236`*^9, 3.8420504160131817`*^9, 3.8420505135849075`*^9, {
   3.842050575838621*^9, 3.842050603596986*^9}, 3.8420506851988792`*^9, 
   3.842050721570043*^9, 3.842050792541579*^9, {3.8420508506573105`*^9, 
   3.842050875230172*^9}, 3.842050955001998*^9, 3.84205103157323*^9, 
   3.8420512832705765`*^9, 3.842052566402762*^9, 3.8420526851395407`*^9, 
   3.8420543830867753`*^9, 3.842055512756775*^9, 3.842055676769379*^9, 
   3.842055857134963*^9, 3.8420581508824754`*^9, 3.8420584856859913`*^9, 
   3.8420592333542404`*^9},
 CellLabel->
  "Out[1001]=",ExpressionUUID->"8be66eef-ae24-4489-aa1f-d5655c309754"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ch", "=", 
  RowBox[{
   RowBox[{"IdentityMatrix", "[", "numfirms", "]"}], " ", 
   "\[CapitalDelta]"}]}]], "Input",
 CellChangeTimes->{{3.8296851953235598`*^9, 3.829685201241541*^9}, {
  3.8296853330310793`*^9, 3.829685338053844*^9}, {3.830348480546736*^9, 
  3.8303484819696093`*^9}},
 CellLabel->
  "In[1002]:=",ExpressionUUID->"dbddaf4f-27a0-4b4a-8c9e-4fbe329fc501"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[CapitalDelta]", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[CapitalDelta]", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "\[CapitalDelta]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.83026239477256*^9, 3.83026246722056*^9, 3.830262578702083*^9, 
   3.83026264659223*^9, 3.830268323278702*^9, 3.830275705032607*^9, 
   3.830297150750235*^9, 3.8302974361600523`*^9, 3.830297483133037*^9, 
   3.830303633935606*^9, 3.830303715584564*^9, 3.830304941341647*^9, 
   3.830348113949885*^9, {3.8303484831954308`*^9, 3.83034849893231*^9}, 
   3.830355209914262*^9, 3.83035576967206*^9, 3.830355918308649*^9, 
   3.830356256838986*^9, 3.830380988064332*^9, {3.830381384398337*^9, 
   3.830381401533485*^9}, 3.8303826007401657`*^9, 3.830386040030549*^9, 
   3.830872678447032*^9, 3.83138819134484*^9, 3.8313975088452997`*^9, 
   3.839466271491968*^9, 3.839521575372591*^9, 3.839521657769919*^9, 
   3.8395216970628366`*^9, 3.839529607102871*^9, 3.83952964413795*^9, 
   3.83953042552769*^9, 3.839531363280781*^9, 3.839533735658944*^9, 
   3.8395338768630133`*^9, 3.839537274936605*^9, 3.839538199150241*^9, 
   3.839571186368923*^9, 3.839571588243688*^9, 3.839571708402794*^9, 
   3.839595099992311*^9, 3.8420503060391283`*^9, 3.8420504162056055`*^9, 
   3.8420505138199067`*^9, {3.842050576054619*^9, 3.842050603911987*^9}, 
   3.8420506855133038`*^9, 3.8420507218810444`*^9, 3.8420507927535787`*^9, {
   3.842050850912309*^9, 3.842050875500165*^9}, 3.8420509552399993`*^9, 
   3.842051031830773*^9, 3.842051283608573*^9, 3.842052566630762*^9, 
   3.842052685419538*^9, 3.842054383391775*^9, 3.8420555129757767`*^9, 
   3.842055677036379*^9, 3.842055857351962*^9, 3.8420581511424756`*^9, 
   3.8420584859860635`*^9, 3.8420592336462383`*^9},
 CellLabel->
  "Out[1002]=",ExpressionUUID->"68ff2f04-56e8-45ba-bb16-376c19adfeb1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"nnewstate", "[", "i", "]"}], "=", 
    RowBox[{"state", "+", 
     RowBox[{"ch", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "numfirms"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8296851744441977`*^9, 3.8296851752643843`*^9}, {
  3.829685220427178*^9, 3.829685306041183*^9}, {3.830348083661268*^9, 
  3.830348084941223*^9}},
 CellLabel->
  "In[1003]:=",ExpressionUUID->"e57f6f36-9519-438b-bc87-98c89d910e50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"nnewstate", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "numfirms"}], "}"}]}], "]"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.8296850386345453`*^9, 3.829685046133553*^9}, 
   3.8296853156569977`*^9, {3.830348088476654*^9, 3.8303480906934767`*^9}, {
   3.8313975247604837`*^9, 3.831397541096037*^9}},
 CellLabel->
  "In[1004]:=",ExpressionUUID->"fe6d9b11-2fef-4bed-a0f5-088623c052c3"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"\[CapitalDelta]", "+", 
      SubscriptBox["R", "1"]}], 
     SubscriptBox["R", "2"], 
     SubscriptBox["R", "3"]},
    {
     SubscriptBox["R", "1"], 
     RowBox[{"\[CapitalDelta]", "+", 
      SubscriptBox["R", "2"]}], 
     SubscriptBox["R", "3"]},
    {
     SubscriptBox["R", "1"], 
     SubscriptBox["R", "2"], 
     RowBox[{"\[CapitalDelta]", "+", 
      SubscriptBox["R", "3"]}]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.831397542635491*^9, 3.8394662715535383`*^9, 3.8395215754585867`*^9, 
   3.839521657847885*^9, 3.8395216971147337`*^9, 3.8395296093632*^9, 
   3.839529647218339*^9, 3.839530425584167*^9, 3.839531363338669*^9, 
   3.839533737835227*^9, 3.839533876910438*^9, 3.839537282496127*^9, 
   3.8395381991880693`*^9, 3.839571187914791*^9, 3.839571589379677*^9, 
   3.8395717084878883`*^9, 3.839595100032488*^9, 3.8420503062521243`*^9, 
   3.842050416480607*^9, 3.8420505140899076`*^9, {3.84205057630062*^9, 
   3.8420506041149874`*^9}, 3.8420506857423034`*^9, 3.8420507221030445`*^9, 
   3.8420507929875784`*^9, {3.842050851182308*^9, 3.842050875787166*^9}, 
   3.842050955501994*^9, 3.842051032107774*^9, 3.842051283837575*^9, 
   3.8420525668902855`*^9, 3.8420526859445395`*^9, 3.8420543840457788`*^9, 
   3.8420555132734566`*^9, 3.8420556773123817`*^9, 3.842055857753255*^9, 
   3.8420581514924746`*^9, 3.8420584864370613`*^9, 3.8420592341432395`*^9},
 CellLabel->
  "Out[1004]//TableForm=",ExpressionUUID->"4f17b535-dff6-42eb-9121-\
5a35862817a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Vplus", "[", "i_", "]"}], "=", 
  RowBox[{"Sum", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"V", "[", "i", "]"}], "@@", "state"}]}], "+", 
         RowBox[{
          RowBox[{"V", "[", "i", "]"}], "@@", 
          RowBox[{"nnewstate", "[", "j", "]"}]}]}], ")"}], " ", 
       RowBox[{
        RowBox[{"\[CapitalPi]ch", "[", "j", "]"}], "[", 
        RowBox[{"\[CapitalDelta]", ",", "uvec", ",", "mvec"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[CapitalDelta]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"j", ",", "numfirms"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.389033763046875*^9, 3.38903390040625*^9}, {
   3.389033932796875*^9, 3.38903393790625*^9}, {3.3890339978125*^9, 
   3.38903405815625*^9}, {3.389034093046875*^9, 3.389034095046875*^9}, 
   3.38903412521875*^9, {3.389707617602768*^9, 3.389707693071286*^9}, {
   3.38971118111685*^9, 3.389711219902621*^9}, {3.389711251257707*^9, 
   3.389711269253584*^9}, {3.3897236045294094`*^9, 3.3897236115895615`*^9}, {
   3.82955831213048*^9, 3.8295583140741873`*^9}, {3.829684544421918*^9, 
   3.8296845571239223`*^9}, {3.82968548953758*^9, 3.829685532049073*^9}, {
   3.8296855697372217`*^9, 3.829685670084203*^9}, {3.829688681119473*^9, 
   3.829688768236586*^9}, 3.829688801855906*^9, {3.830297259974626*^9, 
   3.8302972648607883`*^9}, {3.83029733118902*^9, 3.830297333475457*^9}, {
   3.8303480959718237`*^9, 3.830348098364596*^9}, {3.830386077998703*^9, 
   3.830386080959414*^9}, {3.831397644441114*^9, 3.831397651809618*^9}, {
   3.8395288150220127`*^9, 3.8395288172137947`*^9}, {3.839529745885551*^9, 
   3.83952974629185*^9}, {3.842054375994012*^9, 3.8420543787532797`*^9}},
 CellLabel->
  "In[1005]:=",ExpressionUUID->"18c00eac-46ba-479f-8a27-245d6a7f092b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Delta]", " ", 
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["R", "1"]}], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
  RowBox[{"\[Delta]", " ", 
   RowBox[{"q", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["R", "2"]}], ",", 
       SubscriptBox["R", "3"]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
  RowBox[{"\[Delta]", " ", 
   RowBox[{"q", "[", "3", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["R", "3"]}]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.830262394873477*^9, 3.830262467432077*^9, 3.8302625788095407`*^9, 
   3.830262646703435*^9, 3.830268323449854*^9, 3.830275705300228*^9, 
   3.830297184138116*^9, 3.830297273323718*^9, 3.8302973352233753`*^9, 
   3.8302974509824944`*^9, 3.830297483425816*^9, 3.830303634150622*^9, 
   3.830303715852089*^9, 3.830304956919883*^9, 3.8303481141265383`*^9, 
   3.830348505148704*^9, 3.830355210319957*^9, 3.8303557698197002`*^9, 
   3.830355918452269*^9, 3.830356256949903*^9, 3.830380988220702*^9, {
   3.830381384556555*^9, 3.830381401629087*^9}, 3.830382600813005*^9, {
   3.830386058695846*^9, 3.830386082180525*^9}, 3.8308726785974894`*^9, 
   3.831388191530307*^9, 3.8313975808353024`*^9, 3.839466271564946*^9, 
   3.839521579735558*^9, 3.8395216579227257`*^9, 3.8395217002050323`*^9, 
   3.8395288184404078`*^9, 3.839529612219201*^9, 3.8395296524823103`*^9, 
   3.8395297469999332`*^9, 3.839530425644826*^9, 3.839531363402069*^9, 
   3.839533739738323*^9, 3.839533876926063*^9, 3.839537289219246*^9, 
   3.8395381991957207`*^9, 3.839571189393908*^9, 3.839571590946089*^9, 
   3.839571708570829*^9, 3.8395951000698137`*^9, 3.8420503064391255`*^9, 
   3.8420504166696053`*^9, 3.842050514336907*^9, {3.8420505765156193`*^9, 
   3.8420506043079886`*^9}, 3.8420506859255915`*^9, 3.842050722305044*^9, 
   3.8420507932075787`*^9, {3.8420508514523115`*^9, 3.842050876113164*^9}, 
   3.8420509557389956`*^9, 3.842051032388773*^9, 3.8420512840955734`*^9, 
   3.8420525670622873`*^9, 3.842052686251652*^9, 3.842054384515775*^9, 
   3.842055513567458*^9, 3.8420556775501947`*^9, 3.842055857973256*^9, 
   3.842058151754476*^9, 3.842058486764062*^9, 3.8420592344802394`*^9},
 CellLabel->
  "Out[1005]=",ExpressionUUID->"15caf9cb-53fe-4386-b247-ad47db79c0de"]
}, Open  ]],

Cell["Possible way to simplify notation", "Text",
 CellChangeTimes->{{3.8395721553742037`*^9, 
  3.839572164517688*^9}},ExpressionUUID->"a13f3ec6-5b21-4024-8c68-\
aeaf6704b6aa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Vplus", "[", "i", "]"}], "/.", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"V", "[", "i", "]"}], "[", 
    RowBox[{"zz___", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "yy_"}], ",", "ww___"}], "]"}], "->", " ", 
   RowBox[{
    RowBox[{"V", "[", "i", "]"}], "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "yy"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.839572053539568*^9, 3.8395721313040447`*^9}},
 CellLabel->
  "In[1006]:=",ExpressionUUID->"b19610b8-9863-4f63-a7c7-d401c09c6d30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Delta]", " ", 
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["R", "1"]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
  RowBox[{"\[Delta]", " ", 
   RowBox[{"q", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["R", "2"]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
  RowBox[{"\[Delta]", " ", 
   RowBox[{"q", "[", "3", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["R", "3"]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.839572132720209*^9, 3.839595100076618*^9, 3.8420503066311255`*^9, 
   3.842050416848605*^9, 3.84205051459239*^9, {3.8420505767326193`*^9, 
   3.842050604528985*^9}, 3.8420506861474133`*^9, 3.842050722557295*^9, 
   3.842050793480591*^9, {3.8420508517023077`*^9, 3.8420508763798904`*^9}, 
   3.842050955980998*^9, 3.842051032726336*^9, 3.842051284311287*^9, 
   3.8420525672512846`*^9, 3.8420526866046505`*^9, 3.842054385093814*^9, 
   3.8420555139364552`*^9, 3.84205567783215*^9, 3.842055858458256*^9, 
   3.842058152114475*^9, 3.842058487045063*^9, 3.842059234790238*^9},
 CellLabel->
  "Out[1006]=",ExpressionUUID->"da4b27c8-35cd-4901-8448-818b170e130c"]
}, Open  ]],

Cell["\<\
PV is the present value of profits, and equals current net revenue from sales \
plus the expectation of the change in the future value.\
\>", "Text",
 CellChangeTimes->{{3.829584063969352*^9, 3.8295840742570143`*^9}, {
   3.839533759301971*^9, 3.839533764229306*^9}, 
   3.839571228152474*^9},ExpressionUUID->"f7bc3e51-d745-4593-98cd-\
a69cf0e36623"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PV", "[", "i_", "]"}], "=", 
  RowBox[{
   RowBox[{"Prof", "[", "i", "]"}], " ", "+", "  ", 
   RowBox[{"Vplus", "[", "i", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.3897113014398656`*^9, {3.82968885385635*^9, 3.829688881321301*^9}, 
   3.829695260467936*^9, {3.839531445251006*^9, 3.8395314506578283`*^9}},
 CellLabel->
  "In[1007]:=",ExpressionUUID->"d6372644-0432-4561-b4f6-01512de79d44"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{
     RowBox[{"q", "[", "1", "]"}], "+", 
     RowBox[{"q", "[", "2", "]"}], "+", 
     RowBox[{"q", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"q", "[", "i", "]"}]}], "-", 
  RowBox[{
   RowBox[{"Cq", "[", 
    RowBox[{"q", "[", "i", "]"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", "i", "]"}]}], "+", 
  RowBox[{"\[Delta]", " ", 
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["R", "1"]}], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
  RowBox[{"\[Delta]", " ", 
   RowBox[{"q", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["R", "2"]}], ",", 
       SubscriptBox["R", "3"]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
  RowBox[{"\[Delta]", " ", 
   RowBox[{"q", "[", "3", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["R", "3"]}]}], "]"}], "-", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.830262394919653*^9, 3.8302624674414873`*^9, 3.830262578824998*^9, 
   3.830262646713067*^9, 3.830268323538928*^9, 3.830275705382306*^9, 
   3.8302971888556013`*^9, 3.830297367893862*^9, 3.8302974835287724`*^9, 
   3.830303634158805*^9, 3.830303715951111*^9, 3.830304975946155*^9, 
   3.830348114132893*^9, 3.8303485092261057`*^9, 3.830355210418944*^9, 
   3.830355769829908*^9, 3.8303559184599943`*^9, 3.830356257001478*^9, 
   3.8303809882924232`*^9, {3.830381384562594*^9, 3.830381401699225*^9}, 
   3.830382600818387*^9, {3.830386060958479*^9, 3.830386084320586*^9}, 
   3.8308726786065397`*^9, 3.8313881916171913`*^9, 3.831397705738514*^9, 
   3.8394662716191998`*^9, 3.839521579858551*^9, 3.839521657997035*^9, 
   3.839521700265276*^9, 3.839528828667019*^9, 3.839529846009815*^9, 
   3.839530430192554*^9, 3.8395313634574957`*^9, 3.839531461969195*^9, {
   3.8395337423473063`*^9, 3.839533767377783*^9}, 3.839533879540476*^9, 
   3.839537291619544*^9, 3.839538199228704*^9, 3.839571230375367*^9, 
   3.83957159333222*^9, 3.839571726914494*^9, 3.839595100113603*^9, 
   3.8420503068201246`*^9, 3.8420504170226064`*^9, 3.8420505148553944`*^9, {
   3.8420505769831944`*^9, 3.842050604724989*^9}, 3.8420506863564115`*^9, 
   3.8420507227882967`*^9, 3.84205079369258*^9, {3.8420508520643153`*^9, 
   3.8420508766418934`*^9}, 3.8420509562799993`*^9, 3.8420510329883375`*^9, 
   3.8420512845552864`*^9, 3.8420525674609127`*^9, 3.842052686921846*^9, 
   3.8420543854308147`*^9, 3.842055514216457*^9, 3.8420556780670185`*^9, 
   3.8420558586992564`*^9, 3.842058152363103*^9, 3.8420584874658747`*^9, 
   3.842059235086239*^9},
 CellLabel->
  "Out[1007]=",ExpressionUUID->"28e26bcf-4d58-49aa-84f9-400770af2f99"]
}, Open  ]],

Cell["Here is the continuous time Bellman equation", "Text",
 CellChangeTimes->{{3.8295841361830053`*^9, 
  3.829584147818166*^9}},ExpressionUUID->"cf4aeca9-45bd-450d-adfc-\
7f38ed063af9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eqV", "[", "i_", "]"}], "=", 
  RowBox[{
   RowBox[{"\[Rho]", " ", 
    RowBox[{
     RowBox[{"V", "[", "i", "]"}], "@@", "state"}]}], "\[Equal]", 
   RowBox[{"PV", "[", "i", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.388452472451971*^9, 3.388452481264643*^9}, {
   3.389711404337826*^9, 3.389711405159006*^9}, {3.829578458406066*^9, 
   3.829578459142014*^9}, {3.829688894721961*^9, 3.8296889182082033`*^9}, 
   3.829697447414032*^9},
 CellLabel->
  "In[1008]:=",ExpressionUUID->"9e2ffe3e-59b2-41f2-96f4-a9b9e3a7ae0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]", " ", 
   RowBox[{
    RowBox[{"V", "[", "i", "]"}], "[", 
    RowBox[{
     SubscriptBox["R", "1"], ",", 
     SubscriptBox["R", "2"], ",", 
     SubscriptBox["R", "3"]}], "]"}]}], "\[Equal]", 
  RowBox[{
   RowBox[{
    RowBox[{"P", "[", 
     RowBox[{
      RowBox[{"q", "[", "1", "]"}], "+", 
      RowBox[{"q", "[", "2", "]"}], "+", 
      RowBox[{"q", "[", "3", "]"}]}], "]"}], " ", 
    RowBox[{"q", "[", "i", "]"}]}], "-", 
   RowBox[{
    RowBox[{"Cq", "[", 
     RowBox[{"q", "[", "i", "]"}], "]"}], " ", 
    RowBox[{"\[Kappa]", "[", "i", "]"}]}], "+", 
   RowBox[{"\[Delta]", " ", 
    RowBox[{"q", "[", "1", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["R", "1"]}], ",", 
        SubscriptBox["R", "2"], ",", 
        SubscriptBox["R", "3"]}], "]"}], "-", 
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        SubscriptBox["R", "1"], ",", 
        SubscriptBox["R", "2"], ",", 
        SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
   RowBox[{"\[Delta]", " ", 
    RowBox[{"q", "[", "2", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        SubscriptBox["R", "1"], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["R", "2"]}], ",", 
        SubscriptBox["R", "3"]}], "]"}], "-", 
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        SubscriptBox["R", "1"], ",", 
        SubscriptBox["R", "2"], ",", 
        SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
   RowBox[{"\[Delta]", " ", 
    RowBox[{"q", "[", "3", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        SubscriptBox["R", "1"], ",", 
        SubscriptBox["R", "2"], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["R", "3"]}]}], "]"}], "-", 
      RowBox[{
       RowBox[{"V", "[", "i", "]"}], "[", 
       RowBox[{
        SubscriptBox["R", "1"], ",", 
        SubscriptBox["R", "2"], ",", 
        SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.830262394928371*^9, 3.830262467525586*^9, 3.830262578878171*^9, 
   3.830262646764634*^9, 3.830268333010795*^9, 3.830275705391612*^9, 
   3.830297372072938*^9, 3.8302975215907173`*^9, 3.830303651127658*^9, 
   3.830303716047665*^9, 3.8303049761543427`*^9, 3.830348118422737*^9, 
   3.8303485096054087`*^9, 3.8303552105213547`*^9, 3.830355769880198*^9, 
   3.8303559185123777`*^9, 3.830356257056509*^9, 3.8303809883660793`*^9, {
   3.830381384639888*^9, 3.830381401782968*^9}, 3.830382600877211*^9, 
   3.83038609147368*^9, 3.8308726786822033`*^9, 3.831388191629224*^9, 
   3.831397728412684*^9, 3.839466271628194*^9, 3.839521579869453*^9, 
   3.8395216580039454`*^9, 3.8395217060376253`*^9, 3.839528832330529*^9, 
   3.839529847646762*^9, 3.839530430253633*^9, 3.839531368766515*^9, 
   3.839531470020475*^9, 3.839533769497974*^9, 3.8395338984636*^9, 
   3.839537307508533*^9, 3.839538199236512*^9, 3.839571234023592*^9, 
   3.839571595412425*^9, 3.83957173570572*^9, 3.839595100124045*^9, 
   3.842050307049124*^9, 3.842050417174605*^9, 3.8420505150383916`*^9, {
   3.84205057717819*^9, 3.84205060500144*^9}, 3.8420506866024117`*^9, 
   3.842050723072295*^9, 3.842050793890022*^9, {3.8420508524075136`*^9, 
   3.8420508769128923`*^9}, 3.842050956506996*^9, 3.842051033232669*^9, 
   3.8420512847232857`*^9, 3.8420525676369143`*^9, 3.842052687480015*^9, 
   3.8420543858179007`*^9, 3.842055514448456*^9, 3.8420556783240585`*^9, 
   3.84205585894884*^9, 3.842058152631299*^9, 3.8420584877594295`*^9, 
   3.842059235529887*^9},
 CellLabel->
  "Out[1008]=",ExpressionUUID->"d3d89533-e0bf-4de4-b7a6-c6cfd5da3b4a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Output choices", "Subsection",
 CellChangeTimes->{{3.829503711184219*^9, 
  3.829503714511743*^9}},ExpressionUUID->"28eca8c2-df3f-4e9c-8baf-\
dca634dc895f"],

Cell["\<\
The first order conditions for each firm's choice of output are\
\>", "Text",
 CellChangeTimes->{
  3.3881614901138926`*^9, 3.829503705386819*^9, {3.830386101052642*^9, 
   3.830386102292041*^9}},ExpressionUUID->"f441a74a-3b07-4fa9-8409-\
ce4ed947805d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"focq", "[", "i_", "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"PV", "[", "i", "]"}], ",", 
    RowBox[{"q", "[", "i", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3884525091347184`*^9, 3.388452509745597*^9}, {
   3.3897228919547777`*^9, 3.3897228927459154`*^9}, {3.389722940965251*^9, 
   3.3897229478852015`*^9}, {3.8296889364006567`*^9, 3.829688957369193*^9}, 
   3.839521604981165*^9},
 CellLabel->
  "In[1009]:=",ExpressionUUID->"a8fd3842-4412-4e94-9df6-53bb1cba3cb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqVfocq", "[", "i_", "]"}], ":=", 
  RowBox[{"0", "\[Equal]", 
   RowBox[{"focq", "[", "i", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.388164376826331*^9, 3.388164413448992*^9}, {
   3.388452517867275*^9, 3.3884525185482545`*^9}, {3.3897230055180736`*^9, 
   3.389723017264965*^9}, 3.829578470070282*^9, {3.829663006801602*^9, 
   3.829663036879025*^9}, {3.829688964325815*^9, 3.829688970519424*^9}, 
   3.829693263047916*^9, 3.839521609514412*^9},
 CellLabel->
  "In[1010]:=",ExpressionUUID->"d3d2a842-eb3f-4a03-a20d-a553902923d1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"eqVfocq", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "numfirms"}], "}"}]}], "]"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.831397993161327*^9, 3.831398019535492*^9}, {
  3.83953732279809*^9, 3.839537325434231*^9}},
 CellLabel->
  "In[1011]:=",ExpressionUUID->"ce34e586-bfa4-4711-b80c-950fe29883a0"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], "+", 
          RowBox[{"q", "[", "2", "]"}], "+", 
          RowBox[{"q", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "1"]}], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "1", "]"}], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"\[Kappa]", "[", "1", "]"}], " ", 
         RowBox[{
          SuperscriptBox["Cq", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{"q", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"q", "[", "1", "]"}], " ", 
         RowBox[{
          SuperscriptBox["P", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], "+", 
           RowBox[{"q", "[", "2", "]"}], "+", 
           RowBox[{"q", "[", "3", "]"}]}], "]"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], "+", 
          RowBox[{"q", "[", "2", "]"}], "+", 
          RowBox[{"q", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "2"]}], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "2", "]"}], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"\[Kappa]", "[", "2", "]"}], " ", 
         RowBox[{
          SuperscriptBox["Cq", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{"q", "[", "2", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"q", "[", "2", "]"}], " ", 
         RowBox[{
          SuperscriptBox["P", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], "+", 
           RowBox[{"q", "[", "2", "]"}], "+", 
           RowBox[{"q", "[", "3", "]"}]}], "]"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], "+", 
          RowBox[{"q", "[", "2", "]"}], "+", 
          RowBox[{"q", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "3", "]"}], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "3"]}]}], "]"}], "-", 
           RowBox[{
            RowBox[{"V", "[", "3", "]"}], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"\[Kappa]", "[", "3", "]"}], " ", 
         RowBox[{
          SuperscriptBox["Cq", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{"q", "[", "3", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"q", "[", "3", "]"}], " ", 
         RowBox[{
          SuperscriptBox["P", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], "+", 
           RowBox[{"q", "[", "2", "]"}], "+", 
           RowBox[{"q", "[", "3", "]"}]}], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.839537326054167*^9, 3.8395381992793694`*^9, 3.83957124382023*^9, 
   3.839571599077241*^9, 3.8395717393802567`*^9, 3.8395951001764193`*^9, 
   3.8420503073081236`*^9, 3.8420504174293523`*^9, 3.8420505152993965`*^9, {
   3.842050577413192*^9, 3.842050605280438*^9}, 3.842050686840439*^9, 
   3.842050723392295*^9, 3.842050794187023*^9, {3.842050852747257*^9, 
   3.8420508773298917`*^9}, 3.8420509567881403`*^9, 3.842051033598255*^9, 
   3.842051284940286*^9, 3.842052568026601*^9, 3.8420526878830166`*^9, 
   3.8420543865594716`*^9, 3.842055514950457*^9, 3.8420556788730593`*^9, 
   3.842055859538848*^9, 3.8420581531453*^9, 3.8420584884024305`*^9, 
   3.842059235951887*^9},
 CellLabel->
  "Out[1011]//TableForm=",ExpressionUUID->"58a147c1-1c31-44f6-bb7e-\
2b8025a6a28f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["System", "Section",
 CellChangeTimes->{{3.389723048009173*^9, 3.3897230546787634`*^9}, {
  3.829578931935226*^9, 
  3.8295789328236723`*^9}},ExpressionUUID->"432c20ca-4a71-4c8a-8d7d-\
8ececbc1adaa"],

Cell["Here is the system for general cost and demand functions.", "Text",
 CellChangeTimes->{{3.829584198143961*^9, 
  3.829584211425301*^9}},ExpressionUUID->"2c4fb6b4-257b-48c3-a9d6-\
3a156202c810"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sys", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eqV", "[", "i", "]"}], ",", 
        RowBox[{"eqVfocq", "[", "i", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "numfirms"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sys", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"sys", "/.", " ", 
      RowBox[{
       RowBox[{"V", "[", "i_", "]"}], "\[Rule]", 
       SubscriptBox["V", "i"]}]}], "/.", 
     RowBox[{
      RowBox[{"q", "[", "i_", "]"}], "\[Rule]", 
      SubscriptBox["q", "i"]}]}], "/.", 
    RowBox[{
     RowBox[{"\[Kappa]", "[", "i_", "]"}], "->", " ", 
     SubscriptBox["\[Kappa]", "i"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.829504279835319*^9, 3.82950434261852*^9}, {
  3.829692789886599*^9, 3.829692849907494*^9}, {3.829693250448049*^9, 
  3.829693254110168*^9}, {3.8303481364738293`*^9, 3.830348137922256*^9}, {
  3.8395298853619127`*^9, 3.8395298870094957`*^9}, {3.839537971253234*^9, 
  3.8395379794423656`*^9}, {3.839571263063863*^9, 3.839571276142091*^9}, {
  3.8395716307141943`*^9, 3.839571633521859*^9}},
 CellLabel->
  "In[1012]:=",ExpressionUUID->"d69e65dc-9795-439b-9782-060c04a9ab26"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"\[Rho]", " ", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"], "+", 
           SubscriptBox["q", "3"]}], "]"}], " ", 
         SubscriptBox["q", "1"]}], "-", 
        RowBox[{
         RowBox[{"Cq", "[", 
          SubscriptBox["q", "1"], "]"}], " ", 
         SubscriptBox["\[Kappa]", "1"]}], "+", 
        RowBox[{"\[Delta]", " ", 
         SubscriptBox["q", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "1"]}], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"\[Delta]", " ", 
         SubscriptBox["q", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "2"]}], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"\[Delta]", " ", 
         SubscriptBox["q", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "3"]}]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"], "+", 
          SubscriptBox["q", "3"]}], "]"}], "+", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "1"]}], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         SubscriptBox["\[Kappa]", "1"], " ", 
         RowBox[{
          SuperscriptBox["Cq", "\[Prime]",
           MultilineFunction->None], "[", 
          SubscriptBox["q", "1"], "]"}]}], "+", 
        RowBox[{
         SubscriptBox["q", "1"], " ", 
         RowBox[{
          SuperscriptBox["P", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"], "+", 
           SubscriptBox["q", "3"]}], "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Rho]", " ", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"], "+", 
           SubscriptBox["q", "3"]}], "]"}], " ", 
         SubscriptBox["q", "2"]}], "-", 
        RowBox[{
         RowBox[{"Cq", "[", 
          SubscriptBox["q", "2"], "]"}], " ", 
         SubscriptBox["\[Kappa]", "2"]}], "+", 
        RowBox[{"\[Delta]", " ", 
         SubscriptBox["q", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "1"]}], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"\[Delta]", " ", 
         SubscriptBox["q", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "2"]}], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"\[Delta]", " ", 
         SubscriptBox["q", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "3"]}]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"], "+", 
          SubscriptBox["q", "3"]}], "]"}], "+", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "2"]}], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         SubscriptBox["\[Kappa]", "2"], " ", 
         RowBox[{
          SuperscriptBox["Cq", "\[Prime]",
           MultilineFunction->None], "[", 
          SubscriptBox["q", "2"], "]"}]}], "+", 
        RowBox[{
         SubscriptBox["q", "2"], " ", 
         RowBox[{
          SuperscriptBox["P", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"], "+", 
           SubscriptBox["q", "3"]}], "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Rho]", " ", 
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"], "+", 
           SubscriptBox["q", "3"]}], "]"}], " ", 
         SubscriptBox["q", "3"]}], "-", 
        RowBox[{
         RowBox[{"Cq", "[", 
          SubscriptBox["q", "3"], "]"}], " ", 
         SubscriptBox["\[Kappa]", "3"]}], "+", 
        RowBox[{"\[Delta]", " ", 
         SubscriptBox["q", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "1"]}], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"\[Delta]", " ", 
         SubscriptBox["q", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "2"]}], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{"\[Delta]", " ", 
         SubscriptBox["q", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "3"]}]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"], "+", 
          SubscriptBox["q", "3"]}], "]"}], "+", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "3"]}]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         SubscriptBox["\[Kappa]", "3"], " ", 
         RowBox[{
          SuperscriptBox["Cq", "\[Prime]",
           MultilineFunction->None], "[", 
          SubscriptBox["q", "3"], "]"}]}], "+", 
        RowBox[{
         SubscriptBox["q", "3"], " ", 
         RowBox[{
          SuperscriptBox["P", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"], "+", 
           SubscriptBox["q", "3"]}], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8395379976889467`*^9, 3.839538199325347*^9, {3.839571253408037*^9, 
   3.8395712786517982`*^9}, 3.83957160286377*^9, 3.839571635110097*^9, 
   3.8395717470490923`*^9, 3.839593373008937*^9, 3.839593436787179*^9, 
   3.8395951002150307`*^9, 3.842050307514144*^9, 3.842050417616351*^9, 
   3.8420505154943886`*^9, {3.8420505776519327`*^9, 3.8420506054914403`*^9}, 
   3.8420506870314116`*^9, 3.8420507236350565`*^9, 3.8420507944400196`*^9, {
   3.842050853066259*^9, 3.8420508776045856`*^9}, 3.842050957037139*^9, 
   3.842051033845257*^9, 3.842051285150285*^9, 3.8420525682261224`*^9, 
   3.842052688193017*^9, 3.842054386944321*^9, 3.8420555152025156`*^9, 
   3.8420556791380634`*^9, 3.842055859801841*^9, 3.8420581533852987`*^9, 
   3.8420584887444277`*^9, 3.8420592362548885`*^9},
 CellLabel->
  "Out[1014]//TableForm=",ExpressionUUID->"e9535703-95da-4631-b913-\
06f929d6a577"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"sys", " ", "=", " ", 
  RowBox[{"sys", "/.", 
   RowBox[{
    RowBox[{
     SubscriptBox["q", "1"], "+", 
     SubscriptBox["q", "2"], "+", 
     SubscriptBox["q", "3"]}], "->", "Q"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Qdefn", "=", 
  RowBox[{"Q", "==", 
   RowBox[{
    SubscriptBox["q", "1"], "+", 
    SubscriptBox["q", "2"], "+", 
    SubscriptBox["q", "3"]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"sys", " ", "=", " ", 
  RowBox[{"Join", "[", 
   RowBox[{"sys", ",", 
    RowBox[{"{", "Qdefn", "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.842052639823124*^9, 3.8420526679093566`*^9}},
 CellLabel->
  "In[1015]:=",ExpressionUUID->"5186510f-d04f-4363-978a-544c4a39d51e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]", " ", 
     RowBox[{
      SubscriptBox["V", "1"], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"P", "[", "Q", "]"}], " ", 
      SubscriptBox["q", "1"]}], "-", 
     RowBox[{
      RowBox[{"Cq", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      SubscriptBox["\[Kappa]", "1"]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "1"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "1"]}], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "2"]}], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "3"]}]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"P", "[", "Q", "]"}], "+", 
     RowBox[{"\[Delta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "1"]}], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "-", 
     RowBox[{
      SubscriptBox["\[Kappa]", "1"], " ", 
      RowBox[{
       SuperscriptBox["Cq", "\[Prime]",
        MultilineFunction->None], "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{
      SubscriptBox["q", "1"], " ", 
      RowBox[{
       SuperscriptBox["P", "\[Prime]",
        MultilineFunction->None], "[", "Q", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"\[Rho]", " ", 
     RowBox[{
      SubscriptBox["V", "2"], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"P", "[", "Q", "]"}], " ", 
      SubscriptBox["q", "2"]}], "-", 
     RowBox[{
      RowBox[{"Cq", "[", 
       SubscriptBox["q", "2"], "]"}], " ", 
      SubscriptBox["\[Kappa]", "2"]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "1"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "1"]}], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "2"]}], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "3"]}]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"P", "[", "Q", "]"}], "+", 
     RowBox[{"\[Delta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "2"]}], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "-", 
     RowBox[{
      SubscriptBox["\[Kappa]", "2"], " ", 
      RowBox[{
       SuperscriptBox["Cq", "\[Prime]",
        MultilineFunction->None], "[", 
       SubscriptBox["q", "2"], "]"}]}], "+", 
     RowBox[{
      SubscriptBox["q", "2"], " ", 
      RowBox[{
       SuperscriptBox["P", "\[Prime]",
        MultilineFunction->None], "[", "Q", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"\[Rho]", " ", 
     RowBox[{
      SubscriptBox["V", "3"], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"P", "[", "Q", "]"}], " ", 
      SubscriptBox["q", "3"]}], "-", 
     RowBox[{
      RowBox[{"Cq", "[", 
       SubscriptBox["q", "3"], "]"}], " ", 
      SubscriptBox["\[Kappa]", "3"]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "1"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "1"]}], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "2"]}], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "3"]}]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"P", "[", "Q", "]"}], "+", 
     RowBox[{"\[Delta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "3"]}]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "-", 
     RowBox[{
      SubscriptBox["\[Kappa]", "3"], " ", 
      RowBox[{
       SuperscriptBox["Cq", "\[Prime]",
        MultilineFunction->None], "[", 
       SubscriptBox["q", "3"], "]"}]}], "+", 
     RowBox[{
      SubscriptBox["q", "3"], " ", 
      RowBox[{
       SuperscriptBox["P", "\[Prime]",
        MultilineFunction->None], "[", "Q", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.8420526886385727`*^9, 3.8420543874598055`*^9, 
  3.842055515474513*^9, 3.8420556793920584`*^9, 3.842055860063842*^9, 
  3.842058153649299*^9, 3.8420584890604286`*^9, 3.8420592367714057`*^9},
 CellLabel->
  "Out[1015]=",ExpressionUUID->"e61b178e-ff66-42dc-8f37-6a718fcbb8e4"],

Cell[BoxData[
 RowBox[{"Q", "\[Equal]", 
  RowBox[{
   SubscriptBox["q", "1"], "+", 
   SubscriptBox["q", "2"], "+", 
   SubscriptBox["q", "3"]}]}]], "Output",
 CellChangeTimes->{3.8420526886385727`*^9, 3.8420543874598055`*^9, 
  3.842055515474513*^9, 3.8420556793920584`*^9, 3.842055860063842*^9, 
  3.842058153649299*^9, 3.8420584890604286`*^9, 3.842059236834407*^9},
 CellLabel->
  "Out[1016]=",ExpressionUUID->"3b27fbd9-8813-4e11-8da1-5b07862f6e64"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]", " ", 
     RowBox[{
      SubscriptBox["V", "1"], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"P", "[", "Q", "]"}], " ", 
      SubscriptBox["q", "1"]}], "-", 
     RowBox[{
      RowBox[{"Cq", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      SubscriptBox["\[Kappa]", "1"]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "1"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "1"]}], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "2"]}], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "3"]}]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"P", "[", "Q", "]"}], "+", 
     RowBox[{"\[Delta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "1"]}], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "-", 
     RowBox[{
      SubscriptBox["\[Kappa]", "1"], " ", 
      RowBox[{
       SuperscriptBox["Cq", "\[Prime]",
        MultilineFunction->None], "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{
      SubscriptBox["q", "1"], " ", 
      RowBox[{
       SuperscriptBox["P", "\[Prime]",
        MultilineFunction->None], "[", "Q", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"\[Rho]", " ", 
     RowBox[{
      SubscriptBox["V", "2"], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"P", "[", "Q", "]"}], " ", 
      SubscriptBox["q", "2"]}], "-", 
     RowBox[{
      RowBox[{"Cq", "[", 
       SubscriptBox["q", "2"], "]"}], " ", 
      SubscriptBox["\[Kappa]", "2"]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "1"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "1"]}], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "2"]}], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "3"]}]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"P", "[", "Q", "]"}], "+", 
     RowBox[{"\[Delta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "2"]}], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "-", 
     RowBox[{
      SubscriptBox["\[Kappa]", "2"], " ", 
      RowBox[{
       SuperscriptBox["Cq", "\[Prime]",
        MultilineFunction->None], "[", 
       SubscriptBox["q", "2"], "]"}]}], "+", 
     RowBox[{
      SubscriptBox["q", "2"], " ", 
      RowBox[{
       SuperscriptBox["P", "\[Prime]",
        MultilineFunction->None], "[", "Q", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"\[Rho]", " ", 
     RowBox[{
      SubscriptBox["V", "3"], "[", 
      RowBox[{
       SubscriptBox["R", "1"], ",", 
       SubscriptBox["R", "2"], ",", 
       SubscriptBox["R", "3"]}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"P", "[", "Q", "]"}], " ", 
      SubscriptBox["q", "3"]}], "-", 
     RowBox[{
      RowBox[{"Cq", "[", 
       SubscriptBox["q", "3"], "]"}], " ", 
      SubscriptBox["\[Kappa]", "3"]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "1"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "1"]}], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "2"]}], ",", 
          SubscriptBox["R", "3"]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SubscriptBox["q", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "3"]}]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"P", "[", "Q", "]"}], "+", 
     RowBox[{"\[Delta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["R", "3"]}]}], "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "-", 
     RowBox[{
      SubscriptBox["\[Kappa]", "3"], " ", 
      RowBox[{
       SuperscriptBox["Cq", "\[Prime]",
        MultilineFunction->None], "[", 
       SubscriptBox["q", "3"], "]"}]}], "+", 
     RowBox[{
      SubscriptBox["q", "3"], " ", 
      RowBox[{
       SuperscriptBox["P", "\[Prime]",
        MultilineFunction->None], "[", "Q", "]"}]}]}]}], ",", 
   RowBox[{"Q", "\[Equal]", 
    RowBox[{
     SubscriptBox["q", "1"], "+", 
     SubscriptBox["q", "2"], "+", 
     SubscriptBox["q", "3"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.8420526886385727`*^9, 3.8420543874598055`*^9, 
  3.842055515474513*^9, 3.8420556793920584`*^9, 3.842055860063842*^9, 
  3.842058153649299*^9, 3.8420584890604286`*^9, 3.8420592369084034`*^9},
 CellLabel->
  "Out[1017]=",ExpressionUUID->"6d4bcffe-ebb5-4cda-b212-c00a51e21c19"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"diff", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"sys", "/.", 
      RowBox[{
       RowBox[{"zz__", "\[Equal]", "yy__"}], " ", "\[Rule]", " ", 
       RowBox[{"zz", "-", "yy"}]}]}], ")"}], "//", "Simplify"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.830356855940383*^9, 3.830356867968957*^9}, {
  3.830386483072104*^9, 3.830386484551075*^9}, {3.839537465987817*^9, 
  3.839537497562606*^9}, {3.839538036196555*^9, 3.8395380381948223`*^9}},
 CellLabel->
  "In[1018]:=",ExpressionUUID->"a6cb7c60-b214-436c-b508-bb79cf44cc4d"],

Cell[TextData[{
 "diff is the system of expressions which should be set equal to zero.\nFor \
two firms:\n",
 StyleBox["Unknowns:",
  FontWeight->"Bold"],
 " { ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "1"], TraditionalForm]],ExpressionUUID->
  "964cd27f-3334-4cec-ba16-0fbd369003b6"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "2"], TraditionalForm]],ExpressionUUID->
  "e6c858d3-c91c-4dd1-9aec-2aa447afc322"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["V", "1"], "[", 
   RowBox[{
    SubscriptBox["R", "1"], ",", 
    SubscriptBox["R", "2"]}], "]"}]],
  CellChangeTimes->{3.839537505243342*^9},ExpressionUUID->
  "b22fc560-2ca1-4575-9dce-da068daba88b"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["V", "2"], "[", 
   RowBox[{
    SubscriptBox["R", "1"], ",", 
    SubscriptBox["R", "2"]}], "]"}]],
  CellChangeTimes->{3.839537505243342*^9},ExpressionUUID->
  "6c8a6157-40ba-4319-9ae8-8844a6702c45"],
 "}\n",
 StyleBox["Special cases:",
  FontSize->16,
  FontWeight->"Bold"],
 " If ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["R", "1"], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "3598fcdf-5875-46a2-91fc-90adfba57527"],
 ", then set \[Delta]=0 in equations 1 and 2. If ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["R", "2"], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "7782746a-c84e-4df1-a6bd-e4ab3c14f2e7"],
 ", set \[Delta]=0 in equations 3 and 4. Etc. for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "3"], TraditionalForm]],ExpressionUUID->
  "4b934bd7-a7ed-4d4f-b59c-12a716cd9c7b"],
 ", ..."
}], "Text",
 CellChangeTimes->{{3.839537549129982*^9, 3.839537638820917*^9}, {
  3.839537681055603*^9, 3.839537752634803*^9}, {3.8395377878340387`*^9, 
  3.839537801098041*^9}, {3.839537865642602*^9, 3.839537907202026*^9}, {
  3.839538225907895*^9, 3.8395382369155283`*^9}, {3.8395935887051163`*^9, 
  3.839593668243828*^9}},ExpressionUUID->"2ad01487-2f56-420b-be92-\
69c765e5f9e6"],

Cell["It may be easier to write diff as", "Text",
 CellChangeTimes->{{3.8395935104613113`*^9, 
  3.8395935201385317`*^9}},ExpressionUUID->"db618888-00c7-4afd-9ef3-\
bdd99395b649"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"diff", "=", 
   RowBox[{"%", "/.", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "+", 
      SubscriptBox["q", "2"], "+", 
      SubscriptBox["q", "3"]}], "->", "Q"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.83957177219737*^9, 3.839571787227886*^9}, {
  3.8395935043959913`*^9, 3.839593505010962*^9}},
 CellLabel->
  "In[1019]:=",ExpressionUUID->"2091f88d-3d70-4b14-a504-4df00c6ea362"],

Cell["and add the equation", "Text",
 CellChangeTimes->{{3.839593527674267*^9, 
  3.839593529825693*^9}},ExpressionUUID->"425dbc89-8202-4a13-b43d-\
d58bfbab5aad"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Qdefn", "=", 
   RowBox[{"Q", "==", 
    RowBox[{
     SubscriptBox["q", "1"], "+", 
     SubscriptBox["q", "2"], "+", 
     SubscriptBox["q", "3"]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.839593536242943*^9, 3.839593558145137*^9}},
 CellLabel->
  "In[1020]:=",ExpressionUUID->"d9b78355-2c9d-4fb1-b644-87d30aef0d23"],

Cell["We form the equations for the general case", "Text",
 CellChangeTimes->{{3.8395951108464813`*^9, 
  3.839595121254486*^9}},ExpressionUUID->"4797434d-fc86-4af5-99c9-\
f0f1ea4efb7b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"diffQGeneral", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"diff", ",", 
     RowBox[{"{", "Qdefn", "}"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.83959369114887*^9, 3.839593713714225*^9}, {
  3.839595091600175*^9, 3.839595092607266*^9}},
 CellLabel->
  "In[1021]:=",ExpressionUUID->"b8759099-fc84-4ab3-92cc-a515b9a42540"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cases", "Subtitle",
 CellChangeTimes->{{3.839595145573308*^9, 
  3.839595147542694*^9}},ExpressionUUID->"dcaf0cc9-f212-4243-997d-\
0143e944ddfb"],

Cell[CellGroupData[{

Cell["Parameters", "Section",
 CellChangeTimes->{{3.839571307165144*^9, 
  3.8395713088047237`*^9}},ExpressionUUID->"ac37072d-524f-49f4-8810-\
4432ed3ca539"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]", "=", 
   RowBox[{"1", "/", "20"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"9", "/", "10"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Delta]", "=", 
   RowBox[{"1", "/", "10"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"1", ";"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8395713135782223`*^9, 3.839571375538913*^9}, {
  3.839571413385816*^9, 3.839571417937009*^9}, {3.839571528501747*^9, 
  3.8395715288932858`*^9}, {3.842055580283321*^9, 3.8420556017302113`*^9}},
 CellLabel->
  "In[1022]:=",ExpressionUUID->"229d588e-add3-42da-891f-65c72f56c31f"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Kappa]", "i"], "=", "i"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "numfirms"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.83957148575945*^9, 3.839571501797821*^9}},
 CellLabel->
  "In[1023]:=",ExpressionUUID->"a1d4977e-bf1c-44f0-b21b-dab7a3db47eb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"diffQGeneral", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.839571401660584*^9, 3.839571403938506*^9}, 
   3.839594235571123*^9, {3.839595169805704*^9, 3.839595170301374*^9}},
 CellLabel->
  "In[1024]:=",ExpressionUUID->"8b9ce7c1-133e-4c23-9550-dc0c32501ae8"],

Cell[BoxData[
 TagBox["diffQGeneral",
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.839571404727068*^9, 3.839571424644867*^9}, 
   3.839571504718186*^9, 3.8395715388988667`*^9, 3.839571647572667*^9, {
   3.8395942311568193`*^9, 3.839594236080497*^9}, 3.8395951744169083`*^9, 
   3.842050308754139*^9, 3.842050418696597*^9, 3.8420505168460236`*^9, {
   3.8420505788953905`*^9, 3.842050606612443*^9}, 3.8420506882054076`*^9, 
   3.8420507249290557`*^9, 3.84205079580002*^9, {3.8420508545641747`*^9, 
   3.8420508792393537`*^9}, 3.8420509584516325`*^9, 3.842051035592432*^9, 
   3.842051286860713*^9, 3.8420525701313925`*^9, 3.842052689511684*^9, 
   3.8420543884508057`*^9, 3.842055516474512*^9, 3.8420556804079638`*^9, 
   3.842055860918827*^9, 3.8420581546192617`*^9, 3.842058490052992*^9, 
   3.8420592379758406`*^9},
 CellLabel->
  "Out[1024]//TableForm=",ExpressionUUID->"94a87cdb-12c3-4d31-839d-\
049b4f2875b3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functional Forms", "Section",ExpressionUUID->"b54ba43a-bf57-4769-ab35-c197e411a0e3"],

Cell[CellGroupData[{

Cell["Quadratic case", "Subsection",
 CellChangeTimes->{{3.830355388446383*^9, 3.8303553931300907`*^9}, {
  3.839594961020739*^9, 
  3.839594963252143*^9}},ExpressionUUID->"bea5cb1c-b8fd-41db-8e4c-\
a66e3bc40581"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"P", "[", "z_", "]"}], "=", 
  RowBox[{"A", "-", 
   RowBox[{"z", "/", "Pop"}]}]}]], "Input",
 CellChangeTimes->{{3.829693031167596*^9, 3.829693077370636*^9}, {
  3.8303557509421186`*^9, 3.830355752067505*^9}},
 CellLabel->
  "In[1025]:=",ExpressionUUID->"eae0e340-a16c-4576-b58b-3dfbdf93d503"],

Cell[BoxData[
 RowBox[{"A", "-", 
  FractionBox["z", "Pop"]}]], "Output",
 CellChangeTimes->{
  3.8302623955359287`*^9, 3.83026246857475*^9, 3.830355294975411*^9, 
   3.830355395340651*^9, 3.8303557703266363`*^9, 3.830355929303342*^9, 
   3.8303565454157963`*^9, 3.830380988934835*^9, {3.830381385267852*^9, 
   3.830381402395863*^9}, 3.830382601303473*^9, 3.83038654108576*^9, 
   3.830872679254829*^9, 3.831388298372099*^9, 3.8313984255381927`*^9, 
   3.83946628386761*^9, 3.839521745384564*^9, 3.839528916424191*^9, 
   3.839530418429165*^9, 3.839531356717952*^9, 3.8395330373406982`*^9, {
   3.83953368990018*^9, 3.839533697895719*^9}, 3.839533865833516*^9, 
   3.839537265772217*^9, 3.839538199073522*^9, 3.83957118205917*^9, 
   3.8395942444930964`*^9, 3.83959517870406*^9, 3.842050308952142*^9, 
   3.8420504188775964`*^9, 3.842050517142023*^9, {3.8420505791803913`*^9, 
   3.842050606812437*^9}, 3.8420506883784037`*^9, 3.842050725213053*^9, 
   3.8420507960138073`*^9, {3.8420508548211765`*^9, 3.842050879519349*^9}, 
   3.84205095866263*^9, 3.8420510358134313`*^9, 3.842051287110713*^9, 
   3.842052570408391*^9, 3.8420526897736835`*^9, 3.842054388711379*^9, 
   3.842055516710513*^9, 3.842055680712963*^9, 3.8420558611368294`*^9, 
   3.842058154900262*^9, 3.84205849036499*^9, 3.842059238358838*^9},
 CellLabel->
  "Out[1025]=",ExpressionUUID->"cc97cdde-c9cd-4782-a22a-afd3c9fe0788"]
}, Open  ]],

Cell["Pop is a population parameter. Keep it simple.", "Text",
 CellChangeTimes->{{3.38912732975*^9, 3.389127332578125*^9}, {
  3.829504720668602*^9, 3.82950472409275*^9}, {3.830355754930484*^9, 
  3.830355755898591*^9}},ExpressionUUID->"98ac4e8e-8df8-487e-988c-\
c44cf86b04dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pop", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.829504726624682*^9, 3.82950472878806*^9}, {
  3.830355758340262*^9, 3.83035575936325*^9}},
 CellLabel->
  "In[1026]:=",ExpressionUUID->"75fbb3ef-04e8-458e-b3f5-ea55c6c63b2d"],

Cell["A is the choke price. Keep it simple.", "Text",
 CellChangeTimes->{{3.38912732975*^9, 3.389127332578125*^9}, {
  3.829504720668602*^9, 3.82950472409275*^9}, {3.8295060840132017`*^9, 
  3.82950608668356*^9}},ExpressionUUID->"a16426f8-fa40-4593-9645-\
c322348a2e2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.829504726624682*^9, 3.82950472878806*^9}, {
  3.829506088916646*^9, 3.829506089475374*^9}},
 CellLabel->
  "In[1027]:=",ExpressionUUID->"4010533b-c8ed-4f62-aa06-d3cf75c43cbe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cq", "[", "x_", "]"}], "=", " ", 
   RowBox[{
    SuperscriptBox["x", "2"], "/", "2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.388018495338378*^9, 3.388018499233979*^9}, {
  3.8295047052228823`*^9, 3.829504709092967*^9}, {3.82952692642793*^9, 
  3.829526929770698*^9}, {3.830355425070822*^9, 3.8303554303490047`*^9}, {
  3.8395226952487183`*^9, 3.839522712622561*^9}, {3.839531347295516*^9, 
  3.839531347806488*^9}, {3.839533728190839*^9, 3.839533728342346*^9}, {
  3.839594264047084*^9, 3.839594265078505*^9}},
 CellLabel->
  "In[1028]:=",ExpressionUUID->"447c06b0-9d1f-4a42-8b5a-93cba44147fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sys", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.839594275516222*^9, 3.839594293854746*^9}, {
  3.839595185212315*^9, 3.83959518566887*^9}, {3.8420510283433*^9, 
  3.842051029058673*^9}},
 CellLabel->
  "In[1029]:=",ExpressionUUID->"a097cd31-0168-43a5-b719-14c2f1f8b8fa"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{
        FractionBox["1", "20"], " ", 
        RowBox[{
         SubscriptBox["V", "1"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "Q"}], ")"}], " ", 
         SubscriptBox["q", "1"]}], "-", 
        FractionBox[
         SubsuperscriptBox["q", "1", "2"], "2"], "+", 
        RowBox[{
         FractionBox["1", "10"], " ", 
         SubscriptBox["q", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "1"]}], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "10"], " ", 
         SubscriptBox["q", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "2"]}], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "10"], " ", 
         SubscriptBox["q", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "3"]}]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{"1", "-", "Q", "-", 
        RowBox[{"2", " ", 
         SubscriptBox["q", "1"]}], "+", 
        RowBox[{
         FractionBox["1", "10"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "1"]}], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "1"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        FractionBox["1", "20"], " ", 
        RowBox[{
         SubscriptBox["V", "2"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "Q"}], ")"}], " ", 
         SubscriptBox["q", "2"]}], "-", 
        SubsuperscriptBox["q", "2", "2"], "+", 
        RowBox[{
         FractionBox["1", "10"], " ", 
         SubscriptBox["q", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "1"]}], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "10"], " ", 
         SubscriptBox["q", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "2"]}], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "10"], " ", 
         SubscriptBox["q", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "3"]}]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{"1", "-", "Q", "-", 
        RowBox[{"3", " ", 
         SubscriptBox["q", "2"]}], "+", 
        RowBox[{
         FractionBox["1", "10"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "2"]}], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "2"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        FractionBox["1", "20"], " ", 
        RowBox[{
         SubscriptBox["V", "3"], "[", 
         RowBox[{
          SubscriptBox["R", "1"], ",", 
          SubscriptBox["R", "2"], ",", 
          SubscriptBox["R", "3"]}], "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "Q"}], ")"}], " ", 
         SubscriptBox["q", "3"]}], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SubsuperscriptBox["q", "3", "2"]}], "2"], "+", 
        RowBox[{
         FractionBox["1", "10"], " ", 
         SubscriptBox["q", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "1"]}], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "10"], " ", 
         SubscriptBox["q", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "2"]}], ",", 
             SubscriptBox["R", "3"]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "10"], " ", 
         SubscriptBox["q", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "3"]}]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{"0", "\[Equal]", 
       RowBox[{"1", "-", "Q", "-", 
        RowBox[{"4", " ", 
         SubscriptBox["q", "3"]}], "+", 
        RowBox[{
         FractionBox["1", "10"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["R", "3"]}]}], "]"}], "-", 
           RowBox[{
            SubscriptBox["V", "3"], "[", 
            RowBox[{
             SubscriptBox["R", "1"], ",", 
             SubscriptBox["R", "2"], ",", 
             SubscriptBox["R", "3"]}], "]"}]}], ")"}]}]}]}]},
     {
      RowBox[{"Q", "\[Equal]", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"], "+", 
        SubscriptBox["q", "3"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.839594277473947*^9, 3.8395942944701777`*^9}, 
   3.8395948378159857`*^9, 3.839595186236904*^9, 3.842050309370143*^9, 
   3.842050419113598*^9, 3.8420505175018125`*^9, {3.8420505795173903`*^9, 
   3.842050607211296*^9}, 3.8420506887894044`*^9, 3.8420507255604353`*^9, 
   3.842050796424805*^9, {3.842050855484753*^9, 3.8420508800773525`*^9}, 
   3.8420509590250998`*^9, {3.8420510363184366`*^9, 3.842051074559351*^9}, 
   3.8420512875291605`*^9, 3.8420525711593933`*^9, 3.842052690147682*^9, 
   3.8420543894083776`*^9, 3.8420555174530015`*^9, 3.8420556814209623`*^9, 
   3.842055861828826*^9, 3.842058155584261*^9, 3.842058491255992*^9, 
   3.8420592395267887`*^9},
 CellLabel->
  "Out[1029]//TableForm=",ExpressionUUID->"d3aeab0d-81d1-4573-86d6-\
7385bc0f52a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"asSolvableSys", " ", "=", " ", 
   RowBox[{"sys", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], " ", "\[Rule]", " ", "x"}], ",", " ", 
      RowBox[{
       SubscriptBox["q", "2"], "\[Rule]", " ", "y"}], ",", " ", 
      RowBox[{
       SubscriptBox["q", "3"], "\[Rule]", " ", "z"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "1"], "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["R", "1"]}], ",", 
         SubscriptBox["R", "2"], ",", 
         SubscriptBox["R", "3"]}], "]"}], " ", "\[Rule]", " ", 
       RowBox[{"1.99987984994079", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "7"}]}]}]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "1"], "[", 
        RowBox[{
         SubscriptBox["R", "1"], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["R", "2"]}], ",", 
         SubscriptBox["R", "3"]}], "]"}], " ", "\[Rule]", 
       "1.71432948057044"}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "1"], "[", 
        RowBox[{
         SubscriptBox["R", "1"], ",", 
         SubscriptBox["R", "2"], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["R", "3"]}]}], "]"}], " ", "\[Rule]", " ", 
       "1.64986082107554"}], ",", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "2"], "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["R", "1"]}], ",", 
         SubscriptBox["R", "2"], ",", 
         SubscriptBox["R", "3"]}], "]"}], "\[Rule]", " ", 
       "1.38769260151422"}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "2"], "[", 
        RowBox[{
         SubscriptBox["R", "1"], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["R", "2"]}], ",", 
         SubscriptBox["R", "3"]}], "]"}], "\[Rule]", " ", 
       RowBox[{"1.9998756092406", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "7"}]}]}]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "2"], "[", 
        RowBox[{
         SubscriptBox["R", "1"], ",", 
         SubscriptBox["R", "2"], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["R", "3"]}]}], "]"}], "\[Rule]", " ", 
       "1.259988794655"}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "3"], "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["R", "1"]}], ",", 
         SubscriptBox["R", "2"], ",", 
         SubscriptBox["R", "3"]}], "]"}], "\[Rule]", " ", 
       "1.12288365837099"}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "3"], "[", 
        RowBox[{
         SubscriptBox["R", "1"], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["R", "2"]}], ",", 
         SubscriptBox["R", "3"]}], "]"}], "\[Rule]", "1.0608638123511"}], " ",
       ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "3"], "[", 
        RowBox[{
         SubscriptBox["R", "1"], ",", 
         SubscriptBox["R", "2"], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["R", "3"]}]}], "]"}], "\[Rule]", " ", 
       RowBox[{"1.99987372159487", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "7"}]}]}]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "1"], "[", 
        RowBox[{
         SubscriptBox["R", "1"], ",", 
         SubscriptBox["R", "2"], ",", 
         SubscriptBox["R", "3"]}], "]"}], "\[Rule]", " ", "a"}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "2"], "[", 
        RowBox[{
         SubscriptBox["R", "1"], ",", 
         SubscriptBox["R", "2"], ",", 
         SubscriptBox["R", "3"]}], "]"}], "\[Rule]", " ", "b"}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "3"], "[", 
        RowBox[{
         SubscriptBox["R", "1"], ",", 
         SubscriptBox["R", "2"], ",", 
         SubscriptBox["R", "3"]}], "]"}], "\[Rule]", " ", "c"}]}], "}"}]}]}], 
  RowBox[{"(*", 
   RowBox[{"//", "Simplify"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{"asSolvableSys", ",", 
    RowBox[{"{", 
     RowBox[{
     "x", ",", "y", ",", "z", ",", "a", ",", "b", ",", "c", ",", "Q"}], "}"}],
     ",", "PositiveReals"}], "]"}], "//", "N"}], "\[IndentingNewLine]", 
 RowBox[{"FindMinimum", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"tol", ",", 
     RowBox[{
      RowBox[{"asSolvableSys", "/.", 
       RowBox[{
        RowBox[{"a__", "\[Equal]", "b__"}], " ", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "-", 
            RowBox[{"(", "b", ")"}]}], "<", "tol"}], ",", 
          RowBox[{
           RowBox[{"b", "-", 
            RowBox[{"(", "a", ")"}]}], "<", "tol"}]}], "}"}]}]}], "//", 
      "Flatten"}], ",", 
     RowBox[{"x", ">", "0"}], ",", 
     RowBox[{"y", ">", "0"}], ",", 
     RowBox[{"z", ">", "0"}], ",", 
     RowBox[{"a", ">", "0"}], ",", 
     RowBox[{"b", ">", "0"}], ",", 
     RowBox[{"c", ">", "0"}], ",", 
     RowBox[{"Q", ">", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "tol", ",", "x", ",", "y", ",", "z", ",", "a", ",", "b", ",", "c", ",", 
     "Q"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.842050364455704*^9, 3.8420504063055105`*^9}, {
   3.8420504578076253`*^9, 3.8420504967543383`*^9}, {3.8420505603021793`*^9, 
   3.8420506011040297`*^9}, {3.842050635437504*^9, 3.8420507191709623`*^9}, {
   3.8420507641408854`*^9, 3.8420507877309294`*^9}, {3.8420508328385086`*^9, 
   3.8420508722603207`*^9}, {3.842050929267831*^9, 3.842050943822029*^9}, {
   3.8420510447178173`*^9, 3.842051069719041*^9}, {3.842051197531358*^9, 
   3.842051280683505*^9}, {3.842051318163437*^9, 3.842051323530449*^9}, {
   3.842051366053993*^9, 3.8420513677519693`*^9}, {3.842055256302303*^9, 
   3.8420552651394434`*^9}, {3.842055307607397*^9, 3.8420553080523987`*^9}, {
   3.842055339635339*^9, 3.842055508654788*^9}, {3.842055841327402*^9, 
   3.8420558532521453`*^9}, 3.8420584819435368`*^9, {3.842059151793324*^9, 
   3.842059227195469*^9}},
 CellLabel->
  "In[1030]:=",ExpressionUUID->"2170fc72-5007-428a-b92e-ed117d48d408"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["a", "20"], "\[Equal]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "10"], " ", 
      RowBox[{"(", 
       RowBox[{"1.9998798499407898`*^-7", "-", "a"}], ")"}], " ", "x"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "Q"}], ")"}], " ", "x"}], "-", 
     FractionBox[
      SuperscriptBox["x", "2"], "2"], "+", 
     RowBox[{
      FractionBox["1", "10"], " ", 
      RowBox[{"(", 
       RowBox[{"1.71432948057044`", "\[VeryThinSpace]", "-", "a"}], ")"}], 
      " ", "y"}], "+", 
     RowBox[{
      FractionBox["1", "10"], " ", 
      RowBox[{"(", 
       RowBox[{"1.64986082107554`", "\[VeryThinSpace]", "-", "a"}], ")"}], 
      " ", "z"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"1.9998798499407898`*^-7", "-", "a"}], "10"], "-", "Q", "-", 
     RowBox[{"2", " ", "x"}]}]}], ",", 
   RowBox[{
    FractionBox["b", "20"], "\[Equal]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "10"], " ", 
      RowBox[{"(", 
       RowBox[{"1.38769260151422`", "\[VeryThinSpace]", "-", "b"}], ")"}], 
      " ", "x"}], "+", 
     RowBox[{
      FractionBox["1", "10"], " ", 
      RowBox[{"(", 
       RowBox[{"1.9998756092406`*^-7", "-", "b"}], ")"}], " ", "y"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "Q"}], ")"}], " ", "y"}], "-", 
     SuperscriptBox["y", "2"], "+", 
     RowBox[{
      FractionBox["1", "10"], " ", 
      RowBox[{"(", 
       RowBox[{"1.259988794655`", "\[VeryThinSpace]", "-", "b"}], ")"}], " ", 
      "z"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"1.9998756092406`*^-7", "-", "b"}], "10"], "-", "Q", "-", 
     RowBox[{"3", " ", "y"}]}]}], ",", 
   RowBox[{
    FractionBox["c", "20"], "\[Equal]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "10"], " ", 
      RowBox[{"(", 
       RowBox[{"1.12288365837099`", "\[VeryThinSpace]", "-", "c"}], ")"}], 
      " ", "x"}], "+", 
     RowBox[{
      FractionBox["1", "10"], " ", 
      RowBox[{"(", 
       RowBox[{"1.0608638123511`", "\[VeryThinSpace]", "-", "c"}], ")"}], " ",
       "y"}], "+", 
     RowBox[{
      FractionBox["1", "10"], " ", 
      RowBox[{"(", 
       RowBox[{"1.99987372159487`*^-7", "-", "c"}], ")"}], " ", "z"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "Q"}], ")"}], " ", "z"}], "-", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["z", "2"]}], "2"]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"1.99987372159487`*^-7", "-", "c"}], "10"], "-", "Q", "-", 
     RowBox[{"4", " ", "z"}]}]}], ",", 
   RowBox[{"Q", "\[Equal]", 
    RowBox[{"x", "+", "y", "+", "z"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8420504068385115`*^9, 3.842050419299598*^9}, 
   3.8420505177528133`*^9, {3.8420505797803907`*^9, 3.842050607438946*^9}, 
   3.8420506890374055`*^9, 3.842050725798436*^9, 3.842050796665806*^9, {
   3.842050855801753*^9, 3.842050880478286*^9}, 3.8420509592951007`*^9, {
   3.8420510365534325`*^9, 3.842051074846349*^9}, 3.84205128781616*^9, 
   3.842051327306659*^9, 3.8420513718840575`*^9, 3.84205257172639*^9, 
   3.8420526906642213`*^9, 3.842054390407379*^9, 3.8420555177619467`*^9, 
   3.8420556816549683`*^9, 3.8420558620908318`*^9, 3.8420581558522615`*^9, 
   3.842058491575992*^9, 3.8420592399637885`*^9},
 CellLabel->
  "Out[1030]=",ExpressionUUID->"d76d1cd8-21fe-4ded-9c18-59ad2ccfd0c9"],

Cell[BoxData[
 TemplateBox[{
  "Solve","ratnz",
   "\"Solve was unable to solve the system with inexact coefficients. The \
answer was obtained by solving a corresponding exact system and numericizing \
the result.\"",2,1031,13,17545688972029122995,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8420555178064747`*^9, 3.842055681900963*^9, 
  3.842055862135827*^9, 3.842058155900263*^9, 3.8420584916259937`*^9, 
  3.842059240081791*^9},
 CellLabel->
  "During evaluation of \
In[1030]:=",ExpressionUUID->"7b00c84c-5854-4c49-9ec4-78d345c90d97"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "\[Rule]", "0.20106422859739165`"}], ",", 
    RowBox[{"y", "\[Rule]", "0.14530232806542662`"}], ",", 
    RowBox[{"z", "\[Rule]", "0.11406305605211818`"}], ",", 
    RowBox[{"a", "\[Rule]", "1.3744195008907842`"}], ",", 
    RowBox[{"b", "\[Rule]", "1.0366342308753973`"}], ",", 
    RowBox[{"c", "\[Rule]", "0.8331818307532785`"}], ",", 
    RowBox[{"Q", "\[Rule]", "0.4604296127149365`"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.8420504068385115`*^9, 3.842050419299598*^9}, 
   3.8420505177528133`*^9, {3.8420505797803907`*^9, 3.842050607438946*^9}, 
   3.8420506890374055`*^9, 3.842050725798436*^9, 3.842050796665806*^9, {
   3.842050855801753*^9, 3.842050880478286*^9}, 3.8420509592951007`*^9, {
   3.8420510365534325`*^9, 3.842051074846349*^9}, 3.84205128781616*^9, 
   3.842051327306659*^9, 3.8420513718840575`*^9, 3.84205257172639*^9, 
   3.8420526906642213`*^9, 3.842054390407379*^9, 3.8420555177619467`*^9, 
   3.8420556816549683`*^9, 3.8420558620908318`*^9, 3.8420581558522615`*^9, 
   3.842058491575992*^9, 3.842059240156787*^9},
 CellLabel->
  "Out[1031]=",ExpressionUUID->"c74b638a-150f-4d1a-8e4f-e3750ed5652c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.262389300322565`*^-6", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"tol", "\[Rule]", "1.262389300322565`*^-6"}], ",", 
     RowBox[{"x", "\[Rule]", "0.20106421929176543`"}], ",", 
     RowBox[{"y", "\[Rule]", "0.14530230112209172`"}], ",", 
     RowBox[{"z", "\[Rule]", "0.11406320045251438`"}], ",", 
     RowBox[{"a", "\[Rule]", "1.374418587458977`"}], ",", 
     RowBox[{"b", "\[Rule]", "1.0366339315894475`"}], ",", 
     RowBox[{"c", "\[Rule]", "0.8331748723550523`"}], ",", 
     RowBox[{"Q", "\[Rule]", "0.46042972241828467`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8420504068385115`*^9, 3.842050419299598*^9}, 
   3.8420505177528133`*^9, {3.8420505797803907`*^9, 3.842050607438946*^9}, 
   3.8420506890374055`*^9, 3.842050725798436*^9, 3.842050796665806*^9, {
   3.842050855801753*^9, 3.842050880478286*^9}, 3.8420509592951007`*^9, {
   3.8420510365534325`*^9, 3.842051074846349*^9}, 3.84205128781616*^9, 
   3.842051327306659*^9, 3.8420513718840575`*^9, 3.84205257172639*^9, 
   3.8420526906642213`*^9, 3.842054390407379*^9, 3.8420555177619467`*^9, 
   3.8420556816549683`*^9, 3.8420558620908318`*^9, 3.8420581558522615`*^9, 
   3.842058491575992*^9, 3.8420592402237873`*^9},
 CellLabel->
  "Out[1032]=",ExpressionUUID->"6dde5b8a-f909-4ea4-af97-b544426dd168"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["CES demand case", "Subsection",
 CellChangeTimes->{{3.830355388446383*^9, 3.8303553931300907`*^9}, {
  3.839594961020739*^9, 3.839594963252143*^9}, {3.8395950059143677`*^9, 
  3.839595007522417*^9}, {3.8395952018436613`*^9, 
  3.839595204259419*^9}},ExpressionUUID->"d0f37056-17fe-4f16-998a-\
176ee4759b4d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"P", "[", "z_", "]"}], "=", 
   SuperscriptBox["z", 
    RowBox[{"-", "\[Eta]"}]]}], "*)"}]], "Input",
 CellChangeTimes->{{3.829693031167596*^9, 3.829693077370636*^9}, {
  3.8303557509421186`*^9, 3.830355752067505*^9}, {3.839595014602722*^9, 
  3.839595021829722*^9}},
 CellLabel->
  "In[1033]:=",ExpressionUUID->"53df4393-d8dc-42a4-ba01-2d02861fe7f2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Cq", "[", "x_", "]"}], "=", " ", 
    RowBox[{
     SuperscriptBox["x", "2"], "/", "2"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.388018495338378*^9, 3.388018499233979*^9}, {
  3.8295047052228823`*^9, 3.829504709092967*^9}, {3.82952692642793*^9, 
  3.829526929770698*^9}, {3.830355425070822*^9, 3.8303554303490047`*^9}, {
  3.8395226952487183`*^9, 3.839522712622561*^9}, {3.839531347295516*^9, 
  3.839531347806488*^9}, {3.839533728190839*^9, 3.839533728342346*^9}, {
  3.839594264047084*^9, 3.839594265078505*^9}},
 CellLabel->
  "In[1034]:=",ExpressionUUID->"0fd78211-efeb-45df-b3f4-639a7a701fed"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"diffQGeneral", "//", "TableForm"}], "*)"}]], "Input",
 CellChangeTimes->{{3.839594275516222*^9, 3.839594293854746*^9}, {
  3.839595194852006*^9, 3.839595195148303*^9}},
 CellLabel->
  "In[1035]:=",ExpressionUUID->"1ca0b015-fad9-4765-b75a-45108e044685"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CES cost case", "Subsection",
 CellChangeTimes->{{3.830355388446383*^9, 3.8303553931300907`*^9}, {
  3.839594961020739*^9, 3.839594963252143*^9}, {3.8395950059143677`*^9, 
  3.839595007522417*^9}, {3.8395952018436613`*^9, 3.839595204259419*^9}, {
  3.839595252842247*^9, 
  3.839595253321233*^9}},ExpressionUUID->"34ccb41c-54ca-433b-a895-\
c4331145c5f3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"P", "[", "z_", "]"}], "=", 
   RowBox[{"1", "-", "z"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.829693031167596*^9, 3.829693077370636*^9}, {
  3.8303557509421186`*^9, 3.830355752067505*^9}, {3.839595265657646*^9, 
  3.839595267945513*^9}},
 CellLabel->
  "In[1036]:=",ExpressionUUID->"827520df-270c-4bef-8b37-9820ed0b7d20"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Cq", "[", "x_", "]"}], "=", " ", 
    SuperscriptBox["x", "\[Mu]"]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.388018495338378*^9, 3.388018499233979*^9}, {
  3.8295047052228823`*^9, 3.829504709092967*^9}, {3.82952692642793*^9, 
  3.829526929770698*^9}, {3.830355425070822*^9, 3.8303554303490047`*^9}, {
  3.8395226952487183`*^9, 3.839522712622561*^9}, {3.839531347295516*^9, 
  3.839531347806488*^9}, {3.839533728190839*^9, 3.839533728342346*^9}, {
  3.839594264047084*^9, 3.839594265078505*^9}, {3.839595276913259*^9, 
  3.839595287002596*^9}},
 CellLabel->
  "In[1037]:=",ExpressionUUID->"3a8dadb2-d66e-4944-9d86-f1c7532db42d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"diffQGeneral", "//", "TableForm"}], "*)"}]], "Input",
 CellChangeTimes->{{3.839594275516222*^9, 3.839594293854746*^9}, {
  3.839595194852006*^9, 3.839595195148303*^9}},
 CellLabel->
  "In[1038]:=",ExpressionUUID->"60262eaa-9b3e-4e28-a932-e6e3aec9a419"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CES demand and cost case", "Subsection",
 CellChangeTimes->{{3.830355388446383*^9, 3.8303553931300907`*^9}, {
  3.839594961020739*^9, 3.839594963252143*^9}, {3.8395950059143677`*^9, 
  3.839595007522417*^9}, {3.8395952018436613`*^9, 3.839595204259419*^9}, {
  3.8395953055914593`*^9, 
  3.8395953065514307`*^9}},ExpressionUUID->"4a9de550-9ed9-4b34-8ddc-\
ef35b299ae08"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"P", "[", "z_", "]"}], "=", 
    SuperscriptBox["z", 
     RowBox[{"-", "\[Eta]"}]]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.829693031167596*^9, 3.829693077370636*^9}, {
  3.8303557509421186`*^9, 3.830355752067505*^9}, {3.839595014602722*^9, 
  3.839595021829722*^9}, {3.8395953203195047`*^9, 3.839595324319293*^9}},
 CellLabel->
  "In[1039]:=",ExpressionUUID->"5f9cbcd1-2611-4d66-92cb-aa224285868b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Cq", "[", "x_", "]"}], "=", " ", 
    SuperscriptBox["x", "\[Mu]"]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.388018495338378*^9, 3.388018499233979*^9}, {
  3.8295047052228823`*^9, 3.829504709092967*^9}, {3.82952692642793*^9, 
  3.829526929770698*^9}, {3.830355425070822*^9, 3.8303554303490047`*^9}, {
  3.8395226952487183`*^9, 3.839522712622561*^9}, {3.839531347295516*^9, 
  3.839531347806488*^9}, {3.839533728190839*^9, 3.839533728342346*^9}, {
  3.839594264047084*^9, 3.839594265078505*^9}, {3.839595276913259*^9, 
  3.839595287002596*^9}},
 CellLabel->
  "In[1040]:=",ExpressionUUID->"6f180b87-2eba-4916-96bb-5e6f539a996b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"diffQGeneral", "//", "TableForm"}], "*)"}]], "Input",
 CellChangeTimes->{{3.839594275516222*^9, 3.839594293854746*^9}, {
  3.839595194852006*^9, 3.839595195148303*^9}},
 CellLabel->
  "In[1041]:=",ExpressionUUID->"9ce006e0-ece6-4e19-83b7-77425c726a52"],

Cell[BoxData[
 RowBox[{"(*", "*)"}]], "Input",
 CellChangeTimes->{{3.8420503166479616`*^9, 3.8420503231691685`*^9}},
 CellLabel->
  "In[1042]:=",ExpressionUUID->"e33113e1-907e-4e5e-ae61-4f974bef6fe1"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1139, 1015},
WindowMargins->{{Automatic, -1}, {Automatic, 5}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 495, 7, 96, "Title",ExpressionUUID->"248cfd5b-c83c-4c3c-93eb-33aa743e83ea"],
Cell[CellGroupData[{
Cell[1100, 33, 314, 8, 28, "Input",ExpressionUUID->"1a233bd4-a822-45ff-b9f9-fad9430d8caa"],
Cell[1417, 43, 1569, 25, 32, "Output",ExpressionUUID->"1365759a-a6da-4ae0-b6f6-ebc15f6730c3"]
}, Open  ]],
Cell[3001, 71, 422, 8, 28, "Input",ExpressionUUID->"907b9b4d-a2f6-463b-a687-2fc606431ccb"],
Cell[CellGroupData[{
Cell[3448, 83, 206, 4, 67, "Section",ExpressionUUID->"ef9a1ad2-05c5-4009-912f-fcb0f8d55e37"],
Cell[3657, 89, 1011, 24, 80, "Text",ExpressionUUID->"74d2624e-3202-4c4f-9e9d-ea66ba81c420"],
Cell[4671, 115, 1548, 45, 122, "Text",ExpressionUUID->"4acb2eb2-936d-459b-823d-3a5144993c49"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6256, 165, 162, 3, 67, "Section",ExpressionUUID->"864090de-8af3-40e5-8657-4cf1811662e3"],
Cell[CellGroupData[{
Cell[6443, 172, 110, 0, 53, "Subsection",ExpressionUUID->"5fbe112a-95a8-4839-bc72-dd5a70c12b50"],
Cell[6556, 174, 854, 14, 56, "Text",ExpressionUUID->"f031a4e1-a4e3-4165-9b57-0ed9c5974a27"],
Cell[7413, 190, 591, 13, 28, "Input",ExpressionUUID->"ec436de9-ce2e-4f3d-a988-2d215346391b"],
Cell[8007, 205, 231, 6, 34, "Text",ExpressionUUID->"76e6aa07-ec0f-4285-ac91-9b27af2073a5"],
Cell[8241, 213, 168, 3, 34, "Text",ExpressionUUID->"9cbb7c48-cf7b-42e0-86bd-17662c34ac90"],
Cell[CellGroupData[{
Cell[8434, 220, 352, 9, 28, "Input",ExpressionUUID->"b8fb8ca6-f2b1-43ae-98ad-cc2115fe47f0"],
Cell[8789, 231, 820, 15, 32, "Output",ExpressionUUID->"9444010f-dc37-4503-adf7-bd39883bd3c2"]
}, Open  ]],
Cell[9624, 249, 399, 8, 34, "Text",ExpressionUUID->"a050fd8a-3cde-45b8-baf7-ceb54558f73f"],
Cell[10026, 259, 265, 7, 34, "Text",ExpressionUUID->"746b2aa6-7422-4b25-875e-7f6bb9cbf123"],
Cell[10294, 268, 320, 5, 56, "Text",ExpressionUUID->"2141b4e2-e49c-463d-97f1-455104b89fc4"],
Cell[CellGroupData[{
Cell[10639, 277, 616, 13, 28, "Input",ExpressionUUID->"20633d23-4c26-4593-a8eb-2a7263f34d2a"],
Cell[11258, 292, 1708, 28, 32, "Output",ExpressionUUID->"1eb5df47-2a9f-4182-9f68-1f8a5bfc285d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13003, 325, 795, 16, 28, "Input",ExpressionUUID->"338094e6-214d-44ab-b9f8-872f9b36121e"],
Cell[13801, 343, 2003, 36, 32, "Output",ExpressionUUID->"3d4420f4-e229-49d1-923c-8a0b549f7af8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15853, 385, 96, 0, 53, "Subsection",ExpressionUUID->"fbe33327-0950-42b0-9e34-f84ac03a727e"],
Cell[15952, 387, 260, 6, 34, "Text",ExpressionUUID->"9935471d-3f3a-4f13-bad2-6270dde9638d"],
Cell[16215, 395, 717, 14, 144, "Text",ExpressionUUID->"8339056e-f6bd-488b-b2bb-e7e21a4e8836"],
Cell[16935, 411, 315, 7, 34, "Text",ExpressionUUID->"9816cc8e-cd91-4174-9e1d-19a5155c13e5"],
Cell[CellGroupData[{
Cell[17275, 422, 104, 0, 44, "Subsubsection",ExpressionUUID->"24f626f8-a5dd-4560-89f1-a73c24b50e25"],
Cell[17382, 424, 456, 9, 56, "Text",ExpressionUUID->"74e19e32-61f1-45ef-abd5-2192bee6fec5"],
Cell[17841, 435, 1353, 24, 28, "Input",ExpressionUUID->"ab0ff058-f6da-4ab1-ad4f-ba367af6aff8"],
Cell[19197, 461, 99, 1, 1, "PageBreak",ExpressionUUID->"ac2431b6-5578-4254-8aed-b417df10b28b",
 PageBreakBelow->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19357, 469, 193, 3, 67, "Section",ExpressionUUID->"25edb417-18d9-478f-8f11-c980892e290e"],
Cell[CellGroupData[{
Cell[19575, 476, 141, 3, 53, "Subsection",ExpressionUUID->"046d36f8-1dd7-42d7-9754-cec87b923393"],
Cell[19719, 481, 247, 6, 34, "Text",ExpressionUUID->"e0b39e9a-4911-4be7-b5fd-f0b5653e5f36"],
Cell[CellGroupData[{
Cell[19991, 491, 616, 14, 28, "Input",ExpressionUUID->"06e7ed5d-0bfc-4638-92d2-8f2461335254"],
Cell[20610, 507, 1802, 30, 32, "Output",ExpressionUUID->"8be66eef-ae24-4489-aa1f-d5655c309754"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22449, 542, 394, 9, 28, "Input",ExpressionUUID->"dbddaf4f-27a0-4b4a-8c9e-4fbe329fc501"],
Cell[22846, 553, 1957, 33, 32, "Output",ExpressionUUID->"68ff2f04-56e8-45ba-bb16-376c19adfeb1"]
}, Open  ]],
Cell[24818, 589, 536, 14, 28, "Input",ExpressionUUID->"e57f6f36-9519-438b-bc87-98c89d910e50"],
Cell[CellGroupData[{
Cell[25379, 607, 493, 12, 28, "Input",ExpressionUUID->"fe6d9b11-2fef-4bed-a0f5-088623c052c3"],
Cell[25875, 621, 1877, 44, 79, "Output",ExpressionUUID->"4f17b535-dff6-42eb-9121-5a35862817a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27789, 670, 2068, 43, 67, "Input",ExpressionUUID->"18c00eac-46ba-479f-8a27-245d6a7f092b"],
Cell[29860, 715, 3432, 81, 32, "Output",ExpressionUUID->"15caf9cb-53fe-4386-b247-ad47db79c0de"]
}, Open  ]],
Cell[33307, 799, 177, 3, 34, "Text",ExpressionUUID->"a13f3ec6-5b21-4024-8c68-aeaf6704b6aa"],
Cell[CellGroupData[{
Cell[33509, 806, 526, 15, 28, "Input",ExpressionUUID->"b19610b8-9863-4f63-a7c7-d401c09c6d30"],
Cell[34038, 823, 2058, 57, 32, "Output",ExpressionUUID->"da4b27c8-35cd-4901-8448-818b170e130c"]
}, Open  ]],
Cell[36111, 883, 360, 7, 34, "Text",ExpressionUUID->"f7bc3e51-d745-4593-98cd-a69cf0e36623"],
Cell[CellGroupData[{
Cell[36496, 894, 428, 10, 28, "Input",ExpressionUUID->"d6372644-0432-4561-b4f6-01512de79d44"],
Cell[36927, 906, 3738, 92, 52, "Output",ExpressionUUID->"28e26bcf-4d58-49aa-84f9-400770af2f99"]
}, Open  ]],
Cell[40680, 1001, 188, 3, 34, "Text",ExpressionUUID->"cf4aeca9-45bd-450d-adfc-7f38ed063af9"],
Cell[CellGroupData[{
Cell[40893, 1008, 554, 13, 28, "Input",ExpressionUUID->"9e2ffe3e-59b2-41f2-96f4-a9b9e3a7ae0f"],
Cell[41450, 1023, 3933, 99, 52, "Output",ExpressionUUID->"d3d89533-e0bf-4de4-b7a6-c6cfd5da3b4a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45432, 1128, 162, 3, 53, "Subsection",ExpressionUUID->"28eca8c2-df3f-4e9c-8baf-dca634dc895f"],
Cell[45597, 1133, 263, 6, 34, "Text",ExpressionUUID->"f441a74a-3b07-4fa9-8409-ce4ed947805d"],
Cell[45863, 1141, 527, 12, 28, "Input",ExpressionUUID->"a8fd3842-4412-4e94-9df6-53bb1cba3cb2"],
Cell[46393, 1155, 567, 11, 28, "Input",ExpressionUUID->"d3d2a842-eb3f-4a03-a20d-a553902923d1"],
Cell[CellGroupData[{
Cell[46985, 1170, 409, 11, 28, "Input",ExpressionUUID->"ce34e586-bfa4-4711-b80c-950fe29883a0"],
Cell[47397, 1183, 5476, 148, 79, "Output",ExpressionUUID->"58a147c1-1c31-44f6-bb7e-2b8025a6a28f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52934, 1338, 204, 4, 67, "Section",ExpressionUUID->"432c20ca-4a71-4c8a-8d7d-8ececbc1adaa"],
Cell[53141, 1344, 199, 3, 34, "Text",ExpressionUUID->"2c4fb6b4-257b-48c3-a9d6-3a156202c810"],
Cell[CellGroupData[{
Cell[53365, 1351, 1355, 35, 67, "Input",ExpressionUUID->"d69e65dc-9795-439b-9782-060c04a9ab26"],
Cell[54723, 1388, 13055, 374, 130, "Output",ExpressionUUID->"e9535703-95da-4631-b913-06f929d6a577"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67815, 1767, 708, 20, 67, "Input",ExpressionUUID->"5186510f-d04f-4363-978a-544c4a39d51e"],
Cell[68526, 1789, 9955, 310, 147, "Output",ExpressionUUID->"e61b178e-ff66-42dc-8f37-6a718fcbb8e4"],
Cell[78484, 2101, 453, 10, 32, "Output",ExpressionUUID->"3b27fbd9-8813-4e11-8da1-5b07862f6e64"],
Cell[78940, 2113, 10106, 315, 147, "Output",ExpressionUUID->"6d4bcffe-ebb5-4cda-b212-c00a51e21c19"]
}, Open  ]],
Cell[89061, 2431, 576, 14, 28, "Input",ExpressionUUID->"a6cb7c60-b214-436c-b508-bb79cf44cc4d"],
Cell[89640, 2447, 1959, 61, 101, "Text",ExpressionUUID->"2ad01487-2f56-420b-be92-69c765e5f9e6"],
Cell[91602, 2510, 179, 3, 34, "Text",ExpressionUUID->"db618888-00c7-4afd-9ef3-bdd99395b649"],
Cell[91784, 2515, 442, 12, 28, "Input",ExpressionUUID->"2091f88d-3d70-4b14-a504-4df00c6ea362"],
Cell[92229, 2529, 162, 3, 34, "Text",ExpressionUUID->"425dbc89-8202-4a13-b43d-d58bfbab5aad"],
Cell[92394, 2534, 363, 10, 28, "Input",ExpressionUUID->"d9b78355-2c9d-4fb1-b644-87d30aef0d23"],
Cell[92760, 2546, 186, 3, 34, "Text",ExpressionUUID->"4797434d-fc86-4af5-99c9-f0f1ea4efb7b"],
Cell[92949, 2551, 373, 9, 28, "Input",ExpressionUUID->"b8759099-fc84-4ab3-92cc-a515b9a42540"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93359, 2565, 151, 3, 53, "Subtitle",ExpressionUUID->"dcaf0cc9-f212-4243-997d-0143e944ddfb"],
Cell[CellGroupData[{
Cell[93535, 2572, 157, 3, 67, "Section",ExpressionUUID->"ac37072d-524f-49f4-8810-4432ed3ca539"],
Cell[93695, 2577, 614, 15, 48, "Input",ExpressionUUID->"229d588e-add3-42da-891f-65c72f56c31f"],
Cell[94312, 2594, 338, 9, 28, "Input",ExpressionUUID->"a1d4977e-bf1c-44f0-b21b-dab7a3db47eb"],
Cell[CellGroupData[{
Cell[94675, 2607, 291, 5, 28, "Input",ExpressionUUID->"8b9ce7c1-133e-4c23-9550-dc0c32501ae8"],
Cell[94969, 2614, 954, 17, 46, "Output",ExpressionUUID->"94a87cdb-12c3-4d31-839d-049b4f2875b3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[95972, 2637, 90, 0, 67, "Section",ExpressionUUID->"b54ba43a-bf57-4769-ab35-c197e411a0e3"],
Cell[CellGroupData[{
Cell[96087, 2641, 213, 4, 53, "Subsection",ExpressionUUID->"bea5cb1c-b8fd-41db-8e4c-a66e3bc40581"],
Cell[CellGroupData[{
Cell[96325, 2649, 328, 8, 28, "Input",ExpressionUUID->"eae0e340-a16c-4576-b58b-3dfbdf93d503"],
Cell[96656, 2659, 1394, 22, 50, "Output",ExpressionUUID->"cc97cdde-c9cd-4782-a22a-afd3c9fe0788"]
}, Open  ]],
Cell[98065, 2684, 278, 4, 34, "Text",ExpressionUUID->"98ac4e8e-8df8-487e-988c-c44cf86b04dc"],
Cell[98346, 2690, 266, 6, 28, "Input",ExpressionUUID->"75fbb3ef-04e8-458e-b3f5-ea55c6c63b2d"],
Cell[98615, 2698, 270, 4, 34, "Text",ExpressionUUID->"a16426f8-fa40-4593-9645-c322348a2e2d"],
Cell[98888, 2704, 265, 6, 28, "Input",ExpressionUUID->"4010533b-c8ed-4f62-aa06-d3cf75c43cbe"],
Cell[99156, 2712, 645, 13, 31, "Input",ExpressionUUID->"447c06b0-9d1f-4a42-8b5a-93cba44147fd"],
Cell[CellGroupData[{
Cell[99826, 2729, 305, 6, 28, "Input",ExpressionUUID->"a097cd31-0168-43a5-b719-14c2f1f8b8fa"],
Cell[100134, 2737, 11080, 324, 213, "Output",ExpressionUUID->"d3aeab0d-81d1-4573-86d6-7385bc0f52a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111251, 3066, 6369, 180, 162, "Input",ExpressionUUID->"2170fc72-5007-428a-b92e-ed117d48d408"],
Cell[117623, 3248, 3531, 96, 132, "Output",ExpressionUUID->"d76d1cd8-21fe-4ded-9c18-59ad2ccfd0c9"],
Cell[121157, 3346, 568, 12, 21, "Message",ExpressionUUID->"7b00c84c-5854-4c49-9ec4-78d345c90d97"],
Cell[121728, 3360, 1209, 21, 32, "Output",ExpressionUUID->"c74b638a-150f-4d1a-8e4f-e3750ed5652c"],
Cell[122940, 3383, 1332, 24, 36, "Output",ExpressionUUID->"6dde5b8a-f909-4ea4-af97-b544426dd168"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[124321, 3413, 313, 5, 53, "Subsection",ExpressionUUID->"d0f37056-17fe-4f16-998a-176ee4759b4d"],
Cell[124637, 3420, 404, 10, 28, "Input",ExpressionUUID->"53df4393-d8dc-42a4-ba01-2d02861fe7f2"],
Cell[125044, 3432, 674, 14, 31, "Input",ExpressionUUID->"0fd78211-efeb-45df-b3f4-639a7a701fed"],
Cell[125721, 3448, 293, 6, 28, "Input",ExpressionUUID->"1ca0b015-fad9-4765-b75a-45108e044685"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126051, 3459, 360, 6, 53, "Subsection",ExpressionUUID->"34ccb41c-54ca-433b-a895-c4331145c5f3"],
Cell[126414, 3467, 378, 9, 28, "Input",ExpressionUUID->"827520df-270c-4bef-8b37-9820ed0b7d20"],
Cell[126795, 3478, 701, 14, 28, "Input",ExpressionUUID->"3a8dadb2-d66e-4944-9d86-f1c7532db42d"],
Cell[127499, 3494, 293, 6, 28, "Input",ExpressionUUID->"60262eaa-9b3e-4e28-a932-e6e3aec9a419"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127829, 3505, 375, 6, 53, "Subsection",ExpressionUUID->"4a9de550-9ed9-4b34-8ddc-ef35b299ae08"],
Cell[128207, 3513, 474, 11, 28, "Input",ExpressionUUID->"5f9cbcd1-2611-4d66-92cb-aa224285868b"],
Cell[128684, 3526, 701, 14, 28, "Input",ExpressionUUID->"6f180b87-2eba-4916-96bb-5e6f539a996b"],
Cell[129388, 3542, 293, 6, 28, "Input",ExpressionUUID->"9ce006e0-ece6-4e19-83b7-77425c726a52"],
Cell[129684, 3550, 200, 4, 28, "Input",ExpressionUUID->"e33113e1-907e-4e5e-ae61-4f974bef6fe1"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

